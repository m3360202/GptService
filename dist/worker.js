/*! For license information please see worker.js.LICENSE.txt */
(()=>{var e={6434:(e,t,r)=>{"use strict";e=r.nmd(e);const n=(e=0)=>t=>`[${38+e};5;${t}m`,a=(e=0)=>(t,r,n)=>`[${38+e};2;${t};${r};${n}m`;Object.defineProperty(e,"exports",{enumerable:!0,get:function(){const e=new Map,t={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};t.color.gray=t.color.blackBright,t.bgColor.bgGray=t.bgColor.bgBlackBright,t.color.grey=t.color.blackBright,t.bgColor.bgGrey=t.bgColor.bgBlackBright;for(const[r,n]of Object.entries(t)){for(const[r,a]of Object.entries(n))t[r]={open:`[${a[0]}m`,close:`[${a[1]}m`},n[r]=t[r],e.set(a[0],a[1]);Object.defineProperty(t,r,{value:n,enumerable:!1})}return Object.defineProperty(t,"codes",{value:e,enumerable:!1}),t.color.close="[39m",t.bgColor.close="[49m",t.color.ansi256=n(),t.color.ansi16m=a(),t.bgColor.ansi256=n(10),t.bgColor.ansi16m=a(10),Object.defineProperties(t,{rgbToAnsi256:{value:(e,t,r)=>e===t&&t===r?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(r/255*5),enumerable:!1},hexToRgb:{value:e=>{const t=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(e.toString(16));if(!t)return[0,0,0];let{colorString:r}=t.groups;3===r.length&&(r=r.split("").map((e=>e+e)).join(""));const n=Number.parseInt(r,16);return[n>>16&255,n>>8&255,255&n]},enumerable:!1},hexToAnsi256:{value:e=>t.rgbToAnsi256(...t.hexToRgb(e)),enumerable:!1}}),t}})},9669:(e,t,r)=>{e.exports=r(1609)},5448:(e,t,r)=>{"use strict";var n=r(4867),a=r(6026),s=r(4372),i=r(5327),o=r(4097),c=r(4109),u=r(7985),l=r(5061),d=r(7874),h=r(5263);e.exports=function(e){return new Promise((function(t,r){var p,f=e.data,m=e.headers,g=e.responseType;function y(){e.cancelToken&&e.cancelToken.unsubscribe(p),e.signal&&e.signal.removeEventListener("abort",p)}n.isFormData(f)&&delete m["Content-Type"];var b=new XMLHttpRequest;if(e.auth){var v=e.auth.username||"",_=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";m.Authorization="Basic "+btoa(v+":"+_)}var w=o(e.baseURL,e.url);function O(){if(b){var n="getAllResponseHeaders"in b?c(b.getAllResponseHeaders()):null,s={data:g&&"text"!==g&&"json"!==g?b.response:b.responseText,status:b.status,statusText:b.statusText,headers:n,config:e,request:b};a((function(e){t(e),y()}),(function(e){r(e),y()}),s),b=null}}if(b.open(e.method.toUpperCase(),i(w,e.params,e.paramsSerializer),!0),b.timeout=e.timeout,"onloadend"in b?b.onloadend=O:b.onreadystatechange=function(){b&&4===b.readyState&&(0!==b.status||b.responseURL&&0===b.responseURL.indexOf("file:"))&&setTimeout(O)},b.onabort=function(){b&&(r(l("Request aborted",e,"ECONNABORTED",b)),b=null)},b.onerror=function(){r(l("Network Error",e,null,b)),b=null},b.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",n=e.transitional||d;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(l(t,e,n.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",b)),b=null},n.isStandardBrowserEnv()){var x=(e.withCredentials||u(w))&&e.xsrfCookieName?s.read(e.xsrfCookieName):void 0;x&&(m[e.xsrfHeaderName]=x)}"setRequestHeader"in b&&n.forEach(m,(function(e,t){void 0===f&&"content-type"===t.toLowerCase()?delete m[t]:b.setRequestHeader(t,e)})),n.isUndefined(e.withCredentials)||(b.withCredentials=!!e.withCredentials),g&&"json"!==g&&(b.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&b.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&b.upload&&b.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(p=function(e){b&&(r(!e||e&&e.type?new h("canceled"):e),b.abort(),b=null)},e.cancelToken&&e.cancelToken.subscribe(p),e.signal&&(e.signal.aborted?p():e.signal.addEventListener("abort",p))),f||(f=null),b.send(f)}))}},1609:(e,t,r)=>{"use strict";var n=r(4867),a=r(1849),s=r(321),i=r(7185),o=function e(t){var r=new s(t),o=a(s.prototype.request,r);return n.extend(o,s.prototype,r),n.extend(o,r),o.create=function(r){return e(i(t,r))},o}(r(5546));o.Axios=s,o.Cancel=r(5263),o.CancelToken=r(4972),o.isCancel=r(6502),o.VERSION=r(7288).version,o.all=function(e){return Promise.all(e)},o.spread=r(8713),o.isAxiosError=r(6268),e.exports=o,e.exports.default=o},5263:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},4972:(e,t,r)=>{"use strict";var n=r(5263);function a(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;this.promise.then((function(e){if(r._listeners){var t,n=r._listeners.length;for(t=0;t<n;t++)r._listeners[t](e);r._listeners=null}})),this.promise.then=function(e){var t,n=new Promise((function(e){r.subscribe(e),t=e})).then(e);return n.cancel=function(){r.unsubscribe(t)},n},e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}a.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},a.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},a.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},a.source=function(){var e;return{token:new a((function(t){e=t})),cancel:e}},e.exports=a},6502:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},321:(e,t,r)=>{"use strict";var n=r(4867),a=r(5327),s=r(782),i=r(3572),o=r(7185),c=r(4875),u=c.validators;function l(e){this.defaults=e,this.interceptors={request:new s,response:new s}}l.prototype.request=function(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},(t=o(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var r=t.transitional;void 0!==r&&c.assertOptions(r,{silentJSONParsing:u.transitional(u.boolean),forcedJSONParsing:u.transitional(u.boolean),clarifyTimeoutError:u.transitional(u.boolean)},!1);var n=[],a=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(a=a&&e.synchronous,n.unshift(e.fulfilled,e.rejected))}));var s,l=[];if(this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)})),!a){var d=[i,void 0];for(Array.prototype.unshift.apply(d,n),d=d.concat(l),s=Promise.resolve(t);d.length;)s=s.then(d.shift(),d.shift());return s}for(var h=t;n.length;){var p=n.shift(),f=n.shift();try{h=p(h)}catch(e){f(e);break}}try{s=i(h)}catch(e){return Promise.reject(e)}for(;l.length;)s=s.then(l.shift(),l.shift());return s},l.prototype.getUri=function(e){return e=o(this.defaults,e),a(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(e){l.prototype[e]=function(t,r){return this.request(o(r||{},{method:e,url:t,data:(r||{}).data}))}})),n.forEach(["post","put","patch"],(function(e){l.prototype[e]=function(t,r,n){return this.request(o(n||{},{method:e,url:t,data:r}))}})),e.exports=l},782:(e,t,r)=>{"use strict";var n=r(4867);function a(){this.handlers=[]}a.prototype.use=function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1},a.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},a.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=a},4097:(e,t,r)=>{"use strict";var n=r(1793),a=r(7303);e.exports=function(e,t){return e&&!n(t)?a(e,t):t}},5061:(e,t,r)=>{"use strict";var n=r(481);e.exports=function(e,t,r,a,s){var i=new Error(e);return n(i,t,r,a,s)}},3572:(e,t,r)=>{"use strict";var n=r(4867),a=r(8527),s=r(6502),i=r(5546),o=r(5263);function c(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new o("canceled")}e.exports=function(e){return c(e),e.headers=e.headers||{},e.data=a.call(e,e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||i.adapter)(e).then((function(t){return c(e),t.data=a.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return s(t)||(c(e),t&&t.response&&(t.response.data=a.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},481:e=>{"use strict";e.exports=function(e,t,r,n,a){return e.config=t,r&&(e.code=r),e.request=n,e.response=a,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e}},7185:(e,t,r)=>{"use strict";var n=r(4867);e.exports=function(e,t){t=t||{};var r={};function a(e,t){return n.isPlainObject(e)&&n.isPlainObject(t)?n.merge(e,t):n.isPlainObject(t)?n.merge({},t):n.isArray(t)?t.slice():t}function s(r){return n.isUndefined(t[r])?n.isUndefined(e[r])?void 0:a(void 0,e[r]):a(e[r],t[r])}function i(e){if(!n.isUndefined(t[e]))return a(void 0,t[e])}function o(r){return n.isUndefined(t[r])?n.isUndefined(e[r])?void 0:a(void 0,e[r]):a(void 0,t[r])}function c(r){return r in t?a(e[r],t[r]):r in e?a(void 0,e[r]):void 0}var u={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c};return n.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=u[e]||s,a=t(e);n.isUndefined(a)&&t!==c||(r[e]=a)})),r}},6026:(e,t,r)=>{"use strict";var n=r(5061);e.exports=function(e,t,r){var a=r.config.validateStatus;r.status&&a&&!a(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},8527:(e,t,r)=>{"use strict";var n=r(4867),a=r(5546);e.exports=function(e,t,r){var s=this||a;return n.forEach(r,(function(r){e=r.call(s,e,t)})),e}},5546:(e,t,r)=>{"use strict";var n=r(4867),a=r(6016),s=r(481),i=r(7874),o={"Content-Type":"application/x-www-form-urlencoded"};function c(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var u,l={transitional:i,adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(u=r(5448)),u),transformRequest:[function(e,t){return a(t,"Accept"),a(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(c(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)||t&&"application/json"===t["Content-Type"]?(c(t,"application/json"),function(e,t,r){if(n.isString(e))try{return(0,JSON.parse)(e),n.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||l.transitional,r=t&&t.silentJSONParsing,a=t&&t.forcedJSONParsing,i=!r&&"json"===this.responseType;if(i||a&&n.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(i){if("SyntaxError"===e.name)throw s(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],(function(e){l.headers[e]={}})),n.forEach(["post","put","patch"],(function(e){l.headers[e]=n.merge(o)})),e.exports=l},7874:e=>{"use strict";e.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},7288:e=>{e.exports={version:"0.26.1"}},1849:e=>{"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},5327:(e,t,r)=>{"use strict";var n=r(4867);function a(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var s;if(r)s=r(t);else if(n.isURLSearchParams(t))s=t.toString();else{var i=[];n.forEach(t,(function(e,t){null!=e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),i.push(a(t)+"="+a(e))})))})),s=i.join("&")}if(s){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}},7303:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},4372:(e,t,r)=>{"use strict";var n=r(4867);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,a,s,i){var o=[];o.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),n.isString(a)&&o.push("path="+a),n.isString(s)&&o.push("domain="+s),!0===i&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},1793:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}},6268:(e,t,r)=>{"use strict";var n=r(4867);e.exports=function(e){return n.isObject(e)&&!0===e.isAxiosError}},7985:(e,t,r)=>{"use strict";var n=r(4867);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function a(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=a(window.location.href),function(t){var r=n.isString(t)?a(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},6016:(e,t,r)=>{"use strict";var n=r(4867);e.exports=function(e,t){n.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))}},4109:(e,t,r)=>{"use strict";var n=r(4867),a=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,s,i={};return e?(n.forEach(e.split("\n"),(function(e){if(s=e.indexOf(":"),t=n.trim(e.substr(0,s)).toLowerCase(),r=n.trim(e.substr(s+1)),t){if(i[t]&&a.indexOf(t)>=0)return;i[t]="set-cookie"===t?(i[t]?i[t]:[]).concat([r]):i[t]?i[t]+", "+r:r}})),i):i}},8713:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},4875:(e,t,r)=>{"use strict";var n=r(7288).version,a={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){a[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));var s={};a.transitional=function(e,t,r){function a(e,t){return"[Axios v"+n+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return function(r,n,i){if(!1===e)throw new Error(a(n," has been removed"+(t?" in "+t:"")));return t&&!s[n]&&(s[n]=!0,console.warn(a(n," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,n,i)}},e.exports={assertOptions:function(e,t,r){if("object"!=typeof e)throw new TypeError("options must be an object");for(var n=Object.keys(e),a=n.length;a-- >0;){var s=n[a],i=t[s];if(i){var o=e[s],c=void 0===o||i(o,s,e);if(!0!==c)throw new TypeError("option "+s+" must be "+c)}else if(!0!==r)throw Error("Unknown option "+s)}},validators:a}},4867:(e,t,r)=>{"use strict";var n=r(1849),a=Object.prototype.toString;function s(e){return Array.isArray(e)}function i(e){return void 0===e}function o(e){return"[object ArrayBuffer]"===a.call(e)}function c(e){return null!==e&&"object"==typeof e}function u(e){if("[object Object]"!==a.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function l(e){return"[object Function]"===a.call(e)}function d(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),s(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.call(null,e[a],a,e)}e.exports={isArray:s,isArrayBuffer:o,isBuffer:function(e){return null!==e&&!i(e)&&null!==e.constructor&&!i(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"[object FormData]"===a.call(e)},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&o(e.buffer)},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:c,isPlainObject:u,isUndefined:i,isDate:function(e){return"[object Date]"===a.call(e)},isFile:function(e){return"[object File]"===a.call(e)},isBlob:function(e){return"[object Blob]"===a.call(e)},isFunction:l,isStream:function(e){return c(e)&&l(e.pipe)},isURLSearchParams:function(e){return"[object URLSearchParams]"===a.call(e)},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:d,merge:function e(){var t={};function r(r,n){u(t[n])&&u(r)?t[n]=e(t[n],r):u(r)?t[n]=e({},r):s(r)?t[n]=r.slice():t[n]=r}for(var n=0,a=arguments.length;n<a;n++)d(arguments[n],r);return t},extend:function(e,t,r){return d(t,(function(t,a){e[a]=r&&"function"==typeof t?n(t,r):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},9742:(e,t)=>{"use strict";t.byteLength=function(e){var t=o(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,s=o(e),i=s[0],c=s[1],u=new a(function(e,t,r){return 3*(t+r)/4-r}(0,i,c)),l=0,d=c>0?i-4:i;for(r=0;r<d;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;return 2===c&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,u[l++]=255&t),1===c&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t),u},t.fromByteArray=function(e){for(var t,n=e.length,a=n%3,s=[],i=16383,o=0,u=n-a;o<u;o+=i)s.push(c(e,o,o+i>u?u:o+i));return 1===a?(t=e[n-1],s.push(r[t>>2]+r[t<<4&63]+"==")):2===a&&(t=(e[n-2]<<8)+e[n-1],s.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),s.join("")};for(var r=[],n=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0;i<64;++i)r[i]=s[i],n[s.charCodeAt(i)]=i;function o(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e,t,n){for(var a,s,i=[],o=t;o<n;o+=3)a=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(r[(s=a)>>18&63]+r[s>>12&63]+r[s>>6&63]+r[63&s]);return i.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},7513:e=>{e.exports=function(e,t,r,n,a){var s,i;if(void 0===n)n=0;else if((n|=0)<0||n>=e.length)throw new RangeError("invalid lower bound");if(void 0===a)a=e.length-1;else if((a|=0)<n||a>=e.length)throw new RangeError("invalid upper bound");for(;n<=a;)if((i=+r(e[s=n+(a-n>>>1)],t,s,e))<0)n=s+1;else{if(!(i>0))return s;a=s-1}return~n}},3204:e=>{"use strict";const t=/[\p{Lu}]/u,r=/[\p{Ll}]/u,n=/^[\p{Lu}](?![\p{Lu}])/gu,a=/([\p{Alpha}\p{N}_]|$)/u,s=/[_.\- ]+/,i=new RegExp("^"+s.source),o=new RegExp(s.source+a.source,"gu"),c=new RegExp("\\d+"+a.source,"gu"),u=(e,a)=>{if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("Expected the input to be `string | string[]`");if(a={pascalCase:!1,preserveConsecutiveUppercase:!1,...a},0===(e=Array.isArray(e)?e.map((e=>e.trim())).filter((e=>e.length)).join("-"):e.trim()).length)return"";const s=!1===a.locale?e=>e.toLowerCase():e=>e.toLocaleLowerCase(a.locale),u=!1===a.locale?e=>e.toUpperCase():e=>e.toLocaleUpperCase(a.locale);return 1===e.length?a.pascalCase?u(e):s(e):(e!==s(e)&&(e=((e,n,a)=>{let s=!1,i=!1,o=!1;for(let c=0;c<e.length;c++){const u=e[c];s&&t.test(u)?(e=e.slice(0,c)+"-"+e.slice(c),s=!1,o=i,i=!0,c++):i&&o&&r.test(u)?(e=e.slice(0,c-1)+"-"+e.slice(c-1),o=i,i=!1,s=!0):(s=n(u)===u&&a(u)!==u,o=i,i=a(u)===u&&n(u)!==u)}return e})(e,s,u)),e=e.replace(i,""),e=a.preserveConsecutiveUppercase?((e,t)=>(n.lastIndex=0,e.replace(n,(e=>t(e)))))(e,s):s(e),a.pascalCase&&(e=u(e.charAt(0))+e.slice(1)),((e,t)=>(o.lastIndex=0,c.lastIndex=0,e.replace(o,((e,r)=>t(r))).replace(c,(e=>t(e)))))(e,u))};e.exports=u,e.exports.default=u},2466:e=>{"use strict";e.exports=function(e,t){if("string"!=typeof e)throw new TypeError("Expected a string");return t=void 0===t?"_":t,e.replace(/([a-z\d])([A-Z])/g,"$1"+t+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+t+"$2").toLowerCase()}},6729:e=>{"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function a(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function s(e,t,n,s,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var o=new a(n,s||e,i),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],o]:e._events[c].push(o):(e._events[c]=o,e._eventsCount++),e}function i(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function o(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),o.prototype.eventNames=function(){var e,n,a=[];if(0===this._eventsCount)return a;for(n in e=this._events)t.call(e,n)&&a.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},o.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var a=0,s=n.length,i=new Array(s);a<s;a++)i[a]=n[a].fn;return i},o.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},o.prototype.emit=function(e,t,n,a,s,i){var o=r?r+e:e;if(!this._events[o])return!1;var c,u,l=this._events[o],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,a),!0;case 5:return l.fn.call(l.context,t,n,a,s),!0;case 6:return l.fn.call(l.context,t,n,a,s,i),!0}for(u=1,c=new Array(d-1);u<d;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var h,p=l.length;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),d){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,n);break;case 4:l[u].fn.call(l[u].context,t,n,a);break;default:if(!c)for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];l[u].fn.apply(l[u].context,c)}}return!0},o.prototype.on=function(e,t,r){return s(this,e,t,r,!1)},o.prototype.once=function(e,t,r){return s(this,e,t,r,!0)},o.prototype.removeListener=function(e,t,n,a){var s=r?r+e:e;if(!this._events[s])return this;if(!t)return i(this,s),this;var o=this._events[s];if(o.fn)o.fn!==t||a&&!o.once||n&&o.context!==n||i(this,s);else{for(var c=0,u=[],l=o.length;c<l;c++)(o[c].fn!==t||a&&!o[c].once||n&&o[c].context!==n)&&u.push(o[c]);u.length?this._events[s]=1===u.length?u[0]:u:i(this,s)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&i(this,t)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o},1696:e=>{e.exports="object"==typeof self?self.FormData:window.FormData},7945:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,s){function i(e){try{c(n.next(e))}catch(e){s(e)}}function o(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,o)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.OpenAIApi=t.OpenAIApiFactory=t.OpenAIApiFp=t.OpenAIApiAxiosParamCreator=t.CreateImageRequestResponseFormatEnum=t.CreateImageRequestSizeEnum=t.ChatCompletionResponseMessageRoleEnum=t.ChatCompletionRequestMessageRoleEnum=void 0;const a=r(9669),s=r(8298),i=r(5232);t.ChatCompletionRequestMessageRoleEnum={System:"system",User:"user",Assistant:"assistant",Function:"function"},t.ChatCompletionResponseMessageRoleEnum={System:"system",User:"user",Assistant:"assistant",Function:"function"},t.CreateImageRequestSizeEnum={_256x256:"256x256",_512x512:"512x512",_1024x1024:"1024x1024"},t.CreateImageRequestResponseFormatEnum={Url:"url",B64Json:"b64_json"},t.OpenAIApiAxiosParamCreator=function(e){return{cancelFineTune:(t,r={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("cancelFineTune","fineTuneId",t);const n="/fine-tunes/{fine_tune_id}/cancel".replace("{fine_tune_id}",encodeURIComponent(String(t))),a=new URL(n,s.DUMMY_BASE_URL);let i;e&&(i=e.baseOptions);const o=Object.assign(Object.assign({method:"POST"},i),r);s.setSearchParams(a,{});let c=i&&i.headers?i.headers:{};return o.headers=Object.assign(Object.assign(Object.assign({},{}),c),r.headers),{url:s.toPathString(a),options:o}})),createAnswer:(t,r={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("createAnswer","createAnswerRequest",t);const n=new URL("/answers",s.DUMMY_BASE_URL);let a;e&&(a=e.baseOptions);const i=Object.assign(Object.assign({method:"POST"},a),r),o={"Content-Type":"application/json"};s.setSearchParams(n,{});let c=a&&a.headers?a.headers:{};return i.headers=Object.assign(Object.assign(Object.assign({},o),c),r.headers),i.data=s.serializeDataIfNeeded(t,i,e),{url:s.toPathString(n),options:i}})),createChatCompletion:(t,r={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("createChatCompletion","createChatCompletionRequest",t);const n=new URL("/chat/completions",s.DUMMY_BASE_URL);let a;e&&(a=e.baseOptions);const i=Object.assign(Object.assign({method:"POST"},a),r),o={"Content-Type":"application/json"};s.setSearchParams(n,{});let c=a&&a.headers?a.headers:{};return i.headers=Object.assign(Object.assign(Object.assign({},o),c),r.headers),i.data=s.serializeDataIfNeeded(t,i,e),{url:s.toPathString(n),options:i}})),createClassification:(t,r={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("createClassification","createClassificationRequest",t);const n=new URL("/classifications",s.DUMMY_BASE_URL);let a;e&&(a=e.baseOptions);const i=Object.assign(Object.assign({method:"POST"},a),r),o={"Content-Type":"application/json"};s.setSearchParams(n,{});let c=a&&a.headers?a.headers:{};return i.headers=Object.assign(Object.assign(Object.assign({},o),c),r.headers),i.data=s.serializeDataIfNeeded(t,i,e),{url:s.toPathString(n),options:i}})),createCompletion:(t,r={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("createCompletion","createCompletionRequest",t);const n=new URL("/completions",s.DUMMY_BASE_URL);let a;e&&(a=e.baseOptions);const i=Object.assign(Object.assign({method:"POST"},a),r),o={"Content-Type":"application/json"};s.setSearchParams(n,{});let c=a&&a.headers?a.headers:{};return i.headers=Object.assign(Object.assign(Object.assign({},o),c),r.headers),i.data=s.serializeDataIfNeeded(t,i,e),{url:s.toPathString(n),options:i}})),createEdit:(t,r={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("createEdit","createEditRequest",t);const n=new URL("/edits",s.DUMMY_BASE_URL);let a;e&&(a=e.baseOptions);const i=Object.assign(Object.assign({method:"POST"},a),r),o={"Content-Type":"application/json"};s.setSearchParams(n,{});let c=a&&a.headers?a.headers:{};return i.headers=Object.assign(Object.assign(Object.assign({},o),c),r.headers),i.data=s.serializeDataIfNeeded(t,i,e),{url:s.toPathString(n),options:i}})),createEmbedding:(t,r={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("createEmbedding","createEmbeddingRequest",t);const n=new URL("/embeddings",s.DUMMY_BASE_URL);let a;e&&(a=e.baseOptions);const i=Object.assign(Object.assign({method:"POST"},a),r),o={"Content-Type":"application/json"};s.setSearchParams(n,{});let c=a&&a.headers?a.headers:{};return i.headers=Object.assign(Object.assign(Object.assign({},o),c),r.headers),i.data=s.serializeDataIfNeeded(t,i,e),{url:s.toPathString(n),options:i}})),createFile:(t,r,a={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("createFile","file",t),s.assertParamExists("createFile","purpose",r);const n=new URL("/files",s.DUMMY_BASE_URL);let i;e&&(i=e.baseOptions);const o=Object.assign(Object.assign({method:"POST"},i),a),c={},u=new(e&&e.formDataCtor||FormData);void 0!==t&&u.append("file",t),void 0!==r&&u.append("purpose",r),c["Content-Type"]="multipart/form-data",s.setSearchParams(n,{});let l=i&&i.headers?i.headers:{};return o.headers=Object.assign(Object.assign(Object.assign(Object.assign({},c),u.getHeaders()),l),a.headers),o.data=u,{url:s.toPathString(n),options:o}})),createFineTune:(t,r={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("createFineTune","createFineTuneRequest",t);const n=new URL("/fine-tunes",s.DUMMY_BASE_URL);let a;e&&(a=e.baseOptions);const i=Object.assign(Object.assign({method:"POST"},a),r),o={"Content-Type":"application/json"};s.setSearchParams(n,{});let c=a&&a.headers?a.headers:{};return i.headers=Object.assign(Object.assign(Object.assign({},o),c),r.headers),i.data=s.serializeDataIfNeeded(t,i,e),{url:s.toPathString(n),options:i}})),createImage:(t,r={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("createImage","createImageRequest",t);const n=new URL("/images/generations",s.DUMMY_BASE_URL);let a;e&&(a=e.baseOptions);const i=Object.assign(Object.assign({method:"POST"},a),r),o={"Content-Type":"application/json"};s.setSearchParams(n,{});let c=a&&a.headers?a.headers:{};return i.headers=Object.assign(Object.assign(Object.assign({},o),c),r.headers),i.data=s.serializeDataIfNeeded(t,i,e),{url:s.toPathString(n),options:i}})),createImageEdit:(t,r,a,i,o,c,u,l={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("createImageEdit","image",t),s.assertParamExists("createImageEdit","prompt",r);const n=new URL("/images/edits",s.DUMMY_BASE_URL);let d;e&&(d=e.baseOptions);const h=Object.assign(Object.assign({method:"POST"},d),l),p={},f=new(e&&e.formDataCtor||FormData);void 0!==t&&f.append("image",t),void 0!==a&&f.append("mask",a),void 0!==r&&f.append("prompt",r),void 0!==i&&f.append("n",i),void 0!==o&&f.append("size",o),void 0!==c&&f.append("response_format",c),void 0!==u&&f.append("user",u),p["Content-Type"]="multipart/form-data",s.setSearchParams(n,{});let m=d&&d.headers?d.headers:{};return h.headers=Object.assign(Object.assign(Object.assign(Object.assign({},p),f.getHeaders()),m),l.headers),h.data=f,{url:s.toPathString(n),options:h}})),createImageVariation:(t,r,a,i,o,c={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("createImageVariation","image",t);const n=new URL("/images/variations",s.DUMMY_BASE_URL);let u;e&&(u=e.baseOptions);const l=Object.assign(Object.assign({method:"POST"},u),c),d={},h=new(e&&e.formDataCtor||FormData);void 0!==t&&h.append("image",t),void 0!==r&&h.append("n",r),void 0!==a&&h.append("size",a),void 0!==i&&h.append("response_format",i),void 0!==o&&h.append("user",o),d["Content-Type"]="multipart/form-data",s.setSearchParams(n,{});let p=u&&u.headers?u.headers:{};return l.headers=Object.assign(Object.assign(Object.assign(Object.assign({},d),h.getHeaders()),p),c.headers),l.data=h,{url:s.toPathString(n),options:l}})),createModeration:(t,r={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("createModeration","createModerationRequest",t);const n=new URL("/moderations",s.DUMMY_BASE_URL);let a;e&&(a=e.baseOptions);const i=Object.assign(Object.assign({method:"POST"},a),r),o={"Content-Type":"application/json"};s.setSearchParams(n,{});let c=a&&a.headers?a.headers:{};return i.headers=Object.assign(Object.assign(Object.assign({},o),c),r.headers),i.data=s.serializeDataIfNeeded(t,i,e),{url:s.toPathString(n),options:i}})),createSearch:(t,r,a={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("createSearch","engineId",t),s.assertParamExists("createSearch","createSearchRequest",r);const n="/engines/{engine_id}/search".replace("{engine_id}",encodeURIComponent(String(t))),i=new URL(n,s.DUMMY_BASE_URL);let o;e&&(o=e.baseOptions);const c=Object.assign(Object.assign({method:"POST"},o),a),u={"Content-Type":"application/json"};s.setSearchParams(i,{});let l=o&&o.headers?o.headers:{};return c.headers=Object.assign(Object.assign(Object.assign({},u),l),a.headers),c.data=s.serializeDataIfNeeded(r,c,e),{url:s.toPathString(i),options:c}})),createTranscription:(t,r,a,i,o,c,u={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("createTranscription","file",t),s.assertParamExists("createTranscription","model",r);const n=new URL("/audio/transcriptions",s.DUMMY_BASE_URL);let l;e&&(l=e.baseOptions);const d=Object.assign(Object.assign({method:"POST"},l),u),h={},p=new(e&&e.formDataCtor||FormData);void 0!==t&&p.append("file",t),void 0!==r&&p.append("model",r),void 0!==a&&p.append("prompt",a),void 0!==i&&p.append("response_format",i),void 0!==o&&p.append("temperature",o),void 0!==c&&p.append("language",c),h["Content-Type"]="multipart/form-data",s.setSearchParams(n,{});let f=l&&l.headers?l.headers:{};return d.headers=Object.assign(Object.assign(Object.assign(Object.assign({},h),p.getHeaders()),f),u.headers),d.data=p,{url:s.toPathString(n),options:d}})),createTranslation:(t,r,a,i,o,c={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("createTranslation","file",t),s.assertParamExists("createTranslation","model",r);const n=new URL("/audio/translations",s.DUMMY_BASE_URL);let u;e&&(u=e.baseOptions);const l=Object.assign(Object.assign({method:"POST"},u),c),d={},h=new(e&&e.formDataCtor||FormData);void 0!==t&&h.append("file",t),void 0!==r&&h.append("model",r),void 0!==a&&h.append("prompt",a),void 0!==i&&h.append("response_format",i),void 0!==o&&h.append("temperature",o),d["Content-Type"]="multipart/form-data",s.setSearchParams(n,{});let p=u&&u.headers?u.headers:{};return l.headers=Object.assign(Object.assign(Object.assign(Object.assign({},d),h.getHeaders()),p),c.headers),l.data=h,{url:s.toPathString(n),options:l}})),deleteFile:(t,r={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("deleteFile","fileId",t);const n="/files/{file_id}".replace("{file_id}",encodeURIComponent(String(t))),a=new URL(n,s.DUMMY_BASE_URL);let i;e&&(i=e.baseOptions);const o=Object.assign(Object.assign({method:"DELETE"},i),r);s.setSearchParams(a,{});let c=i&&i.headers?i.headers:{};return o.headers=Object.assign(Object.assign(Object.assign({},{}),c),r.headers),{url:s.toPathString(a),options:o}})),deleteModel:(t,r={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("deleteModel","model",t);const n="/models/{model}".replace("{model}",encodeURIComponent(String(t))),a=new URL(n,s.DUMMY_BASE_URL);let i;e&&(i=e.baseOptions);const o=Object.assign(Object.assign({method:"DELETE"},i),r);s.setSearchParams(a,{});let c=i&&i.headers?i.headers:{};return o.headers=Object.assign(Object.assign(Object.assign({},{}),c),r.headers),{url:s.toPathString(a),options:o}})),downloadFile:(t,r={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("downloadFile","fileId",t);const n="/files/{file_id}/content".replace("{file_id}",encodeURIComponent(String(t))),a=new URL(n,s.DUMMY_BASE_URL);let i;e&&(i=e.baseOptions);const o=Object.assign(Object.assign({method:"GET"},i),r);s.setSearchParams(a,{});let c=i&&i.headers?i.headers:{};return o.headers=Object.assign(Object.assign(Object.assign({},{}),c),r.headers),{url:s.toPathString(a),options:o}})),listEngines:(t={})=>n(this,void 0,void 0,(function*(){const r=new URL("/engines",s.DUMMY_BASE_URL);let n;e&&(n=e.baseOptions);const a=Object.assign(Object.assign({method:"GET"},n),t);s.setSearchParams(r,{});let i=n&&n.headers?n.headers:{};return a.headers=Object.assign(Object.assign(Object.assign({},{}),i),t.headers),{url:s.toPathString(r),options:a}})),listFiles:(t={})=>n(this,void 0,void 0,(function*(){const r=new URL("/files",s.DUMMY_BASE_URL);let n;e&&(n=e.baseOptions);const a=Object.assign(Object.assign({method:"GET"},n),t);s.setSearchParams(r,{});let i=n&&n.headers?n.headers:{};return a.headers=Object.assign(Object.assign(Object.assign({},{}),i),t.headers),{url:s.toPathString(r),options:a}})),listFineTuneEvents:(t,r,a={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("listFineTuneEvents","fineTuneId",t);const n="/fine-tunes/{fine_tune_id}/events".replace("{fine_tune_id}",encodeURIComponent(String(t))),i=new URL(n,s.DUMMY_BASE_URL);let o;e&&(o=e.baseOptions);const c=Object.assign(Object.assign({method:"GET"},o),a),u={};void 0!==r&&(u.stream=r),s.setSearchParams(i,u);let l=o&&o.headers?o.headers:{};return c.headers=Object.assign(Object.assign(Object.assign({},{}),l),a.headers),{url:s.toPathString(i),options:c}})),listFineTunes:(t={})=>n(this,void 0,void 0,(function*(){const r=new URL("/fine-tunes",s.DUMMY_BASE_URL);let n;e&&(n=e.baseOptions);const a=Object.assign(Object.assign({method:"GET"},n),t);s.setSearchParams(r,{});let i=n&&n.headers?n.headers:{};return a.headers=Object.assign(Object.assign(Object.assign({},{}),i),t.headers),{url:s.toPathString(r),options:a}})),listModels:(t={})=>n(this,void 0,void 0,(function*(){const r=new URL("/models",s.DUMMY_BASE_URL);let n;e&&(n=e.baseOptions);const a=Object.assign(Object.assign({method:"GET"},n),t);s.setSearchParams(r,{});let i=n&&n.headers?n.headers:{};return a.headers=Object.assign(Object.assign(Object.assign({},{}),i),t.headers),{url:s.toPathString(r),options:a}})),retrieveEngine:(t,r={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("retrieveEngine","engineId",t);const n="/engines/{engine_id}".replace("{engine_id}",encodeURIComponent(String(t))),a=new URL(n,s.DUMMY_BASE_URL);let i;e&&(i=e.baseOptions);const o=Object.assign(Object.assign({method:"GET"},i),r);s.setSearchParams(a,{});let c=i&&i.headers?i.headers:{};return o.headers=Object.assign(Object.assign(Object.assign({},{}),c),r.headers),{url:s.toPathString(a),options:o}})),retrieveFile:(t,r={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("retrieveFile","fileId",t);const n="/files/{file_id}".replace("{file_id}",encodeURIComponent(String(t))),a=new URL(n,s.DUMMY_BASE_URL);let i;e&&(i=e.baseOptions);const o=Object.assign(Object.assign({method:"GET"},i),r);s.setSearchParams(a,{});let c=i&&i.headers?i.headers:{};return o.headers=Object.assign(Object.assign(Object.assign({},{}),c),r.headers),{url:s.toPathString(a),options:o}})),retrieveFineTune:(t,r={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("retrieveFineTune","fineTuneId",t);const n="/fine-tunes/{fine_tune_id}".replace("{fine_tune_id}",encodeURIComponent(String(t))),a=new URL(n,s.DUMMY_BASE_URL);let i;e&&(i=e.baseOptions);const o=Object.assign(Object.assign({method:"GET"},i),r);s.setSearchParams(a,{});let c=i&&i.headers?i.headers:{};return o.headers=Object.assign(Object.assign(Object.assign({},{}),c),r.headers),{url:s.toPathString(a),options:o}})),retrieveModel:(t,r={})=>n(this,void 0,void 0,(function*(){s.assertParamExists("retrieveModel","model",t);const n="/models/{model}".replace("{model}",encodeURIComponent(String(t))),a=new URL(n,s.DUMMY_BASE_URL);let i;e&&(i=e.baseOptions);const o=Object.assign(Object.assign({method:"GET"},i),r);s.setSearchParams(a,{});let c=i&&i.headers?i.headers:{};return o.headers=Object.assign(Object.assign(Object.assign({},{}),c),r.headers),{url:s.toPathString(a),options:o}}))}},t.OpenAIApiFp=function(e){const r=t.OpenAIApiAxiosParamCreator(e);return{cancelFineTune(t,o){return n(this,void 0,void 0,(function*(){const n=yield r.cancelFineTune(t,o);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},createAnswer(t,o){return n(this,void 0,void 0,(function*(){const n=yield r.createAnswer(t,o);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},createChatCompletion(t,o){return n(this,void 0,void 0,(function*(){const n=yield r.createChatCompletion(t,o);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},createClassification(t,o){return n(this,void 0,void 0,(function*(){const n=yield r.createClassification(t,o);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},createCompletion(t,o){return n(this,void 0,void 0,(function*(){const n=yield r.createCompletion(t,o);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},createEdit(t,o){return n(this,void 0,void 0,(function*(){const n=yield r.createEdit(t,o);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},createEmbedding(t,o){return n(this,void 0,void 0,(function*(){const n=yield r.createEmbedding(t,o);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},createFile(t,o,c){return n(this,void 0,void 0,(function*(){const n=yield r.createFile(t,o,c);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},createFineTune(t,o){return n(this,void 0,void 0,(function*(){const n=yield r.createFineTune(t,o);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},createImage(t,o){return n(this,void 0,void 0,(function*(){const n=yield r.createImage(t,o);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},createImageEdit(t,o,c,u,l,d,h,p){return n(this,void 0,void 0,(function*(){const n=yield r.createImageEdit(t,o,c,u,l,d,h,p);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},createImageVariation(t,o,c,u,l,d){return n(this,void 0,void 0,(function*(){const n=yield r.createImageVariation(t,o,c,u,l,d);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},createModeration(t,o){return n(this,void 0,void 0,(function*(){const n=yield r.createModeration(t,o);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},createSearch(t,o,c){return n(this,void 0,void 0,(function*(){const n=yield r.createSearch(t,o,c);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},createTranscription(t,o,c,u,l,d,h){return n(this,void 0,void 0,(function*(){const n=yield r.createTranscription(t,o,c,u,l,d,h);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},createTranslation(t,o,c,u,l,d){return n(this,void 0,void 0,(function*(){const n=yield r.createTranslation(t,o,c,u,l,d);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},deleteFile(t,o){return n(this,void 0,void 0,(function*(){const n=yield r.deleteFile(t,o);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},deleteModel(t,o){return n(this,void 0,void 0,(function*(){const n=yield r.deleteModel(t,o);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},downloadFile(t,o){return n(this,void 0,void 0,(function*(){const n=yield r.downloadFile(t,o);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},listEngines(t){return n(this,void 0,void 0,(function*(){const n=yield r.listEngines(t);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},listFiles(t){return n(this,void 0,void 0,(function*(){const n=yield r.listFiles(t);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},listFineTuneEvents(t,o,c){return n(this,void 0,void 0,(function*(){const n=yield r.listFineTuneEvents(t,o,c);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},listFineTunes(t){return n(this,void 0,void 0,(function*(){const n=yield r.listFineTunes(t);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},listModels(t){return n(this,void 0,void 0,(function*(){const n=yield r.listModels(t);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},retrieveEngine(t,o){return n(this,void 0,void 0,(function*(){const n=yield r.retrieveEngine(t,o);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},retrieveFile(t,o){return n(this,void 0,void 0,(function*(){const n=yield r.retrieveFile(t,o);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},retrieveFineTune(t,o){return n(this,void 0,void 0,(function*(){const n=yield r.retrieveFineTune(t,o);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))},retrieveModel(t,o){return n(this,void 0,void 0,(function*(){const n=yield r.retrieveModel(t,o);return s.createRequestFunction(n,a.default,i.BASE_PATH,e)}))}}},t.OpenAIApiFactory=function(e,r,n){const a=t.OpenAIApiFp(e);return{cancelFineTune:(e,t)=>a.cancelFineTune(e,t).then((e=>e(n,r))),createAnswer:(e,t)=>a.createAnswer(e,t).then((e=>e(n,r))),createChatCompletion:(e,t)=>a.createChatCompletion(e,t).then((e=>e(n,r))),createClassification:(e,t)=>a.createClassification(e,t).then((e=>e(n,r))),createCompletion:(e,t)=>a.createCompletion(e,t).then((e=>e(n,r))),createEdit:(e,t)=>a.createEdit(e,t).then((e=>e(n,r))),createEmbedding:(e,t)=>a.createEmbedding(e,t).then((e=>e(n,r))),createFile:(e,t,s)=>a.createFile(e,t,s).then((e=>e(n,r))),createFineTune:(e,t)=>a.createFineTune(e,t).then((e=>e(n,r))),createImage:(e,t)=>a.createImage(e,t).then((e=>e(n,r))),createImageEdit:(e,t,s,i,o,c,u,l)=>a.createImageEdit(e,t,s,i,o,c,u,l).then((e=>e(n,r))),createImageVariation:(e,t,s,i,o,c)=>a.createImageVariation(e,t,s,i,o,c).then((e=>e(n,r))),createModeration:(e,t)=>a.createModeration(e,t).then((e=>e(n,r))),createSearch:(e,t,s)=>a.createSearch(e,t,s).then((e=>e(n,r))),createTranscription:(e,t,s,i,o,c,u)=>a.createTranscription(e,t,s,i,o,c,u).then((e=>e(n,r))),createTranslation:(e,t,s,i,o,c)=>a.createTranslation(e,t,s,i,o,c).then((e=>e(n,r))),deleteFile:(e,t)=>a.deleteFile(e,t).then((e=>e(n,r))),deleteModel:(e,t)=>a.deleteModel(e,t).then((e=>e(n,r))),downloadFile:(e,t)=>a.downloadFile(e,t).then((e=>e(n,r))),listEngines:e=>a.listEngines(e).then((e=>e(n,r))),listFiles:e=>a.listFiles(e).then((e=>e(n,r))),listFineTuneEvents:(e,t,s)=>a.listFineTuneEvents(e,t,s).then((e=>e(n,r))),listFineTunes:e=>a.listFineTunes(e).then((e=>e(n,r))),listModels:e=>a.listModels(e).then((e=>e(n,r))),retrieveEngine:(e,t)=>a.retrieveEngine(e,t).then((e=>e(n,r))),retrieveFile:(e,t)=>a.retrieveFile(e,t).then((e=>e(n,r))),retrieveFineTune:(e,t)=>a.retrieveFineTune(e,t).then((e=>e(n,r))),retrieveModel:(e,t)=>a.retrieveModel(e,t).then((e=>e(n,r)))}};class o extends i.BaseAPI{cancelFineTune(e,r){return t.OpenAIApiFp(this.configuration).cancelFineTune(e,r).then((e=>e(this.axios,this.basePath)))}createAnswer(e,r){return t.OpenAIApiFp(this.configuration).createAnswer(e,r).then((e=>e(this.axios,this.basePath)))}createChatCompletion(e,r){return t.OpenAIApiFp(this.configuration).createChatCompletion(e,r).then((e=>e(this.axios,this.basePath)))}createClassification(e,r){return t.OpenAIApiFp(this.configuration).createClassification(e,r).then((e=>e(this.axios,this.basePath)))}createCompletion(e,r){return t.OpenAIApiFp(this.configuration).createCompletion(e,r).then((e=>e(this.axios,this.basePath)))}createEdit(e,r){return t.OpenAIApiFp(this.configuration).createEdit(e,r).then((e=>e(this.axios,this.basePath)))}createEmbedding(e,r){return t.OpenAIApiFp(this.configuration).createEmbedding(e,r).then((e=>e(this.axios,this.basePath)))}createFile(e,r,n){return t.OpenAIApiFp(this.configuration).createFile(e,r,n).then((e=>e(this.axios,this.basePath)))}createFineTune(e,r){return t.OpenAIApiFp(this.configuration).createFineTune(e,r).then((e=>e(this.axios,this.basePath)))}createImage(e,r){return t.OpenAIApiFp(this.configuration).createImage(e,r).then((e=>e(this.axios,this.basePath)))}createImageEdit(e,r,n,a,s,i,o,c){return t.OpenAIApiFp(this.configuration).createImageEdit(e,r,n,a,s,i,o,c).then((e=>e(this.axios,this.basePath)))}createImageVariation(e,r,n,a,s,i){return t.OpenAIApiFp(this.configuration).createImageVariation(e,r,n,a,s,i).then((e=>e(this.axios,this.basePath)))}createModeration(e,r){return t.OpenAIApiFp(this.configuration).createModeration(e,r).then((e=>e(this.axios,this.basePath)))}createSearch(e,r,n){return t.OpenAIApiFp(this.configuration).createSearch(e,r,n).then((e=>e(this.axios,this.basePath)))}createTranscription(e,r,n,a,s,i,o){return t.OpenAIApiFp(this.configuration).createTranscription(e,r,n,a,s,i,o).then((e=>e(this.axios,this.basePath)))}createTranslation(e,r,n,a,s,i){return t.OpenAIApiFp(this.configuration).createTranslation(e,r,n,a,s,i).then((e=>e(this.axios,this.basePath)))}deleteFile(e,r){return t.OpenAIApiFp(this.configuration).deleteFile(e,r).then((e=>e(this.axios,this.basePath)))}deleteModel(e,r){return t.OpenAIApiFp(this.configuration).deleteModel(e,r).then((e=>e(this.axios,this.basePath)))}downloadFile(e,r){return t.OpenAIApiFp(this.configuration).downloadFile(e,r).then((e=>e(this.axios,this.basePath)))}listEngines(e){return t.OpenAIApiFp(this.configuration).listEngines(e).then((e=>e(this.axios,this.basePath)))}listFiles(e){return t.OpenAIApiFp(this.configuration).listFiles(e).then((e=>e(this.axios,this.basePath)))}listFineTuneEvents(e,r,n){return t.OpenAIApiFp(this.configuration).listFineTuneEvents(e,r,n).then((e=>e(this.axios,this.basePath)))}listFineTunes(e){return t.OpenAIApiFp(this.configuration).listFineTunes(e).then((e=>e(this.axios,this.basePath)))}listModels(e){return t.OpenAIApiFp(this.configuration).listModels(e).then((e=>e(this.axios,this.basePath)))}retrieveEngine(e,r){return t.OpenAIApiFp(this.configuration).retrieveEngine(e,r).then((e=>e(this.axios,this.basePath)))}retrieveFile(e,r){return t.OpenAIApiFp(this.configuration).retrieveFile(e,r).then((e=>e(this.axios,this.basePath)))}retrieveFineTune(e,r){return t.OpenAIApiFp(this.configuration).retrieveFineTune(e,r).then((e=>e(this.axios,this.basePath)))}retrieveModel(e,r){return t.OpenAIApiFp(this.configuration).retrieveModel(e,r).then((e=>e(this.axios,this.basePath)))}}t.OpenAIApi=o},5232:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RequiredError=t.BaseAPI=t.COLLECTION_FORMATS=t.BASE_PATH=void 0;const n=r(9669);t.BASE_PATH="https://api.openai.com/v1".replace(/\/+$/,""),t.COLLECTION_FORMATS={csv:",",ssv:" ",tsv:"\t",pipes:"|"},t.BaseAPI=class{constructor(e,r=t.BASE_PATH,a=n.default){this.basePath=r,this.axios=a,e&&(this.configuration=e,this.basePath=e.basePath||this.basePath)}};class a extends Error{constructor(e,t){super(t),this.field=e,this.name="RequiredError"}}t.RequiredError=a},8298:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,s){function i(e){try{c(n.next(e))}catch(e){s(e)}}function o(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,o)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.createRequestFunction=t.toPathString=t.serializeDataIfNeeded=t.setSearchParams=t.setOAuthToObject=t.setBearerAuthToObject=t.setBasicAuthToObject=t.setApiKeyToObject=t.assertParamExists=t.DUMMY_BASE_URL=void 0;const a=r(5232);function s(e,t,r=""){null!=t&&("object"==typeof t?Array.isArray(t)?t.forEach((t=>s(e,t,r))):Object.keys(t).forEach((n=>s(e,t[n],`${r}${""!==r?".":""}${n}`))):e.has(r)?e.append(r,t):e.set(r,t))}t.DUMMY_BASE_URL="https://example.com",t.assertParamExists=function(e,t,r){if(null==r)throw new a.RequiredError(t,`Required parameter ${t} was null or undefined when calling ${e}.`)},t.setApiKeyToObject=function(e,t,r){return n(this,void 0,void 0,(function*(){if(r&&r.apiKey){const n="function"==typeof r.apiKey?yield r.apiKey(t):yield r.apiKey;e[t]=n}}))},t.setBasicAuthToObject=function(e,t){t&&(t.username||t.password)&&(e.auth={username:t.username,password:t.password})},t.setBearerAuthToObject=function(e,t){return n(this,void 0,void 0,(function*(){if(t&&t.accessToken){const r="function"==typeof t.accessToken?yield t.accessToken():yield t.accessToken;e.Authorization="Bearer "+r}}))},t.setOAuthToObject=function(e,t,r,a){return n(this,void 0,void 0,(function*(){if(a&&a.accessToken){const n="function"==typeof a.accessToken?yield a.accessToken(t,r):yield a.accessToken;e.Authorization="Bearer "+n}}))},t.setSearchParams=function(e,...t){const r=new URLSearchParams(e.search);s(r,t),e.search=r.toString()},t.serializeDataIfNeeded=function(e,t,r){const n="string"!=typeof e;return(n&&r&&r.isJsonMime?r.isJsonMime(t.headers["Content-Type"]):n)?JSON.stringify(void 0!==e?e:{}):e||""},t.toPathString=function(e){return e.pathname+e.search+e.hash},t.createRequestFunction=function(e,t,r,n){return(a=t,s=r)=>{const i=Object.assign(Object.assign({},e.options),{url:((null==n?void 0:n.basePath)||s)+e.url});return a.request(i)}}},2062:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Configuration=void 0;const n=r(2611);t.Configuration=class{constructor(e={}){this.apiKey=e.apiKey,this.organization=e.organization,this.username=e.username,this.password=e.password,this.accessToken=e.accessToken,this.basePath=e.basePath,this.baseOptions=e.baseOptions,this.formDataCtor=e.formDataCtor,this.baseOptions||(this.baseOptions={}),this.baseOptions.headers=Object.assign({"User-Agent":`OpenAI/NodeJS/${n.version}`,Authorization:`Bearer ${this.apiKey}`},this.baseOptions.headers),this.organization&&(this.baseOptions.headers["OpenAI-Organization"]=this.organization),this.formDataCtor||(this.formDataCtor=r(1696))}isJsonMime(e){const t=new RegExp("^(application/json|[^;/ \t]+/[^;/ \t]+[+]json)[ \t]*(;.*)?$","i");return null!==e&&(t.test(e)||"application/json-patch+json"===e.toLowerCase())}}},5524:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(7945),t),a(r(2062),t)},6563:(e,t)=>{"use strict"},705:e=>{e.exports=function e(t,r,n){function a(i,o){if(!r[i]){if(!t[i]){if(s)return s(i,!0);throw new Error("Cannot find module '"+i+"'")}o=r[i]={exports:{}},t[i][0].call(o.exports,(function(e){return a(t[i][1][e]||e)}),o,o.exports,e,t,r,n)}return r[i].exports}for(var s=void 0,i=0;i<n.length;i++)a(n[i]);return a}({1:[function(e,t,r){(function(n,a,s,i,o,c,u,l,d){"use strict";var h=e("crypto");function p(e,t){var r;return void 0===(r="passthrough"!==(t=g(e,t)).algorithm?h.createHash(t.algorithm):new v).write&&(r.write=r.update,r.end=r.update),b(t,r).dispatch(e),r.update||r.end(""),r.digest?r.digest("buffer"===t.encoding?void 0:t.encoding):(e=r.read(),"buffer"!==t.encoding?e.toString(t.encoding):e)}(r=t.exports=p).sha1=function(e){return p(e)},r.keys=function(e){return p(e,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},r.MD5=function(e){return p(e,{algorithm:"md5",encoding:"hex"})},r.keysMD5=function(e){return p(e,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var f=h.getHashes?h.getHashes().slice():["sha1","md5"],m=(f.push("passthrough"),["buffer","hex","binary","base64"]);function g(e,t){var r={};if(r.algorithm=(t=t||{}).algorithm||"sha1",r.encoding=t.encoding||"hex",r.excludeValues=!!t.excludeValues,r.algorithm=r.algorithm.toLowerCase(),r.encoding=r.encoding.toLowerCase(),r.ignoreUnknown=!0===t.ignoreUnknown,r.respectType=!1!==t.respectType,r.respectFunctionNames=!1!==t.respectFunctionNames,r.respectFunctionProperties=!1!==t.respectFunctionProperties,r.unorderedArrays=!0===t.unorderedArrays,r.unorderedSets=!1!==t.unorderedSets,r.unorderedObjects=!1!==t.unorderedObjects,r.replacer=t.replacer||void 0,r.excludeKeys=t.excludeKeys||void 0,void 0===e)throw new Error("Object argument required.");for(var n=0;n<f.length;++n)f[n].toLowerCase()===r.algorithm.toLowerCase()&&(r.algorithm=f[n]);if(-1===f.indexOf(r.algorithm))throw new Error('Algorithm "'+r.algorithm+'"  not supported. supported values: '+f.join(", "));if(-1===m.indexOf(r.encoding)&&"passthrough"!==r.algorithm)throw new Error('Encoding "'+r.encoding+'"  not supported. supported values: '+m.join(", "));return r}function y(e){if("function"==typeof e)return null!=/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))}function b(e,t,r){function n(e){return t.update?t.update(e,"utf8"):t.write(e,"utf8")}return r=r||[],{dispatch:function(t){return this["_"+(null===(t=e.replacer?e.replacer(t):t)?"null":typeof t)](t)},_object:function(t){var a,i=Object.prototype.toString.call(t),o=/\[object (.*)\]/i.exec(i);if(o=(o=o?o[1]:"unknown:["+i+"]").toLowerCase(),0<=(i=r.indexOf(t)))return this.dispatch("[CIRCULAR:"+i+"]");if(r.push(t),void 0!==s&&s.isBuffer&&s.isBuffer(t))return n("buffer:"),n(t);if("object"===o||"function"===o||"asyncfunction"===o)return i=Object.keys(t),e.unorderedObjects&&(i=i.sort()),!1===e.respectType||y(t)||i.splice(0,0,"prototype","__proto__","constructor"),e.excludeKeys&&(i=i.filter((function(t){return!e.excludeKeys(t)}))),n("object:"+i.length+":"),a=this,i.forEach((function(r){a.dispatch(r),n(":"),e.excludeValues||a.dispatch(t[r]),n(",")}));if(!this["_"+o]){if(e.ignoreUnknown)return n("["+o+"]");throw new Error('Unknown object type "'+o+'"')}this["_"+o](t)},_array:function(t,a){a=void 0!==a?a:!1!==e.unorderedArrays;var s=this;if(n("array:"+t.length+":"),!a||t.length<=1)return t.forEach((function(e){return s.dispatch(e)}));var i=[];return a=t.map((function(t){var n=new v,a=r.slice();return b(e,n,a).dispatch(t),i=i.concat(a.slice(r.length)),n.read().toString()})),r=r.concat(i),a.sort(),this._array(a,!1)},_date:function(e){return n("date:"+e.toJSON())},_symbol:function(e){return n("symbol:"+e.toString())},_error:function(e){return n("error:"+e.toString())},_boolean:function(e){return n("bool:"+e.toString())},_string:function(e){n("string:"+e.length+":"),n(e.toString())},_function:function(t){n("fn:"),y(t)?this.dispatch("[native]"):this.dispatch(t.toString()),!1!==e.respectFunctionNames&&this.dispatch("function-name:"+String(t.name)),e.respectFunctionProperties&&this._object(t)},_number:function(e){return n("number:"+e.toString())},_xml:function(e){return n("xml:"+e.toString())},_null:function(){return n("Null")},_undefined:function(){return n("Undefined")},_regexp:function(e){return n("regex:"+e.toString())},_uint8array:function(e){return n("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint8clampedarray:function(e){return n("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(e))},_int8array:function(e){return n("int8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint16array:function(e){return n("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_int16array:function(e){return n("int16array:"),this.dispatch(Array.prototype.slice.call(e))},_uint32array:function(e){return n("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_int32array:function(e){return n("int32array:"),this.dispatch(Array.prototype.slice.call(e))},_float32array:function(e){return n("float32array:"),this.dispatch(Array.prototype.slice.call(e))},_float64array:function(e){return n("float64array:"),this.dispatch(Array.prototype.slice.call(e))},_arraybuffer:function(e){return n("arraybuffer:"),this.dispatch(new Uint8Array(e))},_url:function(e){return n("url:"+e.toString())},_map:function(t){return n("map:"),t=Array.from(t),this._array(t,!1!==e.unorderedSets)},_set:function(t){return n("set:"),t=Array.from(t),this._array(t,!1!==e.unorderedSets)},_file:function(e){return n("file:"),this.dispatch([e.name,e.size,e.type,e.lastModfied])},_blob:function(){if(e.ignoreUnknown)return n("[blob]");throw Error('Hashing Blob objects is currently not supported\n(see https://github.com/puleos/object-hash/issues/26)\nUse "options.replacer" or "options.ignoreUnknown"\n')},_domwindow:function(){return n("domwindow")},_bigint:function(e){return n("bigint:"+e.toString())},_process:function(){return n("process")},_timer:function(){return n("timer")},_pipe:function(){return n("pipe")},_tcp:function(){return n("tcp")},_udp:function(){return n("udp")},_tty:function(){return n("tty")},_statwatcher:function(){return n("statwatcher")},_securecontext:function(){return n("securecontext")},_connection:function(){return n("connection")},_zlib:function(){return n("zlib")},_context:function(){return n("context")},_nodescript:function(){return n("nodescript")},_httpparser:function(){return n("httpparser")},_dataview:function(){return n("dataview")},_signal:function(){return n("signal")},_fsevent:function(){return n("fsevent")},_tlswrap:function(){return n("tlswrap")}}}function v(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}r.writeToStream=function(e,t,r){return void 0===r&&(r=t,t={}),b(t=g(e,t),r).dispatch(e)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(e,t,r){(function(e,t,n,a,s,i,o,c,u){!function(e){"use strict";var t="undefined"!=typeof Uint8Array?Uint8Array:Array,r="+".charCodeAt(0),n="/".charCodeAt(0),a="0".charCodeAt(0),s="a".charCodeAt(0),i="A".charCodeAt(0),o="-".charCodeAt(0),c="_".charCodeAt(0);function u(e){return(e=e.charCodeAt(0))===r||e===o?62:e===n||e===c?63:e<a?-1:e<a+10?e-a+26+26:e<i+26?e-i:e<s+26?e-s+26:void 0}e.toByteArray=function(e){var r,n;if(0<e.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var a=e.length,s=(a="="===e.charAt(a-2)?2:"="===e.charAt(a-1)?1:0,new t(3*e.length/4-a)),i=0<a?e.length-4:e.length,o=0;function c(e){s[o++]=e}for(r=0;r<i;r+=4,0)c((16711680&(n=u(e.charAt(r))<<18|u(e.charAt(r+1))<<12|u(e.charAt(r+2))<<6|u(e.charAt(r+3))))>>16),c((65280&n)>>8),c(255&n);return 2==a?c(255&(n=u(e.charAt(r))<<2|u(e.charAt(r+1))>>4)):1==a&&(c((n=u(e.charAt(r))<<10|u(e.charAt(r+1))<<4|u(e.charAt(r+2))>>2)>>8&255),c(255&n)),s},e.fromByteArray=function(e){var t,r,n,a,s=e.length%3,i="";function o(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)}for(t=0,n=e.length-s;t<n;t+=3)i+=o((a=r=(e[t]<<16)+(e[t+1]<<8)+e[t+2])>>18&63)+o(a>>12&63)+o(a>>6&63)+o(63&a);switch(s){case 1:i=(i+=o((r=e[e.length-1])>>2))+o(r<<4&63)+"==";break;case 2:i=(i=(i+=o((r=(e[e.length-2]<<8)+e[e.length-1])>>10))+o(r>>4&63))+o(r<<2&63)+"="}return i}}(void 0===r?this.base64js={}:r)}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(e,t,r){(function(t,n,a,s,i,o,c,u,l){var d=e("base64-js"),h=e("ieee754");function a(e,t,r){if(!(this instanceof a))return new a(e,t,r);var n,s,i,o,c=typeof e;if("base64"===t&&"string"==c)for(e=(o=e).trim?o.trim():o.replace(/^\s+|\s+$/g,"");e.length%4!=0;)e+="=";if("number"==c)n=T(e);else if("string"==c)n=a.byteLength(e,t);else{if("object"!=c)throw new Error("First argument needs to be a number, array or string.");n=T(e.length)}if(a._useTypedArrays?s=a._augment(new Uint8Array(n)):((s=this).length=n,s._isBuffer=!0),a._useTypedArrays&&"number"==typeof e.byteLength)s._set(e);else if(E(o=e)||a.isBuffer(o)||o&&"object"==typeof o&&"number"==typeof o.length)for(i=0;i<n;i++)a.isBuffer(e)?s[i]=e.readUInt8(i):s[i]=e[i];else if("string"==c)s.write(e,0,t);else if("number"==c&&!a._useTypedArrays&&!r)for(i=0;i<n;i++)s[i]=0;return s}function p(e,t,r,n){var a;if(n||(Z("boolean"==typeof r,"missing or invalid endian"),Z(null!=t,"missing offset"),Z(t+1<e.length,"Trying to read beyond buffer length")),!((n=e.length)<=t))return r?(a=e[t],t+1<n&&(a|=e[t+1]<<8)):(a=e[t]<<8,t+1<n&&(a|=e[t+1])),a}function f(e,t,r,n){var a;if(n||(Z("boolean"==typeof r,"missing or invalid endian"),Z(null!=t,"missing offset"),Z(t+3<e.length,"Trying to read beyond buffer length")),!((n=e.length)<=t))return r?(t+2<n&&(a=e[t+2]<<16),t+1<n&&(a|=e[t+1]<<8),a|=e[t],t+3<n&&(a+=e[t+3]<<24>>>0)):(t+1<n&&(a=e[t+1]<<16),t+2<n&&(a|=e[t+2]<<8),t+3<n&&(a|=e[t+3]),a+=e[t]<<24>>>0),a}function m(e,t,r,n){if(n||(Z("boolean"==typeof r,"missing or invalid endian"),Z(null!=t,"missing offset"),Z(t+1<e.length,"Trying to read beyond buffer length")),!(e.length<=t))return 32768&(n=p(e,t,r,!0))?-1*(65535-n+1):n}function g(e,t,r,n){if(n||(Z("boolean"==typeof r,"missing or invalid endian"),Z(null!=t,"missing offset"),Z(t+3<e.length,"Trying to read beyond buffer length")),!(e.length<=t))return 2147483648&(n=f(e,t,r,!0))?-1*(4294967295-n+1):n}function y(e,t,r,n){return n||(Z("boolean"==typeof r,"missing or invalid endian"),Z(t+3<e.length,"Trying to read beyond buffer length")),h.read(e,t,r,23,4)}function b(e,t,r,n){return n||(Z("boolean"==typeof r,"missing or invalid endian"),Z(t+7<e.length,"Trying to read beyond buffer length")),h.read(e,t,r,52,8)}function v(e,t,r,n,a){if(a||(Z(null!=t,"missing value"),Z("boolean"==typeof n,"missing or invalid endian"),Z(null!=r,"missing offset"),Z(r+1<e.length,"trying to write beyond buffer length"),R(t,65535)),!((a=e.length)<=r))for(var s=0,i=Math.min(a-r,2);s<i;s++)e[r+s]=(t&255<<8*(n?s:1-s))>>>8*(n?s:1-s)}function _(e,t,r,n,a){if(a||(Z(null!=t,"missing value"),Z("boolean"==typeof n,"missing or invalid endian"),Z(null!=r,"missing offset"),Z(r+3<e.length,"trying to write beyond buffer length"),R(t,4294967295)),!((a=e.length)<=r))for(var s=0,i=Math.min(a-r,4);s<i;s++)e[r+s]=t>>>8*(n?s:3-s)&255}function w(e,t,r,n,a){a||(Z(null!=t,"missing value"),Z("boolean"==typeof n,"missing or invalid endian"),Z(null!=r,"missing offset"),Z(r+1<e.length,"Trying to write beyond buffer length"),M(t,32767,-32768)),e.length<=r||v(e,0<=t?t:65535+t+1,r,n,a)}function O(e,t,r,n,a){a||(Z(null!=t,"missing value"),Z("boolean"==typeof n,"missing or invalid endian"),Z(null!=r,"missing offset"),Z(r+3<e.length,"Trying to write beyond buffer length"),M(t,2147483647,-2147483648)),e.length<=r||_(e,0<=t?t:4294967295+t+1,r,n,a)}function x(e,t,r,n,a){a||(Z(null!=t,"missing value"),Z("boolean"==typeof n,"missing or invalid endian"),Z(null!=r,"missing offset"),Z(r+3<e.length,"Trying to write beyond buffer length"),L(t,34028234663852886e22,-34028234663852886e22)),e.length<=r||h.write(e,t,r,n,23,4)}function P(e,t,r,n,a){a||(Z(null!=t,"missing value"),Z("boolean"==typeof n,"missing or invalid endian"),Z(null!=r,"missing offset"),Z(r+7<e.length,"Trying to write beyond buffer length"),L(t,17976931348623157e292,-17976931348623157e292)),e.length<=r||h.write(e,t,r,n,52,8)}r.Buffer=a,r.SlowBuffer=a,r.INSPECT_MAX_BYTES=50,a.poolSize=8192,a._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray}catch(e){return!1}}(),a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.isBuffer=function(e){return!(null==e||!e._isBuffer)},a.byteLength=function(e,t){var r;switch(e+="",t||"utf8"){case"hex":r=e.length/2;break;case"utf8":case"utf-8":r=j(e).length;break;case"ascii":case"binary":case"raw":r=e.length;break;case"base64":r=S(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=2*e.length;break;default:throw new Error("Unknown encoding")}return r},a.concat=function(e,t){if(Z(E(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===e.length)return new a(0);if(1===e.length)return e[0];if("number"!=typeof t)for(s=t=0;s<e.length;s++)t+=e[s].length;for(var r=new a(t),n=0,s=0;s<e.length;s++){var i=e[s];i.copy(r,n),n+=i.length}return r},a.prototype.write=function(e,t,r,n){isFinite(t)?isFinite(r)||(n=r,r=void 0):(u=n,n=t,t=r,r=u),t=Number(t)||0;var s,i,o,c,u=this.length-t;switch((!r||u<(r=Number(r)))&&(r=u),n=String(n||"utf8").toLowerCase()){case"hex":s=function(e,t,r,n){r=Number(r)||0;var s=e.length-r;(!n||s<(n=Number(n)))&&(n=s),Z((s=t.length)%2==0,"Invalid hex string"),s/2<n&&(n=s/2);for(var i=0;i<n;i++){var o=parseInt(t.substr(2*i,2),16);Z(!isNaN(o),"Invalid hex string"),e[r+i]=o}return a._charsWritten=2*i,i}(this,e,t,r);break;case"utf8":case"utf-8":i=this,o=t,c=r,s=a._charsWritten=C(j(e),i,o,c);break;case"ascii":case"binary":s=function(e,t,r,n){return a._charsWritten=C(function(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}(this,e,t,r);break;case"base64":i=this,o=t,c=r,s=a._charsWritten=C(S(e),i,o,c);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":s=function(e,t,r,n){return a._charsWritten=C(function(e){for(var t,r,n=[],a=0;a<e.length;a++)t=(r=e.charCodeAt(a))>>8,r%=256,n.push(r),n.push(t);return n}(t),e,r,n)}(this,e,t,r);break;default:throw new Error("Unknown encoding")}return s},a.prototype.toString=function(e,t,r){var n,a,s,i,o=this;if(e=String(e||"utf8").toLowerCase(),t=Number(t)||0,(r=void 0!==r?Number(r):o.length)===t)return"";switch(e){case"hex":n=function(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||n<r)&&(r=n);for(var a="",s=t;s<r;s++)a+=k(e[s]);return a}(o,t,r);break;case"utf8":case"utf-8":n=function(e,t,r){var n="",a="";r=Math.min(e.length,r);for(var s=t;s<r;s++)e[s]<=127?(n+=N(a)+String.fromCharCode(e[s]),a=""):a+="%"+e[s].toString(16);return n+N(a)}(o,t,r);break;case"ascii":case"binary":n=function(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;a++)n+=String.fromCharCode(e[a]);return n}(o,t,r);break;case"base64":a=o,i=r,n=0===(s=t)&&i===a.length?d.fromByteArray(a):d.fromByteArray(a.slice(s,i));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=function(e,t,r){for(var n=e.slice(t,r),a="",s=0;s<n.length;s+=2)a+=String.fromCharCode(n[s]+256*n[s+1]);return a}(o,t,r);break;default:throw new Error("Unknown encoding")}return n},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},a.prototype.copy=function(e,t,r,n){if(t=t||0,(n=n||0===n?n:this.length)!==(r=r||0)&&0!==e.length&&0!==this.length){Z(r<=n,"sourceEnd < sourceStart"),Z(0<=t&&t<e.length,"targetStart out of bounds"),Z(0<=r&&r<this.length,"sourceStart out of bounds"),Z(0<=n&&n<=this.length,"sourceEnd out of bounds"),n>this.length&&(n=this.length);var s=(n=e.length-t<n-r?e.length-t+r:n)-r;if(s<100||!a._useTypedArrays)for(var i=0;i<s;i++)e[i+t]=this[i+r];else e._set(this.subarray(r,r+s),t)}},a.prototype.slice=function(e,t){var r=this.length;if(e=I(e,r,0),t=I(t,r,r),a._useTypedArrays)return a._augment(this.subarray(e,t));for(var n=t-e,s=new a(n,void 0,!0),i=0;i<n;i++)s[i]=this[i+e];return s},a.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},a.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},a.prototype.readUInt8=function(e,t){if(t||(Z(null!=e,"missing offset"),Z(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},a.prototype.readUInt16LE=function(e,t){return p(this,e,!0,t)},a.prototype.readUInt16BE=function(e,t){return p(this,e,!1,t)},a.prototype.readUInt32LE=function(e,t){return f(this,e,!0,t)},a.prototype.readUInt32BE=function(e,t){return f(this,e,!1,t)},a.prototype.readInt8=function(e,t){if(t||(Z(null!=e,"missing offset"),Z(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){return m(this,e,!0,t)},a.prototype.readInt16BE=function(e,t){return m(this,e,!1,t)},a.prototype.readInt32LE=function(e,t){return g(this,e,!0,t)},a.prototype.readInt32BE=function(e,t){return g(this,e,!1,t)},a.prototype.readFloatLE=function(e,t){return y(this,e,!0,t)},a.prototype.readFloatBE=function(e,t){return y(this,e,!1,t)},a.prototype.readDoubleLE=function(e,t){return b(this,e,!0,t)},a.prototype.readDoubleBE=function(e,t){return b(this,e,!1,t)},a.prototype.writeUInt8=function(e,t,r){r||(Z(null!=e,"missing value"),Z(null!=t,"missing offset"),Z(t<this.length,"trying to write beyond buffer length"),R(e,255)),t>=this.length||(this[t]=e)},a.prototype.writeUInt16LE=function(e,t,r){v(this,e,t,!0,r)},a.prototype.writeUInt16BE=function(e,t,r){v(this,e,t,!1,r)},a.prototype.writeUInt32LE=function(e,t,r){_(this,e,t,!0,r)},a.prototype.writeUInt32BE=function(e,t,r){_(this,e,t,!1,r)},a.prototype.writeInt8=function(e,t,r){r||(Z(null!=e,"missing value"),Z(null!=t,"missing offset"),Z(t<this.length,"Trying to write beyond buffer length"),M(e,127,-128)),t>=this.length||(0<=e?this.writeUInt8(e,t,r):this.writeUInt8(255+e+1,t,r))},a.prototype.writeInt16LE=function(e,t,r){w(this,e,t,!0,r)},a.prototype.writeInt16BE=function(e,t,r){w(this,e,t,!1,r)},a.prototype.writeInt32LE=function(e,t,r){O(this,e,t,!0,r)},a.prototype.writeInt32BE=function(e,t,r){O(this,e,t,!1,r)},a.prototype.writeFloatLE=function(e,t,r){x(this,e,t,!0,r)},a.prototype.writeFloatBE=function(e,t,r){x(this,e,t,!1,r)},a.prototype.writeDoubleLE=function(e,t,r){P(this,e,t,!0,r)},a.prototype.writeDoubleBE=function(e,t,r){P(this,e,t,!1,r)},a.prototype.fill=function(e,t,r){if(t=t||0,r=r||this.length,Z("number"==typeof(e="string"==typeof(e=e||0)?e.charCodeAt(0):e)&&!isNaN(e),"value is not a number"),Z(t<=r,"end < start"),r!==t&&0!==this.length){Z(0<=t&&t<this.length,"start out of bounds"),Z(0<=r&&r<=this.length,"end out of bounds");for(var n=t;n<r;n++)this[n]=e}},a.prototype.inspect=function(){for(var e=[],t=this.length,n=0;n<t;n++)if(e[n]=k(this[n]),n===r.INSPECT_MAX_BYTES){e[n+1]="...";break}return"<Buffer "+e.join(" ")+">"},a.prototype.toArrayBuffer=function(){if("undefined"==typeof Uint8Array)throw new Error("Buffer.toArrayBuffer not supported in this browser");if(a._useTypedArrays)return new a(this).buffer;for(var e=new Uint8Array(this.length),t=0,r=e.length;t<r;t+=1)e[t]=this[t];return e.buffer};var A=a.prototype;function I(e,t,r){return"number"!=typeof e?r:t<=(e=~~e)?t:0<=e||0<=(e+=t)?e:0}function T(e){return(e=~~Math.ceil(+e))<0?0:e}function E(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function k(e){return e<16?"0"+e.toString(16):e.toString(16)}function j(e){for(var t=[],r=0;r<e.length;r++){var n=e.charCodeAt(r);if(n<=127)t.push(e.charCodeAt(r));else for(var a=r,s=(55296<=n&&n<=57343&&r++,encodeURIComponent(e.slice(a,r+1)).substr(1).split("%")),i=0;i<s.length;i++)t.push(parseInt(s[i],16))}return t}function S(e){return d.toByteArray(e)}function C(e,t,r,n){for(var a=0;a<n&&!(a+r>=t.length||a>=e.length);a++)t[a+r]=e[a];return a}function N(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}function R(e,t){Z("number"==typeof e,"cannot write a non-number as a number"),Z(0<=e,"specified a negative value for writing an unsigned value"),Z(e<=t,"value is larger than maximum value for type"),Z(Math.floor(e)===e,"value has a fractional component")}function M(e,t,r){Z("number"==typeof e,"cannot write a non-number as a number"),Z(e<=t,"value larger than maximum allowed value"),Z(r<=e,"value smaller than minimum allowed value"),Z(Math.floor(e)===e,"value has a fractional component")}function L(e,t,r){Z("number"==typeof e,"cannot write a non-number as a number"),Z(e<=t,"value larger than maximum allowed value"),Z(r<=e,"value smaller than minimum allowed value")}function Z(e,t){if(!e)throw new Error(t||"Failed assertion")}a._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=A.get,e.set=A.set,e.write=A.write,e.toString=A.toString,e.toLocaleString=A.toString,e.toJSON=A.toJSON,e.copy=A.copy,e.slice=A.slice,e.readUInt8=A.readUInt8,e.readUInt16LE=A.readUInt16LE,e.readUInt16BE=A.readUInt16BE,e.readUInt32LE=A.readUInt32LE,e.readUInt32BE=A.readUInt32BE,e.readInt8=A.readInt8,e.readInt16LE=A.readInt16LE,e.readInt16BE=A.readInt16BE,e.readInt32LE=A.readInt32LE,e.readInt32BE=A.readInt32BE,e.readFloatLE=A.readFloatLE,e.readFloatBE=A.readFloatBE,e.readDoubleLE=A.readDoubleLE,e.readDoubleBE=A.readDoubleBE,e.writeUInt8=A.writeUInt8,e.writeUInt16LE=A.writeUInt16LE,e.writeUInt16BE=A.writeUInt16BE,e.writeUInt32LE=A.writeUInt32LE,e.writeUInt32BE=A.writeUInt32BE,e.writeInt8=A.writeInt8,e.writeInt16LE=A.writeInt16LE,e.writeInt16BE=A.writeInt16BE,e.writeInt32LE=A.writeInt32LE,e.writeInt32BE=A.writeInt32BE,e.writeFloatLE=A.writeFloatLE,e.writeFloatBE=A.writeFloatBE,e.writeDoubleLE=A.writeDoubleLE,e.writeDoubleBE=A.writeDoubleBE,e.fill=A.fill,e.inspect=A.inspect,e.toArrayBuffer=A.toArrayBuffer,e}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(e,t,r){(function(r,n,a,s,i,o,c,u,l){a=e("buffer").Buffer;var d=new a(4);d.fill(0),t.exports={hash:function(e,t,r,n){for(var s=t(function(e,t){e.length%4!=0&&(r=e.length+(4-e.length%4),e=a.concat([e,d],r));for(var r,n=[],s=t?e.readInt32BE:e.readInt32LE,i=0;i<e.length;i+=4)n.push(s.call(e,i));return n}(e=a.isBuffer(e)?e:new a(e),n),8*e.length),i=(t=n,new a(r)),o=t?i.writeInt32BE:i.writeInt32LE,c=0;c<s.length;c++)o.call(i,s[c],4*c,!0);return i}}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(e,t,r){(function(t,n,a,s,i,o,c,u,l){a=e("buffer").Buffer;var d=e("./sha"),h=e("./sha256"),p=e("./rng"),f={sha1:d,sha256:h,md5:e("./md5")},m=64,g=new a(m);function y(e,t){var r=f[e=e||"sha1"],n=[];return r||b("algorithm:",e,"is not yet supported"),{update:function(e){return a.isBuffer(e)||(e=new a(e)),n.push(e),e.length,this},digest:function(e){var s=a.concat(n);return s=t?function(e,t,r){a.isBuffer(t)||(t=new a(t)),a.isBuffer(r)||(r=new a(r)),t.length>m?t=e(t):t.length<m&&(t=a.concat([t,g],m));for(var n=new a(m),s=new a(m),i=0;i<m;i++)n[i]=54^t[i],s[i]=92^t[i];return r=e(a.concat([n,r])),e(a.concat([s,r]))}(r,t,s):r(s),n=null,e?s.toString(e):s}}}function b(){var e=[].slice.call(arguments).join(" ");throw new Error([e,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}g.fill(0),r.createHash=function(e){return y(e)},r.createHmac=y,r.randomBytes=function(e,t){if(!t||!t.call)return new a(p(e));try{t.call(this,void 0,new a(p(e)))}catch(e){t(e)}};var v,_=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],w=function(e){r[e]=function(){b("sorry,",e,"is not implemented yet")}};for(v in _)w(_[v])}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(e,t,r){(function(r,n,a,s,i,o,c,u,l){var d=e("./helpers");function h(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var r=1732584193,n=-271733879,a=-1732584194,s=271733878,i=0;i<e.length;i+=16){var o=r,c=n,u=a,l=s;r=f(r,n,a,s,e[i+0],7,-680876936),s=f(s,r,n,a,e[i+1],12,-389564586),a=f(a,s,r,n,e[i+2],17,606105819),n=f(n,a,s,r,e[i+3],22,-1044525330),r=f(r,n,a,s,e[i+4],7,-176418897),s=f(s,r,n,a,e[i+5],12,1200080426),a=f(a,s,r,n,e[i+6],17,-1473231341),n=f(n,a,s,r,e[i+7],22,-45705983),r=f(r,n,a,s,e[i+8],7,1770035416),s=f(s,r,n,a,e[i+9],12,-1958414417),a=f(a,s,r,n,e[i+10],17,-42063),n=f(n,a,s,r,e[i+11],22,-1990404162),r=f(r,n,a,s,e[i+12],7,1804603682),s=f(s,r,n,a,e[i+13],12,-40341101),a=f(a,s,r,n,e[i+14],17,-1502002290),r=m(r,n=f(n,a,s,r,e[i+15],22,1236535329),a,s,e[i+1],5,-165796510),s=m(s,r,n,a,e[i+6],9,-1069501632),a=m(a,s,r,n,e[i+11],14,643717713),n=m(n,a,s,r,e[i+0],20,-373897302),r=m(r,n,a,s,e[i+5],5,-701558691),s=m(s,r,n,a,e[i+10],9,38016083),a=m(a,s,r,n,e[i+15],14,-660478335),n=m(n,a,s,r,e[i+4],20,-405537848),r=m(r,n,a,s,e[i+9],5,568446438),s=m(s,r,n,a,e[i+14],9,-1019803690),a=m(a,s,r,n,e[i+3],14,-187363961),n=m(n,a,s,r,e[i+8],20,1163531501),r=m(r,n,a,s,e[i+13],5,-1444681467),s=m(s,r,n,a,e[i+2],9,-51403784),a=m(a,s,r,n,e[i+7],14,1735328473),r=g(r,n=m(n,a,s,r,e[i+12],20,-1926607734),a,s,e[i+5],4,-378558),s=g(s,r,n,a,e[i+8],11,-2022574463),a=g(a,s,r,n,e[i+11],16,1839030562),n=g(n,a,s,r,e[i+14],23,-35309556),r=g(r,n,a,s,e[i+1],4,-1530992060),s=g(s,r,n,a,e[i+4],11,1272893353),a=g(a,s,r,n,e[i+7],16,-155497632),n=g(n,a,s,r,e[i+10],23,-1094730640),r=g(r,n,a,s,e[i+13],4,681279174),s=g(s,r,n,a,e[i+0],11,-358537222),a=g(a,s,r,n,e[i+3],16,-722521979),n=g(n,a,s,r,e[i+6],23,76029189),r=g(r,n,a,s,e[i+9],4,-640364487),s=g(s,r,n,a,e[i+12],11,-421815835),a=g(a,s,r,n,e[i+15],16,530742520),r=y(r,n=g(n,a,s,r,e[i+2],23,-995338651),a,s,e[i+0],6,-198630844),s=y(s,r,n,a,e[i+7],10,1126891415),a=y(a,s,r,n,e[i+14],15,-1416354905),n=y(n,a,s,r,e[i+5],21,-57434055),r=y(r,n,a,s,e[i+12],6,1700485571),s=y(s,r,n,a,e[i+3],10,-1894986606),a=y(a,s,r,n,e[i+10],15,-1051523),n=y(n,a,s,r,e[i+1],21,-2054922799),r=y(r,n,a,s,e[i+8],6,1873313359),s=y(s,r,n,a,e[i+15],10,-30611744),a=y(a,s,r,n,e[i+6],15,-1560198380),n=y(n,a,s,r,e[i+13],21,1309151649),r=y(r,n,a,s,e[i+4],6,-145523070),s=y(s,r,n,a,e[i+11],10,-1120210379),a=y(a,s,r,n,e[i+2],15,718787259),n=y(n,a,s,r,e[i+9],21,-343485551),r=b(r,o),n=b(n,c),a=b(a,u),s=b(s,l)}return Array(r,n,a,s)}function p(e,t,r,n,a,s){return b((t=b(b(t,e),b(n,s)))<<a|t>>>32-a,r)}function f(e,t,r,n,a,s,i){return p(t&r|~t&n,e,t,a,s,i)}function m(e,t,r,n,a,s,i){return p(t&n|r&~n,e,t,a,s,i)}function g(e,t,r,n,a,s,i){return p(t^r^n,e,t,a,s,i)}function y(e,t,r,n,a,s,i){return p(r^(t|~n),e,t,a,s,i)}function b(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}t.exports=function(e){return d.hash(e,h,16)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(e,t,r){(function(e,r,n,a,s,i,o,c,u){t.exports=function(e){for(var t,r=new Array(e),n=0;n<e;n++)0==(3&n)&&(t=4294967296*Math.random()),r[n]=t>>>((3&n)<<3)&255;return r}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(e,t,r){(function(r,n,a,s,i,o,c,u,l){var d=e("./helpers");function h(e,t){e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var r,n,a,s=Array(80),i=1732584193,o=-271733879,c=-1732584194,u=271733878,l=-1009589776,d=0;d<e.length;d+=16){for(var h=i,m=o,g=c,y=u,b=l,v=0;v<80;v++){s[v]=v<16?e[d+v]:f(s[v-3]^s[v-8]^s[v-14]^s[v-16],1);var _=p(p(f(i,5),(_=o,n=c,a=u,(r=v)<20?_&n|~_&a:!(r<40)&&r<60?_&n|_&a|n&a:_^n^a)),p(p(l,s[v]),(r=v)<20?1518500249:r<40?1859775393:r<60?-1894007588:-899497514));l=u,u=c,c=f(o,30),o=i,i=_}i=p(i,h),o=p(o,m),c=p(c,g),u=p(u,y),l=p(l,b)}return Array(i,o,c,u,l)}function p(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function f(e,t){return e<<t|e>>>32-t}t.exports=function(e){return d.hash(e,h,20,!0)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(e,t,r){(function(r,n,a,s,i,o,c,u,l){function d(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function h(e,t){var r,n=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),a=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),s=new Array(64);e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var i,o,c=0;c<e.length;c+=16){for(var u=a[0],l=a[1],h=a[2],p=a[3],g=a[4],y=a[5],b=a[6],v=a[7],_=0;_<64;_++)s[_]=_<16?e[_+c]:d(d(d((o=s[_-2],f(o,17)^f(o,19)^m(o,10)),s[_-7]),(o=s[_-15],f(o,7)^f(o,18)^m(o,3))),s[_-16]),r=d(d(d(d(v,f(o=g,6)^f(o,11)^f(o,25)),g&y^~g&b),n[_]),s[_]),i=d(f(i=u,2)^f(i,13)^f(i,22),u&l^u&h^l&h),v=b,b=y,y=g,g=d(p,r),p=h,h=l,l=u,u=d(r,i);a[0]=d(u,a[0]),a[1]=d(l,a[1]),a[2]=d(h,a[2]),a[3]=d(p,a[3]),a[4]=d(g,a[4]),a[5]=d(y,a[5]),a[6]=d(b,a[6]),a[7]=d(v,a[7])}return a}var p=e("./helpers"),f=function(e,t){return e>>>t|e<<32-t},m=function(e,t){return e>>>t};t.exports=function(e){return p.hash(e,h,32,!0)}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(e,t,r){(function(e,t,n,a,s,i,o,c,u){r.read=function(e,t,r,n,a){var s,i,o=8*a-n-1,c=(1<<o)-1,u=c>>1,l=-7,d=r?a-1:0,h=r?-1:1;for(a=e[t+d],d+=h,s=a&(1<<-l)-1,a>>=-l,l+=o;0<l;s=256*s+e[t+d],d+=h,l-=8);for(i=s&(1<<-l)-1,s>>=-l,l+=n;0<l;i=256*i+e[t+d],d+=h,l-=8);if(0===s)s=1-u;else{if(s===c)return i?NaN:1/0*(a?-1:1);i+=Math.pow(2,n),s-=u}return(a?-1:1)*i*Math.pow(2,s-n)},r.write=function(e,t,r,n,a,s){var i,o,c=8*s-a-1,u=(1<<c)-1,l=u>>1,d=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:s-1,p=n?1:-1;for(s=t<0||0===t&&1/t<0?1:0,t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,i=u):(i=Math.floor(Math.log(t)/Math.LN2),t*(n=Math.pow(2,-i))<1&&(i--,n*=2),2<=(t+=1<=i+l?d/n:d*Math.pow(2,1-l))*n&&(i++,n/=2),u<=i+l?(o=0,i=u):1<=i+l?(o=(t*n-1)*Math.pow(2,a),i+=l):(o=t*Math.pow(2,l-1)*Math.pow(2,a),i=0));8<=a;e[r+h]=255&o,h+=p,o/=256,a-=8);for(i=i<<a|o,c+=a;0<c;e[r+h]=255&i,h+=p,i/=256,c-=8);e[r+h-p]|=128*s}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(e,t,r){(function(e,r,n,a,s,i,o,c,u){var l,d,h;function p(){}(e=t.exports={}).nextTick=(d="undefined"!=typeof window&&window.setImmediate,h="undefined"!=typeof window&&window.postMessage&&window.addEventListener,d?function(e){return window.setImmediate(e)}:h?(l=[],window.addEventListener("message",(function(e){var t=e.source;t!==window&&null!==t||"process-tick"!==e.data||(e.stopPropagation(),0<l.length&&l.shift()())}),!0),function(e){l.push(e),window.postMessage("process-tick","*")}):function(e){setTimeout(e,0)}),e.title="browser",e.browser=!0,e.env={},e.argv=[],e.on=p,e.addListener=p,e.once=p,e.off=p,e.removeListener=p,e.removeAllListeners=p,e.emit=p,e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")}}).call(this,e("lYpoI2"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)},7345:e=>{"use strict";e.exports=(e,t)=>(t=t||(()=>{}),e.then((e=>new Promise((e=>{e(t())})).then((()=>e))),(e=>new Promise((e=>{e(t())})).then((()=>{throw e})))))},5860:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(6729),a=r(8147),s=r(6506),i=()=>{},o=new a.TimeoutError;t.default=class extends n{constructor(e){var t,r,n,a;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=i,this._resolveIdle=i,!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:s.default},e)).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(r=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==r?r:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(a=null===(n=e.interval)||void 0===n?void 0:n.toString())&&void 0!==a?a:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=!0===e.throwOnTimeout,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=i,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=i,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(void 0===this._intervalId){const t=this._intervalEnd-e;if(!(t<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout((()=>{this._onResumeInterval()}),t)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}_tryToStartAnother(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return!!t&&(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0)}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval((()=>{this._onInterval()}),this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise(((r,n)=>{this._queue.enqueue((async()=>{this._pendingCount++,this._intervalCount++;try{const s=void 0===this._timeout&&void 0===t.timeout?e():a.default(Promise.resolve(e()),void 0===t.timeout?this._timeout:t.timeout,(()=>{(void 0===t.throwOnTimeout?this._throwOnTimeout:t.throwOnTimeout)&&n(o)}));r(await s)}catch(e){n(e)}this._next()}),t),this._tryToStartAnother(),this.emit("add")}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(0!==this._queue.size)return new Promise((e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}}))}async onIdle(){if(0!==this._pendingCount||0!==this._queue.size)return new Promise((e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}}))}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}},7489:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){let n=0,a=e.length;for(;a>0;){const s=a/2|0;let i=n+s;r(e[i],t)<=0?(n=++i,a-=s+1):a=s}return n}},6506:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(7489);t.default=class{constructor(){this._queue=[]}enqueue(e,t){const r={priority:(t=Object.assign({priority:0},t)).priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority)return void this._queue.push(r);const a=n.default(this._queue,r,((e,t)=>t.priority-e.priority));this._queue.splice(a,0,r)}dequeue(){const e=this._queue.shift();return null==e?void 0:e.run}filter(e){return this._queue.filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return this._queue.length}}},2693:(e,t,r)=>{"use strict";const n=r(9353),a=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class s extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,({message:e}=e)):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const i=(e,t)=>new Promise(((r,i)=>{t={onFailedAttempt:()=>{},retries:10,...t};const o=n.operation(t);o.attempt((async n=>{try{r(await e(n))}catch(e){if(!(e instanceof Error))return void i(new TypeError(`Non-error was thrown: "${e}". You should only throw errors.`));if(e instanceof s)o.stop(),i(e.originalError);else if(e instanceof TypeError&&(c=e.message,!a.includes(c)))o.stop(),i(e);else{((e,t,r)=>{const n=r.retries-(t-1);e.attemptNumber=t,e.retriesLeft=n})(e,n,t);try{await t.onFailedAttempt(e)}catch(e){return void i(e)}o.retry(e)||i(o.mainError())}}var c}))}));e.exports=i,e.exports.default=i,e.exports.AbortError=s},8147:(e,t,r)=>{"use strict";const n=r(7345);class a extends Error{constructor(e){super(e),this.name="TimeoutError"}}const s=(e,t,r)=>new Promise(((s,i)=>{if("number"!=typeof t||t<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(t===1/0)return void s(e);const o=setTimeout((()=>{if("function"==typeof r){try{s(r())}catch(e){i(e)}return}const n=r instanceof Error?r:new a("string"==typeof r?r:`Promise timed out after ${t} milliseconds`);"function"==typeof e.cancel&&e.cancel(),i(n)}),t);n(e.then(s,i),(()=>{clearTimeout(o)}))}));e.exports=s,e.exports.default=s,e.exports.TimeoutError=a},9353:(e,t,r)=>{e.exports=r(1846)},1846:(e,t,r)=>{var n=r(1960);t.operation=function(e){var r=t.timeouts(e);return new n(r,{forever:e&&(e.forever||e.retries===1/0),unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},t.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var r in e)t[r]=e[r];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var n=[],a=0;a<t.retries;a++)n.push(this.createTimeout(a,t));return e&&e.forever&&!n.length&&n.push(this.createTimeout(a,t)),n.sort((function(e,t){return e-t})),n},t.createTimeout=function(e,t){var r=t.randomize?Math.random()+1:1,n=Math.round(r*Math.max(t.minTimeout,1)*Math.pow(t.factor,e));return Math.min(n,t.maxTimeout)},t.wrap=function(e,r,n){if(r instanceof Array&&(n=r,r=null),!n)for(var a in n=[],e)"function"==typeof e[a]&&n.push(a);for(var s=0;s<n.length;s++){var i=n[s],o=e[i];e[i]=function(n){var a=t.operation(r),s=Array.prototype.slice.call(arguments,1),i=s.pop();s.push((function(e){a.retry(e)||(e&&(arguments[0]=a.mainError()),i.apply(this,arguments))})),a.attempt((function(){n.apply(e,s)}))}.bind(e,o),e[i].options=r}}},1960:e=>{function t(e,t){"boolean"==typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}e.exports=t,t.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},t.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},t.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var r=this._timeouts.shift();if(void 0===r){if(!this._cachedTimeouts)return!1;this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1)}var n=this;return this._timer=setTimeout((function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout((function(){n._operationTimeoutCb(n._attempts)}),n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)}),r),this._options.unref&&this._timer.unref(),!0},t.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){r._operationTimeoutCb()}),r._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},t.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},t.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},t.prototype.start=t.prototype.try,t.prototype.errors=function(){return this._errors},t.prototype.attempts=function(){return this._attempts},t.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,r=0,n=0;n<this._errors.length;n++){var a=this._errors[n],s=a.message,i=(e[s]||0)+1;e[s]=i,i>=r&&(t=a,r=i)}return t}},8841:(e,t,r)=>{"use strict";t.Y_=void 0;const n=r(4357);Object.defineProperty(t,"Y_",{enumerable:!0,get:function(){return n.zodToJsonSchema}}),n.zodToJsonSchema},7181:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultOptions=t.defaultOptions=void 0,t.defaultOptions={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"string",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,emailStrategy:"format:email"},t.getDefaultOptions=e=>"string"==typeof e?Object.assign(Object.assign({},t.defaultOptions),{name:e}):Object.assign(Object.assign({},t.defaultOptions),e)},1908:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRefs=void 0;const n=r(7181);t.getRefs=e=>{const t=(0,n.getDefaultOptions)(e),r=void 0!==t.name?[...t.basePath,t.definitionPath,t.name]:t.basePath;return Object.assign(Object.assign({},t),{currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map((([e,r])=>[r._def,{def:r._def,path:[...t.basePath,t.definitionPath,e],jsonSchema:void 0}])))})}},6519:(e,t)=>{"use strict";function r(e,t,r,n){(null==n?void 0:n.errorMessages)&&r&&(e.errorMessage=Object.assign(Object.assign({},e.errorMessage),{[t]:r}))}Object.defineProperty(t,"__esModule",{value:!0}),t.setResponseValueAndErrors=t.addErrorMessage=void 0,t.addErrorMessage=r,t.setResponseValueAndErrors=function(e,t,n,a,s){e[t]=n,r(e,t,a,s)}},9959:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDef=void 0;const n=r(8754),a=r(6840),s=r(2886),i=r(2722),o=r(5823),c=r(423),u=r(9444),l=r(4117),d=r(3245),h=r(4804),p=r(2105),f=r(2734),m=r(8392),g=r(8716),y=r(2295),b=r(2200),v=r(5907),_=r(993),w=r(8490),O=r(938),x=r(8289),P=r(1250),A=r(9033),I=r(3564),T=r(9226),E=r(9229),k=r(3133),j=r(9646),S=r(8e3),C=r(34);function N(e,t,r=!1){const n=t.seen.get(e);if(n&&!r){const e=R(n,t);if(void 0!==e)return e}const a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);const s=L(e,e.typeName,t);return s&&Z(e,t,s),a.jsonSchema=s,s}t.parseDef=N;const R=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:0===e.path.length?"":1===e.path.length?`${e.path[0]}/`:e.path.join("/")};case"relative":return{$ref:M(t.currentPath,e.path)};case"none":return e.path.length<t.currentPath.length&&e.path.every(((e,r)=>t.currentPath[r]===e))?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):void 0;case"seen":return e.path.length<t.currentPath.length&&e.path.every(((e,r)=>t.currentPath[r]===e))?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):e.jsonSchema}},M=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")},L=(e,t,r)=>{switch(t){case n.ZodFirstPartyTypeKind.ZodString:return(0,E.parseStringDef)(e,r);case n.ZodFirstPartyTypeKind.ZodNumber:return(0,w.parseNumberDef)(e,r);case n.ZodFirstPartyTypeKind.ZodObject:return(0,O.parseObjectDef)(e,r);case n.ZodFirstPartyTypeKind.ZodBigInt:return(0,i.parseBigintDef)(e,r);case n.ZodFirstPartyTypeKind.ZodBoolean:return(0,o.parseBooleanDef)();case n.ZodFirstPartyTypeKind.ZodDate:return(0,l.parseDateDef)(e,r);case n.ZodFirstPartyTypeKind.ZodUndefined:return(0,j.parseUndefinedDef)();case n.ZodFirstPartyTypeKind.ZodNull:return(0,v.parseNullDef)(r);case n.ZodFirstPartyTypeKind.ZodArray:return(0,s.parseArrayDef)(e,r);case n.ZodFirstPartyTypeKind.ZodUnion:case n.ZodFirstPartyTypeKind.ZodDiscriminatedUnion:return(0,S.parseUnionDef)(e,r);case n.ZodFirstPartyTypeKind.ZodIntersection:return(0,f.parseIntersectionDef)(e,r);case n.ZodFirstPartyTypeKind.ZodTuple:return(0,k.parseTupleDef)(e,r);case n.ZodFirstPartyTypeKind.ZodRecord:return(0,I.parseRecordDef)(e,r);case n.ZodFirstPartyTypeKind.ZodLiteral:return(0,m.parseLiteralDef)(e,r);case n.ZodFirstPartyTypeKind.ZodEnum:return(0,p.parseEnumDef)(e);case n.ZodFirstPartyTypeKind.ZodNativeEnum:return(0,y.parseNativeEnumDef)(e);case n.ZodFirstPartyTypeKind.ZodNullable:return(0,_.parseNullableDef)(e,r);case n.ZodFirstPartyTypeKind.ZodOptional:return(0,x.parseOptionalDef)(e,r);case n.ZodFirstPartyTypeKind.ZodMap:return(0,g.parseMapDef)(e,r);case n.ZodFirstPartyTypeKind.ZodSet:return(0,T.parseSetDef)(e,r);case n.ZodFirstPartyTypeKind.ZodLazy:return N(e.getter()._def,r);case n.ZodFirstPartyTypeKind.ZodPromise:return(0,A.parsePromiseDef)(e,r);case n.ZodFirstPartyTypeKind.ZodNaN:case n.ZodFirstPartyTypeKind.ZodNever:return(0,b.parseNeverDef)();case n.ZodFirstPartyTypeKind.ZodEffects:return(0,h.parseEffectsDef)(e,r);case n.ZodFirstPartyTypeKind.ZodAny:return(0,a.parseAnyDef)();case n.ZodFirstPartyTypeKind.ZodUnknown:return(0,C.parseUnknownDef)();case n.ZodFirstPartyTypeKind.ZodDefault:return(0,d.parseDefaultDef)(e,r);case n.ZodFirstPartyTypeKind.ZodBranded:return(0,c.parseBrandedDef)(e,r);case n.ZodFirstPartyTypeKind.ZodCatch:return(0,u.parseCatchDef)(e,r);case n.ZodFirstPartyTypeKind.ZodPipeline:return(0,P.parsePipelineDef)(e,r);case n.ZodFirstPartyTypeKind.ZodFunction:case n.ZodFirstPartyTypeKind.ZodVoid:case n.ZodFirstPartyTypeKind.ZodSymbol:default:return}},Z=(e,t,r)=>(e.description&&(r.description=e.description,t.markdownDescription&&(r.markdownDescription=e.description)),r)},6840:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseAnyDef=void 0,t.parseAnyDef=function(){return{}}},2886:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseArrayDef=void 0;const n=r(8754),a=r(6519),s=r(9959);t.parseArrayDef=function(e,t){var r,i;const o={type:"array"};return(null===(i=null===(r=e.type)||void 0===r?void 0:r._def)||void 0===i?void 0:i.typeName)!==n.ZodFirstPartyTypeKind.ZodAny&&(o.items=(0,s.parseDef)(e.type._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items"]}))),e.minLength&&(0,a.setResponseValueAndErrors)(o,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&(0,a.setResponseValueAndErrors)(o,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&((0,a.setResponseValueAndErrors)(o,"minItems",e.exactLength.value,e.exactLength.message,t),(0,a.setResponseValueAndErrors)(o,"maxItems",e.exactLength.value,e.exactLength.message,t)),o}},2722:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBigintDef=void 0;const n=r(6519);t.parseBigintDef=function(e,t){const r={type:"integer",format:"int64"};if(!e.checks)return r;for(const a of e.checks)switch(a.kind){case"min":"jsonSchema7"===t.target?a.inclusive?(0,n.setResponseValueAndErrors)(r,"minimum",a.value,a.message,t):(0,n.setResponseValueAndErrors)(r,"exclusiveMinimum",a.value,a.message,t):(a.inclusive||(r.exclusiveMinimum=!0),(0,n.setResponseValueAndErrors)(r,"minimum",a.value,a.message,t));break;case"max":"jsonSchema7"===t.target?a.inclusive?(0,n.setResponseValueAndErrors)(r,"maximum",a.value,a.message,t):(0,n.setResponseValueAndErrors)(r,"exclusiveMaximum",a.value,a.message,t):(a.inclusive||(r.exclusiveMaximum=!0),(0,n.setResponseValueAndErrors)(r,"maximum",a.value,a.message,t));break;case"multipleOf":(0,n.setResponseValueAndErrors)(r,"multipleOf",a.value,a.message,t)}return r}},5823:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBooleanDef=void 0,t.parseBooleanDef=function(){return{type:"boolean"}}},423:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBrandedDef=void 0;const n=r(9959);t.parseBrandedDef=function(e,t){return(0,n.parseDef)(e.type._def,t)}},9444:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseCatchDef=void 0;const n=r(9959);t.parseCatchDef=(e,t)=>(0,n.parseDef)(e.innerType._def,t)},4117:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDateDef=void 0;const n=r(6519);t.parseDateDef=function(e,t){return"integer"==t.dateStrategy?a(e,t):{type:"string",format:"date-time"}};const a=(e,t)=>{const r={type:"integer",format:"unix-time"};for(const a of e.checks)switch(a.kind){case"min":"jsonSchema7"===t.target&&(0,n.setResponseValueAndErrors)(r,"minimum",a.value,a.message,t);break;case"max":"jsonSchema7"===t.target&&(0,n.setResponseValueAndErrors)(r,"maximum",a.value,a.message,t)}return r}},3245:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDefaultDef=void 0;const n=r(9959);t.parseDefaultDef=function(e,t){return Object.assign(Object.assign({},(0,n.parseDef)(e.innerType._def,t)),{default:e.defaultValue()})}},4804:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseEffectsDef=void 0;const n=r(9959);t.parseEffectsDef=function(e,t){return"input"===t.effectStrategy?(0,n.parseDef)(e.schema._def,t):{}}},2105:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseEnumDef=void 0,t.parseEnumDef=function(e){return{type:"string",enum:e.values}}},2734:function(e,t,r){"use strict";var n=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r};Object.defineProperty(t,"__esModule",{value:!0}),t.parseIntersectionDef=void 0;const a=r(9959);t.parseIntersectionDef=function(e,t){const r=[(0,a.parseDef)(e.left._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"allOf","0"]})),(0,a.parseDef)(e.right._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"allOf","1"]}))].filter((e=>!!e));let s="jsonSchema2019-09"===t.target?{unevaluatedProperties:!1}:void 0;const i=[];return r.forEach((e=>{if("type"in(t=e)&&"string"===t.type||!("allOf"in t)){let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){const{additionalProperties:r}=e;t=n(e,["additionalProperties"])}else s=void 0;i.push(t)}else i.push(...e.allOf),void 0===e.unevaluatedProperties&&(s=void 0);var t})),i.length?Object.assign({allOf:i},s):void 0}},8392:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLiteralDef=void 0,t.parseLiteralDef=function(e,t){const r=typeof e.value;return"bigint"!==r&&"number"!==r&&"boolean"!==r&&"string"!==r?{type:Array.isArray(e.value)?"array":"object"}:"openApi3"===t.target?{type:"bigint"===r?"integer":r,enum:[e.value]}:{type:"bigint"===r?"integer":r,const:e.value}}},8716:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseMapDef=void 0;const n=r(9959);t.parseMapDef=function(e,t){return{type:"array",maxItems:125,items:{type:"array",items:[(0,n.parseDef)(e.keyType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items","items","0"]}))||{},(0,n.parseDef)(e.valueType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items","items","1"]}))||{}],minItems:2,maxItems:2}}}},2295:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseNativeEnumDef=void 0,t.parseNativeEnumDef=function(e){const t=e.values,r=Object.keys(e.values).filter((e=>"number"!=typeof t[t[e]])).map((e=>t[e])),n=Array.from(new Set(r.map((e=>typeof e))));return{type:1===n.length?"string"===n[0]?"string":"number":["string","number"],enum:r}}},2200:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseNeverDef=void 0,t.parseNeverDef=function(){return{not:{}}}},5907:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseNullDef=void 0,t.parseNullDef=function(e){return"openApi3"===e.target?{enum:["null"],nullable:!0}:{type:"null"}}},993:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseNullableDef=void 0;const n=r(9959),a=r(8e3);t.parseNullableDef=function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return"openApi3"===t.target?{type:a.primitiveMappings[e.innerType._def.typeName],nullable:!0}:{type:[a.primitiveMappings[e.innerType._def.typeName],"null"]};if("openApi3"===t.target){const r=(0,n.parseDef)(e.innerType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath]}));return r&&Object.assign(Object.assign({},r),{nullable:!0})}const r=(0,n.parseDef)(e.innerType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"anyOf","0"]}));return r&&{anyOf:[r,{type:"null"}]}}},8490:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseNumberDef=void 0;const n=r(6519);t.parseNumberDef=function(e,t){const r={type:"number"};if(!e.checks)return r;for(const a of e.checks)switch(a.kind){case"int":r.type="integer",(0,n.addErrorMessage)(r,"type",a.message,t);break;case"min":"jsonSchema7"===t.target?a.inclusive?(0,n.setResponseValueAndErrors)(r,"minimum",a.value,a.message,t):(0,n.setResponseValueAndErrors)(r,"exclusiveMinimum",a.value,a.message,t):(a.inclusive||(r.exclusiveMinimum=!0),(0,n.setResponseValueAndErrors)(r,"minimum",a.value,a.message,t));break;case"max":"jsonSchema7"===t.target?a.inclusive?(0,n.setResponseValueAndErrors)(r,"maximum",a.value,a.message,t):(0,n.setResponseValueAndErrors)(r,"exclusiveMaximum",a.value,a.message,t):(a.inclusive||(r.exclusiveMaximum=!0),(0,n.setResponseValueAndErrors)(r,"maximum",a.value,a.message,t));break;case"multipleOf":(0,n.setResponseValueAndErrors)(r,"multipleOf",a.value,a.message,t)}return r}},938:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseObjectDef=t.parseObjectDefX=void 0;const n=r(9959);t.parseObjectDefX=function(e,t){var r,a;Object.keys(e.shape()).reduce(((r,a)=>{let s=e.shape()[a];const i=s.isOptional();i||(s=Object.assign({},s._def.innerSchema));const o=(0,n.parseDef)(s._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"properties",a],propertyPath:[...t.currentPath,"properties",a]}));return void 0!==o&&(r.properties[a]=o,i||(r.required||(r.required=[]),r.required.push(a))),r}),{type:"object",properties:{},additionalProperties:"ZodNever"===e.catchall._def.typeName?"passthrough"===e.unknownKeys:null===(r=(0,n.parseDef)(e.catchall._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"additionalProperties"]})))||void 0===r||r});const s=Object.assign(Object.assign({type:"object"},Object.entries(e.shape()).reduce(((e,[r,a])=>{if(void 0===a||void 0===a._def)return e;const s=(0,n.parseDef)(a._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"properties",r],propertyPath:[...t.currentPath,"properties",r]}));return void 0===s?e:{properties:Object.assign(Object.assign({},e.properties),{[r]:s}),required:a.isOptional()?e.required:[...e.required,r]}}),{properties:{},required:[]})),{additionalProperties:"ZodNever"===e.catchall._def.typeName?"passthrough"===e.unknownKeys:null===(a=(0,n.parseDef)(e.catchall._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"additionalProperties"]})))||void 0===a||a});return s.required.length||delete s.required,s},t.parseObjectDef=function(e,t){var r;const a=Object.assign(Object.assign({type:"object"},Object.entries(e.shape()).reduce(((e,[r,a])=>{if(void 0===a||void 0===a._def)return e;const s=(0,n.parseDef)(a._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"properties",r],propertyPath:[...t.currentPath,"properties",r]}));return void 0===s?e:{properties:Object.assign(Object.assign({},e.properties),{[r]:s}),required:a.isOptional()?e.required:[...e.required,r]}}),{properties:{},required:[]})),{additionalProperties:"ZodNever"===e.catchall._def.typeName?"passthrough"===e.unknownKeys:null===(r=(0,n.parseDef)(e.catchall._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"additionalProperties"]})))||void 0===r||r});return a.required.length||delete a.required,a}},8289:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseOptionalDef=void 0;const n=r(9959);t.parseOptionalDef=(e,t)=>{var r;if(t.currentPath.toString()===(null===(r=t.propertyPath)||void 0===r?void 0:r.toString()))return(0,n.parseDef)(e.innerType._def,t);const a=(0,n.parseDef)(e.innerType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"anyOf","1"]}));return a?{anyOf:[{not:{}},a]}:{}}},1250:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parsePipelineDef=void 0;const n=r(9959);t.parsePipelineDef=(e,t)=>{if("input"===t.pipeStrategy)return(0,n.parseDef)(e.in._def,t);const r=(0,n.parseDef)(e.in._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"allOf","0"]}));return{allOf:[r,(0,n.parseDef)(e.out._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"allOf",r?"1":"0"]}))].filter((e=>void 0!==e))}}},9033:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parsePromiseDef=void 0;const n=r(9959);t.parsePromiseDef=function(e,t){return(0,n.parseDef)(e.type._def,t)}},3564:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseRecordDef=void 0;const n=r(8754),a=r(9959),s=r(9229);t.parseRecordDef=function(e,t){var r,i,o,c,u;if("openApi3"===t.target&&(null===(r=e.keyType)||void 0===r?void 0:r._def.typeName)===n.ZodFirstPartyTypeKind.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce(((r,n)=>{var s;return Object.assign(Object.assign({},r),{[n]:null!==(s=(0,a.parseDef)(e.valueType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"properties",n]})))&&void 0!==s?s:{}})}),{}),additionalProperties:!1};const l={type:"object",additionalProperties:null!==(i=(0,a.parseDef)(e.valueType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"additionalProperties"]})))&&void 0!==i?i:{}};if("openApi3"===t.target)return l;if((null===(o=e.keyType)||void 0===o?void 0:o._def.typeName)===n.ZodFirstPartyTypeKind.ZodString&&(null===(c=e.keyType._def.checks)||void 0===c?void 0:c.length)){const r=Object.entries((0,s.parseStringDef)(e.keyType._def,t)).reduce(((e,[t,r])=>"type"===t?e:Object.assign(Object.assign({},e),{[t]:r})),{});return Object.assign(Object.assign({},l),{propertyNames:r})}return(null===(u=e.keyType)||void 0===u?void 0:u._def.typeName)===n.ZodFirstPartyTypeKind.ZodEnum?Object.assign(Object.assign({},l),{propertyNames:{enum:e.keyType._def.values}}):l}},9226:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSetDef=void 0;const n=r(6519),a=r(9959);t.parseSetDef=function(e,t){const r={type:"array",uniqueItems:!0,items:(0,a.parseDef)(e.valueType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items"]}))};return e.minSize&&(0,n.setResponseValueAndErrors)(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&(0,n.setResponseValueAndErrors)(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}},9229:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseStringDef=t.emojiPattern=t.ulidPattern=t.cuid2Pattern=t.cuidPattern=t.emailPattern=void 0;const n=r(6519);t.emailPattern='^(([^<>()[\\]\\\\.,;:\\s@\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\"]+)*)|(\\".+\\"))@((\\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\])|(\\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\\.[A-Za-z]{2,})+))$',t.cuidPattern="^c[^\\s-]{8,}$",t.cuid2Pattern="^[a-z][a-z0-9]*$",t.ulidPattern="/[0-9A-HJKMNP-TV-Z]{26}/",t.emojiPattern="/^(p{Extended_Pictographic}|p{Emoji_Component})+$/u",t.parseStringDef=function(e,r){const o={type:"string"};if(e.checks)for(const c of e.checks)switch(c.kind){case"min":(0,n.setResponseValueAndErrors)(o,"minLength","number"==typeof o.minLength?Math.max(o.minLength,c.value):c.value,c.message,r);break;case"max":(0,n.setResponseValueAndErrors)(o,"maxLength","number"==typeof o.maxLength?Math.min(o.maxLength,c.value):c.value,c.message,r);break;case"email":switch(r.emailStrategy){case"format:email":s(o,"email",c.message,r);break;case"format:idn-email":s(o,"idn-email",c.message,r);break;case"pattern:zod":i(o,t.emailPattern,c.message,r)}break;case"url":s(o,"uri",c.message,r);break;case"uuid":s(o,"uuid",c.message,r);break;case"regex":i(o,c.regex.source,c.message,r);break;case"cuid":i(o,t.cuidPattern,c.message,r);break;case"cuid2":i(o,t.cuid2Pattern,c.message,r);break;case"startsWith":i(o,"^"+a(c.value),c.message,r);break;case"endsWith":i(o,a(c.value)+"$",c.message,r);break;case"datetime":s(o,"date-time",c.message,r);break;case"length":(0,n.setResponseValueAndErrors)(o,"minLength","number"==typeof o.minLength?Math.max(o.minLength,c.value):c.value,c.message,r),(0,n.setResponseValueAndErrors)(o,"maxLength","number"==typeof o.maxLength?Math.min(o.maxLength,c.value):c.value,c.message,r);break;case"includes":i(o,a(c.value),c.message,r);break;case"ip":"v6"!==c.version&&s(o,"ipv4",c.message,r),"v4"!==c.version&&s(o,"ipv6",c.message,r);break;case"emoji":i(o,t.emojiPattern,c.message,r);break;case"ulid":i(o,t.ulidPattern,c.message,r)}return o};const a=e=>Array.from(e).map((e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`)).join(""),s=(e,t,r,a)=>{var s;e.format||(null===(s=e.anyOf)||void 0===s?void 0:s.some((e=>e.format)))?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push(Object.assign({format:e.format},e.errorMessage&&a.errorMessages&&{errorMessage:{format:e.errorMessage.format}})),delete e.format,e.errorMessage&&(delete e.errorMessage.format,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.anyOf.push(Object.assign({format:t},r&&a.errorMessages&&{errorMessage:{format:r}}))):(0,n.setResponseValueAndErrors)(e,"format",t,r,a)},i=(e,t,r,a)=>{var s;e.pattern||(null===(s=e.allOf)||void 0===s?void 0:s.some((e=>e.pattern)))?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push(Object.assign({pattern:e.pattern},e.errorMessage&&a.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}})),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,0===Object.keys(e.errorMessage).length&&delete e.errorMessage)),e.allOf.push(Object.assign({pattern:t},r&&a.errorMessages&&{errorMessage:{pattern:r}}))):(0,n.setResponseValueAndErrors)(e,"pattern",t,r,a)}},3133:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseTupleDef=void 0;const n=r(9959);t.parseTupleDef=function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map(((e,r)=>(0,n.parseDef)(e._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items",`${r}`]})))).reduce(((e,t)=>void 0===t?e:[...e,t]),[]),additionalItems:(0,n.parseDef)(e.rest._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"additionalItems"]}))}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map(((e,r)=>(0,n.parseDef)(e._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items",`${r}`]})))).reduce(((e,t)=>void 0===t?e:[...e,t]),[])}}},9646:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseUndefinedDef=void 0,t.parseUndefinedDef=function(){return{not:{}}}},8e3:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseUnionDef=t.primitiveMappings=void 0;const n=r(9959);t.primitiveMappings={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},t.parseUnionDef=function(e,r){if("openApi3"===r.target)return a(e,r);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every((e=>e._def.typeName in t.primitiveMappings&&(!e._def.checks||!e._def.checks.length)))){const e=n.reduce(((e,r)=>{const n=t.primitiveMappings[r._def.typeName];return n&&!e.includes(n)?[...e,n]:e}),[]);return{type:e.length>1?e:e[0]}}if(n.every((e=>"ZodLiteral"===e._def.typeName&&!e.description))){const e=n.reduce(((e,t)=>{const r=typeof t._def.value;switch(r){case"string":case"number":case"boolean":return[...e,r];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}}),[]);if(e.length===n.length){const t=e.filter(((e,t,r)=>r.indexOf(e)===t));return{type:t.length>1?t:t[0],enum:n.reduce(((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value]),[])}}}else if(n.every((e=>"ZodEnum"===e._def.typeName)))return{type:"string",enum:n.reduce(((e,t)=>[...e,...t._def.values.filter((t=>!e.includes(t)))]),[])};return a(e,r)};const a=(e,t)=>{const r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map(((e,r)=>(0,n.parseDef)(e._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"anyOf",`${r}`]})))).filter((e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0)));return r.length?{anyOf:r}:void 0}},34:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseUnknownDef=void 0,t.parseUnknownDef=function(){return{}}},4357:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zodToJsonSchema=void 0;const n=r(9959),a=r(1908);t.zodToJsonSchema=(e,t)=>{var r;const s=(0,a.getRefs)(t),i="object"==typeof t&&t.definitions?Object.entries(t.definitions).reduce(((e,[t,r])=>{var a;return Object.assign(Object.assign({},e),{[t]:null!==(a=(0,n.parseDef)(r._def,Object.assign(Object.assign({},s),{currentPath:[...s.basePath,s.definitionPath,t]}),!0))&&void 0!==a?a:{}})}),{}):void 0,o="string"==typeof t?t:null==t?void 0:t.name,c=null!==(r=(0,n.parseDef)(e._def,void 0===o?s:Object.assign(Object.assign({},s),{currentPath:[...s.basePath,s.definitionPath,o]}),!1))&&void 0!==r?r:{},u=void 0===o?i?Object.assign(Object.assign({},c),{[s.definitionPath]:i}):c:{$ref:[..."relative"===s.$refStrategy?[]:s.basePath,s.definitionPath,o].join("/"),[s.definitionPath]:Object.assign(Object.assign({},i),{[o]:c})};return"jsonSchema7"===s.target?u.$schema="http://json-schema.org/draft-07/schema#":"jsonSchema2019-09"===s.target&&(u.$schema="https://json-schema.org/draft/2019-09/schema#"),u}},8280:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZodError=t.quotelessJson=t.ZodIssueCode=void 0;const n=r(9110);t.ZodIssueCode=n.util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),t.quotelessJson=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class a extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(e){return e.message},r={_errors:[]},n=e=>{for(const a of e.issues)if("invalid_union"===a.code)a.unionErrors.map(n);else if("invalid_return_type"===a.code)n(a.returnTypeError);else if("invalid_arguments"===a.code)n(a.argumentsError);else if(0===a.path.length)r._errors.push(t(a));else{let e=r,n=0;for(;n<a.path.length;){const r=a.path[n];n===a.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(a))):e[r]=e[r]||{_errors:[]},e=e[r],n++}}};return n(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,n.util.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=(e=>e.message)){const t={},r=[];for(const n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):r.push(e(n));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}t.ZodError=a,a.create=e=>new a(e)},6996:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getErrorMap=t.setErrorMap=t.defaultErrorMap=void 0;const a=n(r(9349));t.defaultErrorMap=a.default;let s=a.default;t.setErrorMap=function(e){s=e},t.getErrorMap=function(){return s}},6349:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(6996),t),a(r(3187),t),a(r(116),t),a(r(9110),t),a(r(5433),t),a(r(8280),t)},8762:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.errorUtil=void 0,(r=t.errorUtil||(t.errorUtil={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},r.toString=e=>"string"==typeof e?e:null==e?void 0:e.message},3187:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.isAsync=t.isValid=t.isDirty=t.isAborted=t.OK=t.DIRTY=t.INVALID=t.ParseStatus=t.addIssueToContext=t.EMPTY_PATH=t.makeIssue=void 0;const a=r(6996),s=n(r(9349));t.makeIssue=e=>{const{data:t,path:r,errorMaps:n,issueData:a}=e,s=[...r,...a.path||[]],i={...a,path:s};let o="";const c=n.filter((e=>!!e)).slice().reverse();for(const e of c)o=e(i,{data:t,defaultError:o}).message;return{...a,path:s,message:a.message||o}},t.EMPTY_PATH=[],t.addIssueToContext=function(e,r){const n=(0,t.makeIssue)({issueData:r,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,(0,a.getErrorMap)(),s.default].filter((e=>!!e))});e.common.issues.push(n)};class i{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,r){const n=[];for(const a of r){if("aborted"===a.status)return t.INVALID;"dirty"===a.status&&e.dirty(),n.push(a.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const r=[];for(const e of t)r.push({key:await e.key,value:await e.value});return i.mergeObjectSync(e,r)}static mergeObjectSync(e,r){const n={};for(const a of r){const{key:r,value:s}=a;if("aborted"===r.status)return t.INVALID;if("aborted"===s.status)return t.INVALID;"dirty"===r.status&&e.dirty(),"dirty"===s.status&&e.dirty(),"__proto__"===r.value||void 0===s.value&&!a.alwaysSet||(n[r.value]=s.value)}return{status:e.value,value:n}}}t.ParseStatus=i,t.INVALID=Object.freeze({status:"aborted"}),t.DIRTY=e=>({status:"dirty",value:e}),t.OK=e=>({status:"valid",value:e}),t.isAborted=e=>"aborted"===e.status,t.isDirty=e=>"dirty"===e.status,t.isValid=e=>"valid"===e.status,t.isAsync=e=>"undefined"!=typeof Promise&&e instanceof Promise},116:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},9110:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.getParsedType=t.ZodParsedType=t.objectUtil=t.util=void 0,function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const r of e)t[r]=r;return t},e.getValidEnumValues=t=>{const r=e.objectKeys(t).filter((e=>"number"!=typeof t[t[e]])),n={};for(const e of r)n[e]=t[e];return e.objectValues(n)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(const r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`'${e}'`:e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(r=t.util||(t.util={})),(t.objectUtil||(t.objectUtil={})).mergeShapes=(e,t)=>({...e,...t}),t.ZodParsedType=r.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),t.getParsedType=e=>{switch(typeof e){case"undefined":return t.ZodParsedType.undefined;case"string":return t.ZodParsedType.string;case"number":return isNaN(e)?t.ZodParsedType.nan:t.ZodParsedType.number;case"boolean":return t.ZodParsedType.boolean;case"function":return t.ZodParsedType.function;case"bigint":return t.ZodParsedType.bigint;case"symbol":return t.ZodParsedType.symbol;case"object":return Array.isArray(e)?t.ZodParsedType.array:null===e?t.ZodParsedType.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?t.ZodParsedType.promise:"undefined"!=typeof Map&&e instanceof Map?t.ZodParsedType.map:"undefined"!=typeof Set&&e instanceof Set?t.ZodParsedType.set:"undefined"!=typeof Date&&e instanceof Date?t.ZodParsedType.date:t.ZodParsedType.object;default:return t.ZodParsedType.unknown}}},8754:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.z=void 0;const o=s(r(6349));t.z=o,i(r(6349),t),t.default=o},9349:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(9110),a=r(8280);t.default=(e,t)=>{let r;switch(e.code){case a.ZodIssueCode.invalid_type:r=e.received===n.ZodParsedType.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case a.ZodIssueCode.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,n.util.jsonStringifyReplacer)}`;break;case a.ZodIssueCode.unrecognized_keys:r=`Unrecognized key(s) in object: ${n.util.joinValues(e.keys,", ")}`;break;case a.ZodIssueCode.invalid_union:r="Invalid input";break;case a.ZodIssueCode.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${n.util.joinValues(e.options)}`;break;case a.ZodIssueCode.invalid_enum_value:r=`Invalid enum value. Expected ${n.util.joinValues(e.options)}, received '${e.received}'`;break;case a.ZodIssueCode.invalid_arguments:r="Invalid function arguments";break;case a.ZodIssueCode.invalid_return_type:r="Invalid function return type";break;case a.ZodIssueCode.invalid_date:r="Invalid date";break;case a.ZodIssueCode.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:n.util.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case a.ZodIssueCode.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case a.ZodIssueCode.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case a.ZodIssueCode.custom:r="Invalid input";break;case a.ZodIssueCode.invalid_intersection_types:r="Intersection results could not be merged";break;case a.ZodIssueCode.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case a.ZodIssueCode.not_finite:r="Number must be finite";break;default:r=t.defaultError,n.util.assertNever(e)}return{message:r}}},5433:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.date=t.boolean=t.bigint=t.array=t.any=t.coerce=t.ZodFirstPartyTypeKind=t.late=t.ZodSchema=t.Schema=t.custom=t.ZodReadonly=t.ZodPipeline=t.ZodBranded=t.BRAND=t.ZodNaN=t.ZodCatch=t.ZodDefault=t.ZodNullable=t.ZodOptional=t.ZodTransformer=t.ZodEffects=t.ZodPromise=t.ZodNativeEnum=t.ZodEnum=t.ZodLiteral=t.ZodLazy=t.ZodFunction=t.ZodSet=t.ZodMap=t.ZodRecord=t.ZodTuple=t.ZodIntersection=t.ZodDiscriminatedUnion=t.ZodUnion=t.ZodObject=t.ZodArray=t.ZodVoid=t.ZodNever=t.ZodUnknown=t.ZodAny=t.ZodNull=t.ZodUndefined=t.ZodSymbol=t.ZodDate=t.ZodBoolean=t.ZodBigInt=t.ZodNumber=t.ZodString=t.ZodType=void 0,t.NEVER=t.void=t.unknown=t.union=t.undefined=t.tuple=t.transformer=t.symbol=t.string=t.strictObject=t.set=t.record=t.promise=t.preprocess=t.pipeline=t.ostring=t.optional=t.onumber=t.oboolean=t.object=t.number=t.nullable=t.null=t.never=t.nativeEnum=t.nan=t.map=t.literal=t.lazy=t.intersection=t.instanceof=t.function=t.enum=t.effect=t.discriminatedUnion=void 0;const n=r(6996),a=r(8762),s=r(3187),i=r(9110),o=r(8280);class c{constructor(e,t,r,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const u=(e,t)=>{if((0,s.isValid)(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new o.ZodError(e.common.issues);return this._error=t,this._error}}};function l(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:a}=e;if(t&&(r||n))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:a}:{errorMap:(e,t)=>"invalid_type"!==e.code?{message:t.defaultError}:void 0===t.data?{message:null!=n?n:t.defaultError}:{message:null!=r?r:t.defaultError},description:a}}class d{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return(0,i.getParsedType)(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:(0,i.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new s.ParseStatus,ctx:{common:e.parent.common,data:e.data,parsedType:(0,i.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if((0,s.isAsync)(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const n={common:{issues:[],async:null!==(r=null==t?void 0:t.async)&&void 0!==r&&r,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,i.getParsedType)(e)},a=this._parseSync({data:e,path:n.path,parent:n});return u(n,a)}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,i.getParsedType)(e)},n=this._parse({data:e,path:r.path,parent:r}),a=await((0,s.isAsync)(n)?n:Promise.resolve(n));return u(r,a)}refine(e,t){const r=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,n)=>{const a=e(t),s=()=>n.addIssue({code:o.ZodIssueCode.custom,...r(t)});return"undefined"!=typeof Promise&&a instanceof Promise?a.then((e=>!!e||(s(),!1))):!!a||(s(),!1)}))}refinement(e,t){return this._refinement(((r,n)=>!!e(r)||(n.addIssue("function"==typeof t?t(r,n):t),!1)))}_refinement(e){return new X({schema:this,typeName:oe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Q.create(this,this._def)}nullable(){return ee.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return N.create(this,this._def)}promise(){return G.create(this,this._def)}or(e){return L.create([this,e],this._def)}and(e){return z.create(this,e,this._def)}transform(e){return new X({...l(this._def),schema:this,typeName:oe.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new te({...l(this._def),innerType:this,defaultValue:t,typeName:oe.ZodDefault})}brand(){return new ae({typeName:oe.ZodBranded,type:this,...l(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new re({...l(this._def),innerType:this,catchValue:t,typeName:oe.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return se.create(this,e)}readonly(){return ie.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}t.ZodType=d,t.Schema=d,t.ZodSchema=d;const h=/^c[^\s-]{8,}$/i,p=/^[a-z][a-z0-9]*$/,f=/[0-9A-HJKMNP-TV-Z]{26}/,m=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,g=/^([A-Z0-9_+-]+\.?)*[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,y=/^(\p{Extended_Pictographic}|\p{Emoji_Component})+$/u,b=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,v=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/;class _ extends d{constructor(){super(...arguments),this._regex=(e,t,r)=>this.refinement((t=>e.test(t)),{validation:t,code:o.ZodIssueCode.invalid_string,...a.errorUtil.errToObj(r)}),this.nonempty=e=>this.min(1,a.errorUtil.errToObj(e)),this.trim=()=>new _({...this._def,checks:[...this._def.checks,{kind:"trim"}]}),this.toLowerCase=()=>new _({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]}),this.toUpperCase=()=>new _({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==i.ZodParsedType.string){const t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.string,received:t.parsedType}),s.INVALID}const t=new s.ParseStatus;let r;for(const u of this._def.checks)if("min"===u.kind)e.data.length<u.value&&(r=this._getOrReturnCtx(e,r),(0,s.addIssueToContext)(r,{code:o.ZodIssueCode.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),t.dirty());else if("max"===u.kind)e.data.length>u.value&&(r=this._getOrReturnCtx(e,r),(0,s.addIssueToContext)(r,{code:o.ZodIssueCode.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),t.dirty());else if("length"===u.kind){const n=e.data.length>u.value,a=e.data.length<u.value;(n||a)&&(r=this._getOrReturnCtx(e,r),n?(0,s.addIssueToContext)(r,{code:o.ZodIssueCode.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}):a&&(0,s.addIssueToContext)(r,{code:o.ZodIssueCode.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}),t.dirty())}else if("email"===u.kind)g.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,s.addIssueToContext)(r,{validation:"email",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty());else if("emoji"===u.kind)y.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,s.addIssueToContext)(r,{validation:"emoji",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty());else if("uuid"===u.kind)m.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,s.addIssueToContext)(r,{validation:"uuid",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty());else if("cuid"===u.kind)h.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,s.addIssueToContext)(r,{validation:"cuid",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty());else if("cuid2"===u.kind)p.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,s.addIssueToContext)(r,{validation:"cuid2",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty());else if("ulid"===u.kind)f.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,s.addIssueToContext)(r,{validation:"ulid",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty());else if("url"===u.kind)try{new URL(e.data)}catch(n){r=this._getOrReturnCtx(e,r),(0,s.addIssueToContext)(r,{validation:"url",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty()}else"regex"===u.kind?(u.regex.lastIndex=0,u.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),(0,s.addIssueToContext)(r,{validation:"regex",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty())):"trim"===u.kind?e.data=e.data.trim():"includes"===u.kind?e.data.includes(u.value,u.position)||(r=this._getOrReturnCtx(e,r),(0,s.addIssueToContext)(r,{code:o.ZodIssueCode.invalid_string,validation:{includes:u.value,position:u.position},message:u.message}),t.dirty()):"toLowerCase"===u.kind?e.data=e.data.toLowerCase():"toUpperCase"===u.kind?e.data=e.data.toUpperCase():"startsWith"===u.kind?e.data.startsWith(u.value)||(r=this._getOrReturnCtx(e,r),(0,s.addIssueToContext)(r,{code:o.ZodIssueCode.invalid_string,validation:{startsWith:u.value},message:u.message}),t.dirty()):"endsWith"===u.kind?e.data.endsWith(u.value)||(r=this._getOrReturnCtx(e,r),(0,s.addIssueToContext)(r,{code:o.ZodIssueCode.invalid_string,validation:{endsWith:u.value},message:u.message}),t.dirty()):"datetime"===u.kind?((c=u).precision?c.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${c.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${c.precision}}Z$`):0===c.precision?c.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):c.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$")).test(e.data)||(r=this._getOrReturnCtx(e,r),(0,s.addIssueToContext)(r,{code:o.ZodIssueCode.invalid_string,validation:"datetime",message:u.message}),t.dirty()):"ip"===u.kind?(n=e.data,("v4"!==(a=u.version)&&a||!b.test(n))&&("v6"!==a&&a||!v.test(n))&&(r=this._getOrReturnCtx(e,r),(0,s.addIssueToContext)(r,{validation:"ip",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty())):i.util.assertNever(u);var n,a,c;return{status:t.value,value:e.data}}_addCheck(e){return new _({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...a.errorUtil.errToObj(e)})}url(e){return this._addCheck({kind:"url",...a.errorUtil.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...a.errorUtil.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...a.errorUtil.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...a.errorUtil.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...a.errorUtil.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...a.errorUtil.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...a.errorUtil.errToObj(e)})}datetime(e){var t;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,...a.errorUtil.errToObj(null==e?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...a.errorUtil.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...a.errorUtil.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...a.errorUtil.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...a.errorUtil.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...a.errorUtil.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...a.errorUtil.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...a.errorUtil.errToObj(t)})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function w(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,a=r>n?r:n;return parseInt(e.toFixed(a).replace(".",""))%parseInt(t.toFixed(a).replace(".",""))/Math.pow(10,a)}t.ZodString=_,_.create=e=>{var t;return new _({checks:[],typeName:oe.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...l(e)})};class O extends d{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==i.ZodParsedType.number){const t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.number,received:t.parsedType}),s.INVALID}let t;const r=new s.ParseStatus;for(const n of this._def.checks)"int"===n.kind?i.util.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty()):"min"===n.kind?(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):"max"===n.kind?(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):"multipleOf"===n.kind?0!==w(e.data,n.value)&&(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):"finite"===n.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.not_finite,message:n.message}),r.dirty()):i.util.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,a.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,a.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,a.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,a.errorUtil.toString(t))}setLimit(e,t,r,n){return new O({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:a.errorUtil.toString(n)}]})}_addCheck(e){return new O({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:a.errorUtil.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:a.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:a.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:a.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:a.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:a.errorUtil.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:a.errorUtil.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:a.errorUtil.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:a.errorUtil.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&i.util.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}t.ZodNumber=O,O.create=e=>new O({checks:[],typeName:oe.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...l(e)});class x extends d{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==i.ZodParsedType.bigint){const t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.bigint,received:t.parsedType}),s.INVALID}let t;const r=new s.ParseStatus;for(const n of this._def.checks)"min"===n.kind?(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"max"===n.kind?(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"multipleOf"===n.kind?e.data%n.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):i.util.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,a.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,a.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,a.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,a.errorUtil.toString(t))}setLimit(e,t,r,n){return new x({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:a.errorUtil.toString(n)}]})}_addCheck(e){return new x({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:a.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:a.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:a.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:a.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:a.errorUtil.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}t.ZodBigInt=x,x.create=e=>{var t;return new x({checks:[],typeName:oe.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...l(e)})};class P extends d{_parse(e){if(this._def.coerce&&(e.data=Boolean(e.data)),this._getType(e)!==i.ZodParsedType.boolean){const t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.boolean,received:t.parsedType}),s.INVALID}return(0,s.OK)(e.data)}}t.ZodBoolean=P,P.create=e=>new P({typeName:oe.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...l(e)});class A extends d{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==i.ZodParsedType.date){const t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.date,received:t.parsedType}),s.INVALID}if(isNaN(e.data.getTime())){const t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_date}),s.INVALID}const t=new s.ParseStatus;let r;for(const n of this._def.checks)"min"===n.kind?e.data.getTime()<n.value&&(r=this._getOrReturnCtx(e,r),(0,s.addIssueToContext)(r,{code:o.ZodIssueCode.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),t.dirty()):"max"===n.kind?e.data.getTime()>n.value&&(r=this._getOrReturnCtx(e,r),(0,s.addIssueToContext)(r,{code:o.ZodIssueCode.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),t.dirty()):i.util.assertNever(n);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new A({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:a.errorUtil.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:a.errorUtil.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}t.ZodDate=A,A.create=e=>new A({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:oe.ZodDate,...l(e)});class I extends d{_parse(e){if(this._getType(e)!==i.ZodParsedType.symbol){const t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.symbol,received:t.parsedType}),s.INVALID}return(0,s.OK)(e.data)}}t.ZodSymbol=I,I.create=e=>new I({typeName:oe.ZodSymbol,...l(e)});class T extends d{_parse(e){if(this._getType(e)!==i.ZodParsedType.undefined){const t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.undefined,received:t.parsedType}),s.INVALID}return(0,s.OK)(e.data)}}t.ZodUndefined=T,T.create=e=>new T({typeName:oe.ZodUndefined,...l(e)});class E extends d{_parse(e){if(this._getType(e)!==i.ZodParsedType.null){const t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.null,received:t.parsedType}),s.INVALID}return(0,s.OK)(e.data)}}t.ZodNull=E,E.create=e=>new E({typeName:oe.ZodNull,...l(e)});class k extends d{constructor(){super(...arguments),this._any=!0}_parse(e){return(0,s.OK)(e.data)}}t.ZodAny=k,k.create=e=>new k({typeName:oe.ZodAny,...l(e)});class j extends d{constructor(){super(...arguments),this._unknown=!0}_parse(e){return(0,s.OK)(e.data)}}t.ZodUnknown=j,j.create=e=>new j({typeName:oe.ZodUnknown,...l(e)});class S extends d{_parse(e){const t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.never,received:t.parsedType}),s.INVALID}}t.ZodNever=S,S.create=e=>new S({typeName:oe.ZodNever,...l(e)});class C extends d{_parse(e){if(this._getType(e)!==i.ZodParsedType.undefined){const t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.void,received:t.parsedType}),s.INVALID}return(0,s.OK)(e.data)}}t.ZodVoid=C,C.create=e=>new C({typeName:oe.ZodVoid,...l(e)});class N extends d{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),n=this._def;if(t.parsedType!==i.ZodParsedType.array)return(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.array,received:t.parsedType}),s.INVALID;if(null!==n.exactLength){const e=t.data.length>n.exactLength.value,a=t.data.length<n.exactLength.value;(e||a)&&((0,s.addIssueToContext)(t,{code:e?o.ZodIssueCode.too_big:o.ZodIssueCode.too_small,minimum:a?n.exactLength.value:void 0,maximum:e?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(null!==n.minLength&&t.data.length<n.minLength.value&&((0,s.addIssueToContext)(t,{code:o.ZodIssueCode.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),null!==n.maxLength&&t.data.length>n.maxLength.value&&((0,s.addIssueToContext)(t,{code:o.ZodIssueCode.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map(((e,r)=>n.type._parseAsync(new c(t,e,t.path,r))))).then((e=>s.ParseStatus.mergeArray(r,e)));const a=[...t.data].map(((e,r)=>n.type._parseSync(new c(t,e,t.path,r))));return s.ParseStatus.mergeArray(r,a)}get element(){return this._def.type}min(e,t){return new N({...this._def,minLength:{value:e,message:a.errorUtil.toString(t)}})}max(e,t){return new N({...this._def,maxLength:{value:e,message:a.errorUtil.toString(t)}})}length(e,t){return new N({...this._def,exactLength:{value:e,message:a.errorUtil.toString(t)}})}nonempty(e){return this.min(1,e)}}function R(e){if(e instanceof M){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=Q.create(R(n))}return new M({...e._def,shape:()=>t})}return e instanceof N?new N({...e._def,type:R(e.element)}):e instanceof Q?Q.create(R(e.unwrap())):e instanceof ee?ee.create(R(e.unwrap())):e instanceof $?$.create(e.items.map((e=>R(e)))):e}t.ZodArray=N,N.create=(e,t)=>new N({type:e,minLength:null,maxLength:null,exactLength:null,typeName:oe.ZodArray,...l(t)});class M extends d{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=i.util.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==i.ZodParsedType.object){const t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.object,received:t.parsedType}),s.INVALID}const{status:t,ctx:r}=this._processInputParams(e),{shape:n,keys:a}=this._getCached(),u=[];if(!(this._def.catchall instanceof S&&"strip"===this._def.unknownKeys))for(const e in r.data)a.includes(e)||u.push(e);const l=[];for(const e of a){const t=n[e],a=r.data[e];l.push({key:{status:"valid",value:e},value:t._parse(new c(r,a,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof S){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of u)l.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)u.length>0&&((0,s.addIssueToContext)(r,{code:o.ZodIssueCode.unrecognized_keys,keys:u}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of u){const n=r.data[t];l.push({key:{status:"valid",value:t},value:e._parse(new c(r,n,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of l){const r=await t.key;e.push({key:r,value:await t.value,alwaysSet:t.alwaysSet})}return e})).then((e=>s.ParseStatus.mergeObjectSync(t,e))):s.ParseStatus.mergeObjectSync(t,l)}get shape(){return this._def.shape()}strict(e){return a.errorUtil.errToObj,new M({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{var n,s,i,o;const c=null!==(i=null===(s=(n=this._def).errorMap)||void 0===s?void 0:s.call(n,t,r).message)&&void 0!==i?i:r.defaultError;return"unrecognized_keys"===t.code?{message:null!==(o=a.errorUtil.errToObj(e).message)&&void 0!==o?o:c}:{message:c}}}:{}})}strip(){return new M({...this._def,unknownKeys:"strip"})}passthrough(){return new M({...this._def,unknownKeys:"passthrough"})}extend(e){return new M({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new M({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:oe.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new M({...this._def,catchall:e})}pick(e){const t={};return i.util.objectKeys(e).forEach((r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])})),new M({...this._def,shape:()=>t})}omit(e){const t={};return i.util.objectKeys(this.shape).forEach((r=>{e[r]||(t[r]=this.shape[r])})),new M({...this._def,shape:()=>t})}deepPartial(){return R(this)}partial(e){const t={};return i.util.objectKeys(this.shape).forEach((r=>{const n=this.shape[r];e&&!e[r]?t[r]=n:t[r]=n.optional()})),new M({...this._def,shape:()=>t})}required(e){const t={};return i.util.objectKeys(this.shape).forEach((r=>{if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof Q;)e=e._def.innerType;t[r]=e}})),new M({...this._def,shape:()=>t})}keyof(){return W(i.util.objectKeys(this.shape))}}t.ZodObject=M,M.create=(e,t)=>new M({shape:()=>e,unknownKeys:"strip",catchall:S.create(),typeName:oe.ZodObject,...l(t)}),M.strictCreate=(e,t)=>new M({shape:()=>e,unknownKeys:"strict",catchall:S.create(),typeName:oe.ZodObject,...l(t)}),M.lazycreate=(e,t)=>new M({shape:e,unknownKeys:"strip",catchall:S.create(),typeName:oe.ZodObject,...l(t)});class L extends d{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map((async e=>{const r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;const r=e.map((e=>new o.ZodError(e.ctx.common.issues)));return(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_union,unionErrors:r}),s.INVALID}));{let e;const n=[];for(const a of r){const r={...t,common:{...t.common,issues:[]},parent:null},s=a._parseSync({data:t.data,path:t.path,parent:r});if("valid"===s.status)return s;"dirty"!==s.status||e||(e={result:s,ctx:r}),r.common.issues.length&&n.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const a=n.map((e=>new o.ZodError(e)));return(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_union,unionErrors:a}),s.INVALID}}get options(){return this._def.options}}t.ZodUnion=L,L.create=(e,t)=>new L({options:e,typeName:oe.ZodUnion,...l(t)});const Z=e=>e instanceof V?Z(e.schema):e instanceof X?Z(e.innerType()):e instanceof H?[e.value]:e instanceof Y?e.options:e instanceof J?Object.keys(e.enum):e instanceof te?Z(e._def.innerType):e instanceof T?[void 0]:e instanceof E?[null]:null;class D extends d{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==i.ZodParsedType.object)return(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.object,received:t.parsedType}),s.INVALID;const r=this.discriminator,n=t.data[r],a=this.optionsMap.get(n);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):((0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),s.INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const n=new Map;for(const r of t){const t=Z(r.shape[e]);if(!t)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of t){if(n.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);n.set(a,r)}}return new D({typeName:oe.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...l(r)})}}function U(e,t){const r=(0,i.getParsedType)(e),n=(0,i.getParsedType)(t);if(e===t)return{valid:!0,data:e};if(r===i.ZodParsedType.object&&n===i.ZodParsedType.object){const r=i.util.objectKeys(t),n=i.util.objectKeys(e).filter((e=>-1!==r.indexOf(e))),a={...e,...t};for(const r of n){const n=U(e[r],t[r]);if(!n.valid)return{valid:!1};a[r]=n.data}return{valid:!0,data:a}}if(r===i.ZodParsedType.array&&n===i.ZodParsedType.array){if(e.length!==t.length)return{valid:!1};const r=[];for(let n=0;n<e.length;n++){const a=U(e[n],t[n]);if(!a.valid)return{valid:!1};r.push(a.data)}return{valid:!0,data:r}}return r===i.ZodParsedType.date&&n===i.ZodParsedType.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}t.ZodDiscriminatedUnion=D;class z extends d{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),n=(e,n)=>{if((0,s.isAborted)(e)||(0,s.isAborted)(n))return s.INVALID;const a=U(e.value,n.value);return a.valid?(((0,s.isDirty)(e)||(0,s.isDirty)(n))&&t.dirty(),{status:t.value,value:a.data}):((0,s.addIssueToContext)(r,{code:o.ZodIssueCode.invalid_intersection_types}),s.INVALID)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then((([e,t])=>n(e,t))):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}t.ZodIntersection=z,z.create=(e,t,r)=>new z({left:e,right:t,typeName:oe.ZodIntersection,...l(r)});class $ extends d{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==i.ZodParsedType.array)return(0,s.addIssueToContext)(r,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.array,received:r.parsedType}),s.INVALID;if(r.data.length<this._def.items.length)return(0,s.addIssueToContext)(r,{code:o.ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),s.INVALID;!this._def.rest&&r.data.length>this._def.items.length&&((0,s.addIssueToContext)(r,{code:o.ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const n=[...r.data].map(((e,t)=>{const n=this._def.items[t]||this._def.rest;return n?n._parse(new c(r,e,r.path,t)):null})).filter((e=>!!e));return r.common.async?Promise.all(n).then((e=>s.ParseStatus.mergeArray(t,e))):s.ParseStatus.mergeArray(t,n)}get items(){return this._def.items}rest(e){return new $({...this._def,rest:e})}}t.ZodTuple=$,$.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new $({items:e,typeName:oe.ZodTuple,rest:null,...l(t)})};class K extends d{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==i.ZodParsedType.object)return(0,s.addIssueToContext)(r,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.object,received:r.parsedType}),s.INVALID;const n=[],a=this._def.keyType,u=this._def.valueType;for(const e in r.data)n.push({key:a._parse(new c(r,e,r.path,e)),value:u._parse(new c(r,r.data[e],r.path,e))});return r.common.async?s.ParseStatus.mergeObjectAsync(t,n):s.ParseStatus.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(e,t,r){return new K(t instanceof d?{keyType:e,valueType:t,typeName:oe.ZodRecord,...l(r)}:{keyType:_.create(),valueType:e,typeName:oe.ZodRecord,...l(t)})}}t.ZodRecord=K;class F extends d{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==i.ZodParsedType.map)return(0,s.addIssueToContext)(r,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.map,received:r.parsedType}),s.INVALID;const n=this._def.keyType,a=this._def.valueType,u=[...r.data.entries()].map((([e,t],s)=>({key:n._parse(new c(r,e,r.path,[s,"key"])),value:a._parse(new c(r,t,r.path,[s,"value"]))})));if(r.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const r of u){const n=await r.key,a=await r.value;if("aborted"===n.status||"aborted"===a.status)return s.INVALID;"dirty"!==n.status&&"dirty"!==a.status||t.dirty(),e.set(n.value,a.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const r of u){const n=r.key,a=r.value;if("aborted"===n.status||"aborted"===a.status)return s.INVALID;"dirty"!==n.status&&"dirty"!==a.status||t.dirty(),e.set(n.value,a.value)}return{status:t.value,value:e}}}}t.ZodMap=F,F.create=(e,t,r)=>new F({valueType:t,keyType:e,typeName:oe.ZodMap,...l(r)});class B extends d{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==i.ZodParsedType.set)return(0,s.addIssueToContext)(r,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.set,received:r.parsedType}),s.INVALID;const n=this._def;null!==n.minSize&&r.data.size<n.minSize.value&&((0,s.addIssueToContext)(r,{code:o.ZodIssueCode.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),null!==n.maxSize&&r.data.size>n.maxSize.value&&((0,s.addIssueToContext)(r,{code:o.ZodIssueCode.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());const a=this._def.valueType;function u(e){const r=new Set;for(const n of e){if("aborted"===n.status)return s.INVALID;"dirty"===n.status&&t.dirty(),r.add(n.value)}return{status:t.value,value:r}}const l=[...r.data.values()].map(((e,t)=>a._parse(new c(r,e,r.path,t))));return r.common.async?Promise.all(l).then((e=>u(e))):u(l)}min(e,t){return new B({...this._def,minSize:{value:e,message:a.errorUtil.toString(t)}})}max(e,t){return new B({...this._def,maxSize:{value:e,message:a.errorUtil.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}t.ZodSet=B,B.create=(e,t)=>new B({valueType:e,minSize:null,maxSize:null,typeName:oe.ZodSet,...l(t)});class q extends d{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==i.ZodParsedType.function)return(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.function,received:t.parsedType}),s.INVALID;function r(e,r){return(0,s.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,n.getErrorMap)(),n.defaultErrorMap].filter((e=>!!e)),issueData:{code:o.ZodIssueCode.invalid_arguments,argumentsError:r}})}function a(e,r){return(0,s.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,n.getErrorMap)(),n.defaultErrorMap].filter((e=>!!e)),issueData:{code:o.ZodIssueCode.invalid_return_type,returnTypeError:r}})}const c={errorMap:t.common.contextualErrorMap},u=t.data;if(this._def.returns instanceof G){const e=this;return(0,s.OK)((async function(...t){const n=new o.ZodError([]),s=await e._def.args.parseAsync(t,c).catch((e=>{throw n.addIssue(r(t,e)),n})),i=await Reflect.apply(u,this,s);return await e._def.returns._def.type.parseAsync(i,c).catch((e=>{throw n.addIssue(a(i,e)),n}))}))}{const e=this;return(0,s.OK)((function(...t){const n=e._def.args.safeParse(t,c);if(!n.success)throw new o.ZodError([r(t,n.error)]);const s=Reflect.apply(u,this,n.data),i=e._def.returns.safeParse(s,c);if(!i.success)throw new o.ZodError([a(s,i.error)]);return i.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new q({...this._def,args:$.create(e).rest(j.create())})}returns(e){return new q({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new q({args:e||$.create([]).rest(j.create()),returns:t||j.create(),typeName:oe.ZodFunction,...l(r)})}}t.ZodFunction=q;class V extends d{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}t.ZodLazy=V,V.create=(e,t)=>new V({getter:e,typeName:oe.ZodLazy,...l(t)});class H extends d{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{received:t.data,code:o.ZodIssueCode.invalid_literal,expected:this._def.value}),s.INVALID}return{status:"valid",value:e.data}}get value(){return this._def.value}}function W(e,t){return new Y({values:e,typeName:oe.ZodEnum,...l(t)})}t.ZodLiteral=H,H.create=(e,t)=>new H({value:e,typeName:oe.ZodLiteral,...l(t)});class Y extends d{_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),r=this._def.values;return(0,s.addIssueToContext)(t,{expected:i.util.joinValues(r),received:t.parsedType,code:o.ZodIssueCode.invalid_type}),s.INVALID}if(-1===this._def.values.indexOf(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return(0,s.addIssueToContext)(t,{received:t.data,code:o.ZodIssueCode.invalid_enum_value,options:r}),s.INVALID}return(0,s.OK)(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return Y.create(e)}exclude(e){return Y.create(this.options.filter((t=>!e.includes(t))))}}t.ZodEnum=Y,Y.create=W;class J extends d{_parse(e){const t=i.util.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==i.ZodParsedType.string&&r.parsedType!==i.ZodParsedType.number){const e=i.util.objectValues(t);return(0,s.addIssueToContext)(r,{expected:i.util.joinValues(e),received:r.parsedType,code:o.ZodIssueCode.invalid_type}),s.INVALID}if(-1===t.indexOf(e.data)){const e=i.util.objectValues(t);return(0,s.addIssueToContext)(r,{received:r.data,code:o.ZodIssueCode.invalid_enum_value,options:e}),s.INVALID}return(0,s.OK)(e.data)}get enum(){return this._def.values}}t.ZodNativeEnum=J,J.create=(e,t)=>new J({values:e,typeName:oe.ZodNativeEnum,...l(t)});class G extends d{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==i.ZodParsedType.promise&&!1===t.common.async)return(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.promise,received:t.parsedType}),s.INVALID;const r=t.parsedType===i.ZodParsedType.promise?t.data:Promise.resolve(t.data);return(0,s.OK)(r.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}t.ZodPromise=G,G.create=(e,t)=>new G({type:e,typeName:oe.ZodPromise,...l(t)});class X extends d{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===oe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),n=this._def.effect||null,a={addIssue:e=>{(0,s.addIssueToContext)(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),"preprocess"===n.type){const e=n.transform(r.data,a);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(e).then((e=>this._def.schema._parseAsync({data:e,path:r.path,parent:r}))):this._def.schema._parseSync({data:e,path:r.path,parent:r})}if("refinement"===n.type){const e=e=>{const t=n.refinement(e,a);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===r.common.async){const n=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===n.status?s.INVALID:("dirty"===n.status&&t.dirty(),e(n.value),{status:t.value,value:n.value})}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then((r=>"aborted"===r.status?s.INVALID:("dirty"===r.status&&t.dirty(),e(r.value).then((()=>({status:t.value,value:r.value}))))))}if("transform"===n.type){if(!1===r.common.async){const e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!(0,s.isValid)(e))return e;const i=n.transform(e.value,a);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:i}}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then((e=>(0,s.isValid)(e)?Promise.resolve(n.transform(e.value,a)).then((e=>({status:t.value,value:e}))):e))}i.util.assertNever(n)}}t.ZodEffects=X,t.ZodTransformer=X,X.create=(e,t,r)=>new X({schema:e,typeName:oe.ZodEffects,effect:t,...l(r)}),X.createWithPreprocess=(e,t,r)=>new X({schema:t,effect:{type:"preprocess",transform:e},typeName:oe.ZodEffects,...l(r)});class Q extends d{_parse(e){return this._getType(e)===i.ZodParsedType.undefined?(0,s.OK)(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}t.ZodOptional=Q,Q.create=(e,t)=>new Q({innerType:e,typeName:oe.ZodOptional,...l(t)});class ee extends d{_parse(e){return this._getType(e)===i.ZodParsedType.null?(0,s.OK)(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}t.ZodNullable=ee,ee.create=(e,t)=>new ee({innerType:e,typeName:oe.ZodNullable,...l(t)});class te extends d{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===i.ZodParsedType.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}t.ZodDefault=te,te.create=(e,t)=>new te({innerType:e,typeName:oe.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...l(t)});class re extends d{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return(0,s.isAsync)(n)?n.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new o.ZodError(r.common.issues)},input:r.data})}))):{status:"valid",value:"valid"===n.status?n.value:this._def.catchValue({get error(){return new o.ZodError(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}t.ZodCatch=re,re.create=(e,t)=>new re({innerType:e,typeName:oe.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...l(t)});class ne extends d{_parse(e){if(this._getType(e)!==i.ZodParsedType.nan){const t=this._getOrReturnCtx(e);return(0,s.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:i.ZodParsedType.nan,received:t.parsedType}),s.INVALID}return{status:"valid",value:e.data}}}t.ZodNaN=ne,ne.create=e=>new ne({typeName:oe.ZodNaN,...l(e)}),t.BRAND=Symbol("zod_brand");class ae extends d{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}t.ZodBranded=ae;class se extends d{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?s.INVALID:"dirty"===e.status?(t.dirty(),(0,s.DIRTY)(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})();{const e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?s.INVALID:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new se({in:e,out:t,typeName:oe.ZodPipeline})}}t.ZodPipeline=se;class ie extends d{_parse(e){const t=this._def.innerType._parse(e);return(0,s.isValid)(t)&&(t.value=Object.freeze(t.value)),t}}var oe;t.ZodReadonly=ie,ie.create=(e,t)=>new ie({innerType:e,typeName:oe.ZodReadonly,...l(t)}),t.custom=(e,t={},r)=>e?k.create().superRefine(((n,a)=>{var s,i;if(!e(n)){const e="function"==typeof t?t(n):"string"==typeof t?{message:t}:t,o=null===(i=null!==(s=e.fatal)&&void 0!==s?s:r)||void 0===i||i,c="string"==typeof e?{message:e}:e;a.addIssue({code:"custom",...c,fatal:o})}})):k.create(),t.late={object:M.lazycreate},function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(oe=t.ZodFirstPartyTypeKind||(t.ZodFirstPartyTypeKind={})),t.instanceof=(e,r={message:`Input not instance of ${e.name}`})=>(0,t.custom)((t=>t instanceof e),r);const ce=_.create;t.string=ce;const ue=O.create;t.number=ue;const le=ne.create;t.nan=le;const de=x.create;t.bigint=de;const he=P.create;t.boolean=he;const pe=A.create;t.date=pe;const fe=I.create;t.symbol=fe;const me=T.create;t.undefined=me;const ge=E.create;t.null=ge;const ye=k.create;t.any=ye;const be=j.create;t.unknown=be;const ve=S.create;t.never=ve;const _e=C.create;t.void=_e;const we=N.create;t.array=we;const Oe=M.create;t.object=Oe;const xe=M.strictCreate;t.strictObject=xe;const Pe=L.create;t.union=Pe;const Ae=D.create;t.discriminatedUnion=Ae;const Ie=z.create;t.intersection=Ie;const Te=$.create;t.tuple=Te;const Ee=K.create;t.record=Ee;const ke=F.create;t.map=ke;const je=B.create;t.set=je;const Se=q.create;t.function=Se;const Ce=V.create;t.lazy=Ce;const Ne=H.create;t.literal=Ne;const Re=Y.create;t.enum=Re;const Me=J.create;t.nativeEnum=Me;const Le=G.create;t.promise=Le;const Ze=X.create;t.effect=Ze,t.transformer=Ze;const De=Q.create;t.optional=De;const Ue=ee.create;t.nullable=Ue;const ze=X.createWithPreprocess;t.preprocess=ze;const $e=se.create;t.pipeline=$e,t.ostring=()=>ce().optional(),t.onumber=()=>ue().optional(),t.oboolean=()=>he().optional(),t.coerce={string:e=>_.create({...e,coerce:!0}),number:e=>O.create({...e,coerce:!0}),boolean:e=>P.create({...e,coerce:!0}),bigint:e=>x.create({...e,coerce:!0}),date:e=>A.create({...e,coerce:!0})},t.NEVER=s.INVALID},1023:(e,t,r)=>{"use strict";r.d(t,{F1:()=>s,_i:()=>a});var n=r(8186);const a=e=>e.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":e.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":e.startsWith("gpt-4-32k")?"gpt-4-32k":e.startsWith("gpt-4-")?"gpt-4":e,s=async({prompt:e,modelName:t})=>{let r;try{r=(await(0,n.b)(t)).encode(e).length}catch(t){console.warn("Failed to calculate number of tokens, falling back to approximate count"),r=Math.ceil(e.length/4)}const s=(e=>{switch(a(e)){case"gpt-3.5-turbo-16k":return 16384;case"gpt-3.5-turbo":return 4096;case"gpt-4-32k":return 32768;case"gpt-4":return 8192;case"text-davinci-003":default:return 4097;case"text-curie-001":case"text-babbage-001":case"text-ada-001":case"code-cushman-001":return 2048;case"code-davinci-002":return 8e3}})(t);return s-r}},8610:(e,t,r)=>{"use strict";r.d(t,{BD:()=>u,qV:()=>l});var n=r(803),a=r(1023),s=r(8186),i=r(0),o=r(5962),c=r(2587);class u extends i.eq{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??!1,this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class l extends u{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:t,...r}){super({callbacks:e??t,...r}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.caller=new n.L(r??{})}async getNumTokens(e){let t=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await(0,s.b)("modelName"in this?(0,a._i)(this.modelName):"gpt2")}catch(e){console.warn("Failed to calculate number of tokens, falling back to approximate count",e)}return this._encoding&&(t=this._encoding.encode(e).length),t}static _convertInputToPromptValue(e){return"string"==typeof e?new o.nw(e):Array.isArray(e)?new c.GU(e):e}_identifyingParams(){return{}}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){const{_type:t,_model:n,...a}=e;if(n&&"base_chat_model"!==n)throw new Error(`Cannot load LLM with model ${n}`);const s={openai:(await Promise.resolve().then(r.bind(r,4182))).ChatOpenAI}[t];if(void 0===s)throw new Error(`Cannot load LLM with type ${t}`);return new s(a)}}},1512:(e,t,r)=>{"use strict";r.d(t,{Ye:()=>V,QH:()=>U});const n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let a;const s=new Uint8Array(16);function i(){if(!a&&(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!a))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(s)}const o=[];for(let e=0;e<256;++e)o.push((e+256).toString(16).slice(1));const c=function(e,t,r){if(n.randomUUID&&!t&&!e)return n.randomUUID();const a=(e=e||{}).random||(e.rng||i)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=a[e];return t}return function(e,t=0){return(o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]).toLowerCase()}(a)};var u=r(2385);class l{}class d extends l{get lc_namespace(){return["langchain","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,(0,u.j)(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:"undefined"==typeof process||"true"!==process.env?.LANGCHAIN_CALLBACKS_BACKGROUND}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever)}copy(){return new this.constructor(this)}toJSON(){return u.i.prototype.toJSON.call(this)}toJSONNotImplemented(){return u.i.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){return new class extends d{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:c()}),Object.assign(this,e)}}}}var h=r(6434);function p(e,t){return e&&!Array.isArray(e)&&"object"==typeof e?e:{[t]:e}}class f extends d{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}_addChildRun(e,t){e.child_runs.push(t)}_startTrace(e){if(void 0!==e.parent_run_id){const t=this.runMap.get(e.parent_run_id);t&&(this._addChildRun(t,e),t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order))}this.runMap.set(e.id,e)}async _endTrace(e){const t=void 0!==e.parent_run_id&&this.runMap.get(e.parent_run_id);t?t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id)}_getExecutionOrder(e){const t=void 0!==e&&this.runMap.get(e);return t?t.child_execution_order+1:1}async handleLLMStart(e,t,r,n,a,s,i){const o=this._getExecutionOrder(n),c=Date.now(),u=i?{...a,metadata:i}:a,l={id:r,name:e.id[e.id.length-1],parent_run_id:n,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{prompts:t},execution_order:o,child_runs:[],child_execution_order:o,run_type:"llm",extra:u??{},tags:s||[]};this._startTrace(l),await(this.onLLMStart?.(l))}async handleChatModelStart(e,t,r,n,a,s,i){const o=this._getExecutionOrder(n),c=Date.now(),u=i?{...a,metadata:i}:a,l={id:r,name:e.id[e.id.length-1],parent_run_id:n,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{messages:t},execution_order:o,child_runs:[],child_execution_order:o,run_type:"llm",extra:u??{},tags:s||[]};this._startTrace(l),await(this.onLLMStart?.(l))}async handleLLMEnd(e,t){const r=this.runMap.get(t);if(!r||"llm"!==r?.run_type)throw new Error("No LLM run to end.");r.end_time=Date.now(),r.outputs=e,r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await(this.onLLMEnd?.(r)),await this._endTrace(r)}async handleLLMError(e,t){const r=this.runMap.get(t);if(!r||"llm"!==r?.run_type)throw new Error("No LLM run to end.");r.end_time=Date.now(),r.error=e.message,r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await(this.onLLMError?.(r)),await this._endTrace(r)}async handleChainStart(e,t,r,n,a,s,i){const o=this._getExecutionOrder(n),c=Date.now(),u={id:r,name:e.id[e.id.length-1],parent_run_id:n,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:t,execution_order:o,child_execution_order:o,run_type:i??"chain",child_runs:[],extra:s?{metadata:s}:{},tags:a||[]};this._startTrace(u),await(this.onChainStart?.(u))}async handleChainEnd(e,t,r,n,a){const s=this.runMap.get(t);if(!s)throw new Error("No chain run to end.");s.end_time=Date.now(),s.outputs=p(e,"output"),s.events.push({name:"end",time:new Date(s.end_time).toISOString()}),void 0!==a?.inputs&&(s.inputs=p(a.inputs,"input")),await(this.onChainEnd?.(s)),await this._endTrace(s)}async handleChainError(e,t,r,n,a){const s=this.runMap.get(t);if(!s)throw new Error("No chain run to end.");s.end_time=Date.now(),s.error=e.message,s.events.push({name:"error",time:new Date(s.end_time).toISOString()}),void 0!==a?.inputs&&(s.inputs=p(a.inputs,"input")),await(this.onChainError?.(s)),await this._endTrace(s)}async handleToolStart(e,t,r,n,a,s){const i=this._getExecutionOrder(n),o=Date.now(),c={id:r,name:e.id[e.id.length-1],parent_run_id:n,start_time:o,serialized:e,events:[{name:"start",time:new Date(o).toISOString()}],inputs:{input:t},execution_order:i,child_execution_order:i,run_type:"tool",child_runs:[],extra:s?{metadata:s}:{},tags:a||[]};this._startTrace(c),await(this.onToolStart?.(c))}async handleToolEnd(e,t){const r=this.runMap.get(t);if(!r||"tool"!==r?.run_type)throw new Error("No tool run to end");r.end_time=Date.now(),r.outputs={output:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await(this.onToolEnd?.(r)),await this._endTrace(r)}async handleToolError(e,t){const r=this.runMap.get(t);if(!r||"tool"!==r?.run_type)throw new Error("No tool run to end");r.end_time=Date.now(),r.error=e.message,r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await(this.onToolError?.(r)),await this._endTrace(r)}async handleAgentAction(e,t){const r=this.runMap.get(t);if(!r||"chain"!==r?.run_type)return;const n=r;n.actions=n.actions||[],n.actions.push(e),n.events.push({name:"agent_action",time:(new Date).toISOString(),kwargs:{action:e}}),await(this.onAgentAction?.(r))}async handleAgentEnd(e,t){const r=this.runMap.get(t);r&&"chain"===r?.run_type&&(r.events.push({name:"agent_end",time:(new Date).toISOString(),kwargs:{action:e}}),await(this.onAgentEnd?.(r)))}async handleRetrieverStart(e,t,r,n,a,s){const i=this._getExecutionOrder(n),o=Date.now(),c={id:r,name:e.id[e.id.length-1],parent_run_id:n,start_time:o,serialized:e,events:[{name:"start",time:new Date(o).toISOString()}],inputs:{query:t},execution_order:i,child_execution_order:i,run_type:"retriever",child_runs:[],extra:s?{metadata:s}:{},tags:a||[]};this._startTrace(c),await(this.onRetrieverStart?.(c))}async handleRetrieverEnd(e,t){const r=this.runMap.get(t);if(!r||"retriever"!==r?.run_type)throw new Error("No retriever run to end");r.end_time=Date.now(),r.outputs={documents:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await(this.onRetrieverEnd?.(r)),await this._endTrace(r)}async handleRetrieverError(e,t){const r=this.runMap.get(t);if(!r||"retriever"!==r?.run_type)throw new Error("No retriever run to end");r.end_time=Date.now(),r.error=e.message,r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await(this.onRetrieverError?.(r)),await this._endTrace(r)}async handleText(e,t){const r=this.runMap.get(t);r&&"chain"===r?.run_type&&(r.events.push({name:"text",time:(new Date).toISOString(),kwargs:{text:e}}),await(this.onText?.(r)))}async handleLLMNewToken(e,t,r,n,a,s){const i=this.runMap.get(r);i&&"llm"===i?.run_type&&(i.events.push({name:"new_token",time:(new Date).toISOString(),kwargs:{token:e,idx:t,chunk:s?.chunk}}),await(this.onLLMNewToken?.(i)))}}function m(e,t){return`${e.open}${t}${e.close}`}function g(e,t){try{return JSON.stringify(e,null,2)}catch(e){return t}}function y(e){if(!e.end_time)return"";const t=e.end_time-e.start_time;return t<1e3?`${t}ms`:`${(t/1e3).toFixed(2)}s`}const{color:b}=h;class v extends f{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const t=[];let r=e;for(;r.parent_run_id;){const e=this.runMap.get(r.parent_run_id);if(!e)break;t.push(e),r=e}return t}getBreadcrumbs(e){const t=[...this.getParents(e).reverse(),e].map(((e,t,r)=>{const n=`${e.execution_order}:${e.run_type}:${e.name}`;return t===r.length-1?m(h.bold,n):n})).join(" > ");return m(b.grey,t)}onChainStart(e){const t=this.getBreadcrumbs(e);console.log(`${m(b.green,"[chain/start]")} [${t}] Entering Chain run with input: ${g(e.inputs,"[inputs]")}`)}onChainEnd(e){const t=this.getBreadcrumbs(e);console.log(`${m(b.cyan,"[chain/end]")} [${t}] [${y(e)}] Exiting Chain run with output: ${g(e.outputs,"[outputs]")}`)}onChainError(e){const t=this.getBreadcrumbs(e);console.log(`${m(b.red,"[chain/error]")} [${t}] [${y(e)}] Chain run errored with error: ${g(e.error,"[error]")}`)}onLLMStart(e){const t=this.getBreadcrumbs(e),r="prompts"in e.inputs?{prompts:e.inputs.prompts.map((e=>e.trim()))}:e.inputs;console.log(`${m(b.green,"[llm/start]")} [${t}] Entering LLM run with input: ${g(r,"[inputs]")}`)}onLLMEnd(e){const t=this.getBreadcrumbs(e);console.log(`${m(b.cyan,"[llm/end]")} [${t}] [${y(e)}] Exiting LLM run with output: ${g(e.outputs,"[response]")}`)}onLLMError(e){const t=this.getBreadcrumbs(e);console.log(`${m(b.red,"[llm/error]")} [${t}] [${y(e)}] LLM run errored with error: ${g(e.error,"[error]")}`)}onToolStart(e){const t=this.getBreadcrumbs(e);console.log(`${m(b.green,"[tool/start]")} [${t}] Entering Tool run with input: "${e.inputs.input?.trim()}"`)}onToolEnd(e){const t=this.getBreadcrumbs(e);console.log(`${m(b.cyan,"[tool/end]")} [${t}] [${y(e)}] Exiting Tool run with output: "${e.outputs?.output?.trim()}"`)}onToolError(e){const t=this.getBreadcrumbs(e);console.log(`${m(b.red,"[tool/error]")} [${t}] [${y(e)}] Tool run errored with error: ${g(e.error,"[error]")}`)}onRetrieverStart(e){const t=this.getBreadcrumbs(e);console.log(`${m(b.green,"[retriever/start]")} [${t}] Entering Retriever run with input: ${g(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const t=this.getBreadcrumbs(e);console.log(`${m(b.cyan,"[retriever/end]")} [${t}] [${y(e)}] Exiting Retriever run with output: ${g(e.outputs,"[outputs]")}`)}onRetrieverError(e){const t=this.getBreadcrumbs(e);console.log(`${m(b.red,"[retriever/error]")} [${t}] [${y(e)}] Retriever run errored with error: ${g(e.error,"[error]")}`)}onAgentAction(e){const t=e,r=this.getBreadcrumbs(e);console.log(`${m(b.blue,"[agent/action]")} [${r}] Agent selected action: ${g(t.actions[t.actions.length-1],"[action]")}`)}}var _=r(2693),w=r(5860);const O=[400,401,403,404,405,406,407,408,409];class x{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6;const t=w.default;this.queue=new t({concurrency:this.maxConcurrency})}call(e,...t){return this.queue.add((()=>_((()=>e(...t).catch((e=>{throw e instanceof Error?e:new Error(e)}))),{onFailedAttempt(e){if(e.message.startsWith("Cancel")||e.message.startsWith("TimeoutError")||e.message.startsWith("AbortError"))throw e;if("ECONNABORTED"===e?.code)throw e;const t=e?.response?.status;if(t&&O.includes(+t))throw e},retries:this.maxRetries,randomize:!0})),{throwOnTimeout:!0})}callWithOptions(e,t,...r){return e.signal?Promise.race([this.call(t,...r),new Promise(((t,r)=>{e.signal?.addEventListener("abort",(()=>{r(new Error("AbortError"))}))}))]):this.call(t,...r)}fetch(...e){return this.call((()=>fetch(...e).then((e=>e.ok?e:Promise.reject(e)))))}}const P=()=>"undefined"!=typeof Deno;let A,I;async function T(){if(void 0===A){const e=(()=>{let e;return e="undefined"!=typeof window&&void 0!==window.document?"browser":"undefined"==typeof process||void 0===process.versions||void 0===process.versions.node||P()?"object"==typeof globalThis&&globalThis.constructor&&"DedicatedWorkerGlobalScope"===globalThis.constructor.name?"webworker":"undefined"!=typeof window&&"nodejs"===window.name||"undefined"!=typeof navigator&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom"))?"jsdom":P()?"deno":"other":"node",e})(),t=function(){if(void 0!==I)return I;const e=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],t={};for(const r of e){const e=E(r);void 0!==e&&(t[r]=e)}return I=t,t}();A={library:"langsmith",runtime:e,...t}}return A}function E(e){try{return"undefined"!=typeof process?process.env?.[e]:void 0}catch(e){return}}const k=e=>{const t=e.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return"localhost"===t||"127.0.0.1"===t||"::1"===t},j=async(e,t)=>{const r=await e.text();if(!e.ok)throw new Error(`Failed to ${t}: ${e.status} ${e.statusText} ${r}`)};function S(e){if(void 0!==e)return e.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}class C{constructor(e={}){Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const t=C.getDefaultClientConfig();this.apiUrl=S(e.apiUrl??t.apiUrl)??"",this.apiKey=S(e.apiKey??t.apiKey),this.validateApiKeyIfHosted(),this.timeout_ms=e.timeout_ms??4e3,this.caller=new x(e.callerOptions??{})}static getDefaultClientConfig(){const e=E("LANGCHAIN_API_KEY");return{apiUrl:E("LANGCHAIN_ENDPOINT")??(e?"https://api.smith.langchain.com":"http://localhost:1984"),apiKey:e}}validateApiKeyIfHosted(){if(!k(this.apiUrl)&&!this.apiKey)throw new Error("API key must be provided when using hosted LangSmith API")}getHostUrl(){return k(this.apiUrl)?"http://localhost":this.apiUrl.split(".",1)[0].includes("dev")?"https://dev.smith.langchain.com":"https://smith.langchain.com"}get headers(){const e={};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}async _get(e,t){const r=t?.toString()??"",n=`${this.apiUrl}${e}?${r}`,a=await this.caller.call(fetch,n,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!a.ok)throw new Error(`Failed to fetch ${e}: ${a.status} ${a.statusText}`);return a.json()}async*_getPaginated(e,t=new URLSearchParams){let r=Number(t.get("offset"))||0;const n=Number(t.get("limit"))||100;for(;;){t.set("offset",String(r)),t.set("limit",String(n));const a=`${this.apiUrl}${e}?${t}`,s=await this.caller.call(fetch,a,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!s.ok)throw new Error(`Failed to fetch ${e}: ${s.status} ${s.statusText}`);const i=await s.json();if(0===i.length)break;if(yield i,i.length<n)break;r+=i.length}}async createRun(e){const t={...this.headers,"Content-Type":"application/json"},r=e.extra??{},n=await T(),a=e.project_name;delete e.project_name;const s={session_name:a,...e,extra:{...e.extra,runtime:{...n,...r.runtime}}},i=await this.caller.call(fetch,`${this.apiUrl}/runs`,{method:"POST",headers:t,body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms)});await j(i,"create run")}async updateRun(e,t){const r={...this.headers,"Content-Type":"application/json"},n=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:r,body:JSON.stringify(t),signal:AbortSignal.timeout(this.timeout_ms)});await j(n,"update run")}async readRun(e,{loadChildRuns:t}={loadChildRuns:!1}){let r=await this._get(`/runs/${e}`);return t&&r.child_run_ids&&(r=await this._loadChildRuns(r)),r}async getRunUrl({runId:e}){const t=await this.readRun(e);if(t.app_path)return`${this.getHostUrl()}${t.app_path}`}async _loadChildRuns(e){const t=await async function(e){const t=[];for await(const r of e)t.push(r);return t}(this.listRuns({id:e.child_run_ids})),r={},n={};t.sort(((e,t)=>e.execution_order-t.execution_order));for(const e of t){if(null===e.parent_run_id||void 0===e.parent_run_id)throw new Error(`Child run ${e.id} has no parent`);e.parent_run_id in r||(r[e.parent_run_id]=[]),r[e.parent_run_id].push(e),n[e.id]=e}e.child_runs=r[e.id]||[];for(const t in r)t!==e.id&&(n[t].child_runs=r[t]);return e}async*listRuns({projectId:e,projectName:t,parentRunId:r,referenceExampleId:n,startTime:a,executionOrder:s,runType:i,error:o,id:c,limit:u,offset:l,query:d,filter:h}){const p=new URLSearchParams;let f=e;if(t){if(e)throw new Error("Only one of projectId or projectName may be given");f=(await this.readProject({projectName:t})).id}if(f&&p.append("session",f),r&&p.append("parent_run",r),n&&p.append("reference_example",n),a&&p.append("start_time",a.toISOString()),s&&p.append("execution_order",s.toString()),i&&p.append("run_type",i),void 0!==o&&p.append("error",o.toString()),void 0!==c)for(const e of c)p.append("id",e);void 0!==u&&p.append("limit",u.toString()),void 0!==l&&p.append("offset",l.toString()),void 0!==d&&p.append("query",d),void 0!==h&&p.append("filter",h);for await(const e of this._getPaginated("/runs",p))yield*e}async shareRun(e,{shareId:t}={}){const r={run_id:e,share_token:t||c()},n=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms)}),a=await n.json();if(null===a||!("share_token"in a))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${a.share_token}/r`}async unshareRun(e){const t=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});await j(t,"unshare run")}async readRunSharedLink(e){const t=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)}),r=await t.json();if(null!==r&&"share_token"in r)return`${this.getHostUrl()}/public/${r.share_token}/r`}async createProject({projectName:e,projectExtra:t,upsert:r}){const n=r?"?upsert=true":"",a=`${this.apiUrl}/sessions${n}`,s={name:e};void 0!==t&&(s.extra=t);const i=await this.caller.call(fetch,a,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms)}),o=await i.json();if(!i.ok)throw new Error(`Failed to create session ${e}: ${i.status} ${i.statusText}`);return o}async readProject({projectId:e,projectName:t}){let r="/sessions";const n=new URLSearchParams;if(void 0!==e&&void 0!==t)throw new Error("Must provide either projectName or projectId, not both");if(void 0!==e)r+=`/${e}`;else{if(void 0===t)throw new Error("Must provide projectName or projectId");n.append("name",t)}const a=await this._get(r,n);let s;if(Array.isArray(a)){if(0===a.length)throw new Error(`Project[id=${e}, name=${t}] not found`);s=a[0]}else s=a;return s}async*listProjects({projectIds:e,name:t,nameContains:r,referenceDatasetId:n,referenceDatasetName:a,referenceFree:s}={}){const i=new URLSearchParams;if(void 0!==e)for(const t of e)i.append("id",t);if(void 0!==t&&i.append("name",t),void 0!==r&&i.append("name_contains",r),void 0!==n)i.append("reference_dataset",n);else if(void 0!==a){const e=await this.readDataset({datasetName:a});i.append("reference_dataset",e.id)}void 0!==s&&i.append("reference_free",s.toString());for await(const e of this._getPaginated("/sessions",i))yield*e}async deleteProject({projectId:e,projectName:t}){let r;if(void 0===e&&void 0===t)throw new Error("Must provide projectName or projectId");if(void 0!==e&&void 0!==t)throw new Error("Must provide either projectName or projectId, not both");r=void 0===e?(await this.readProject({projectName:t})).id:e;const n=await this.caller.call(fetch,`${this.apiUrl}/sessions/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});await j(n,`delete session ${r} (${t})`)}async uploadCsv({csvFile:e,fileName:t,inputKeys:r,outputKeys:n,description:a,dataType:s,name:i}){const o=`${this.apiUrl}/datasets/upload`,c=new FormData;c.append("file",e,t),r.forEach((e=>{c.append("input_keys",e)})),n.forEach((e=>{c.append("output_keys",e)})),a&&c.append("description",a),s&&c.append("data_type",s),i&&c.append("name",i);const u=await this.caller.call(fetch,o,{method:"POST",headers:this.headers,body:c,signal:AbortSignal.timeout(this.timeout_ms)});if(!u.ok){const e=await u.json();if(e.detail&&e.detail.includes("already exists"))throw new Error(`Dataset ${t} already exists`);throw new Error(`Failed to upload CSV: ${u.status} ${u.statusText}`)}return await u.json()}async createDataset(e,{description:t,dataType:r}={}){const n={name:e,description:t};r&&(n.data_type=r);const a=await this.caller.call(fetch,`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms)});if(!a.ok){const t=await a.json();if(t.detail&&t.detail.includes("already exists"))throw new Error(`Dataset ${e} already exists`);throw new Error(`Failed to create dataset ${a.status} ${a.statusText}`)}return await a.json()}async readDataset({datasetId:e,datasetName:t}){let r="/datasets";const n=new URLSearchParams({limit:"1"});if(void 0!==e&&void 0!==t)throw new Error("Must provide either datasetName or datasetId, not both");if(void 0!==e)r+=`/${e}`;else{if(void 0===t)throw new Error("Must provide datasetName or datasetId");n.append("name",t)}const a=await this._get(r,n);let s;if(Array.isArray(a)){if(0===a.length)throw new Error(`Dataset[id=${e}, name=${t}] not found`);s=a[0]}else s=a;return s}async*listDatasets({limit:e=100,offset:t=0,datasetIds:r,datasetName:n,datasetNameContains:a}={}){const s=new URLSearchParams({limit:e.toString(),offset:t.toString()});if(void 0!==r)for(const e of r)s.append("id",e);void 0!==n&&s.append("name",n),void 0!==a&&s.append("name_contains",a);for await(const e of this._getPaginated("/datasets",s))yield*e}async deleteDataset({datasetId:e,datasetName:t}){let r="/datasets",n=e;if(void 0!==e&&void 0!==t)throw new Error("Must provide either datasetName or datasetId, not both");if(void 0!==t&&(n=(await this.readDataset({datasetName:t})).id),void 0===n)throw new Error("Must provide datasetName or datasetId");r+=`/${n}`;const a=await this.caller.call(fetch,this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!a.ok)throw new Error(`Failed to delete ${r}: ${a.status} ${a.statusText}`);await a.json()}async createExample(e,t,{datasetId:r,datasetName:n,createdAt:a}){let s=r;if(void 0===s&&void 0===n)throw new Error("Must provide either datasetName or datasetId");if(void 0!==s&&void 0!==n)throw new Error("Must provide either datasetName or datasetId, not both");void 0===s&&(s=(await this.readDataset({datasetName:n})).id);const i={dataset_id:s,inputs:e,outputs:t,created_at:(a||new Date).toISOString()},o=await this.caller.call(fetch,`${this.apiUrl}/examples`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms)});if(!o.ok)throw new Error(`Failed to create example: ${o.status} ${o.statusText}`);return await o.json()}async readExample(e){const t=`/examples/${e}`;return await this._get(t)}async*listExamples({datasetId:e,datasetName:t,exampleIds:r}={}){let n;if(void 0!==e&&void 0!==t)throw new Error("Must provide either datasetName or datasetId, not both");if(void 0!==e)n=e;else{if(void 0===t)throw new Error("Must provide a datasetName or datasetId");n=(await this.readDataset({datasetName:t})).id}const a=new URLSearchParams({dataset:n});if(void 0!==r)for(const e of r)a.append("id",e);for await(const e of this._getPaginated("/examples",a))yield*e}async deleteExample(e){const t=`/examples/${e}`,r=await this.caller.call(fetch,this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!r.ok)throw new Error(`Failed to delete ${t}: ${r.status} ${r.statusText}`);await r.json()}async updateExample(e,t){const r=await this.caller.call(fetch,`${this.apiUrl}/examples/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(t),signal:AbortSignal.timeout(this.timeout_ms)});if(!r.ok)throw new Error(`Failed to update example ${e}: ${r.status} ${r.statusText}`);return await r.json()}async evaluateRun(e,t,{sourceInfo:r,loadChildRuns:n}={loadChildRuns:!1}){let a,s;if("string"==typeof e)a=await this.readRun(e,{loadChildRuns:n});else{if("object"!=typeof e||!("id"in e))throw new Error("Invalid run type: "+typeof e);a=e}null!==a.reference_example_id&&void 0!==a.reference_example_id&&(s=await this.readExample(a.reference_example_id));const i=await t.evaluateRun(a,s);let o=r??{};return i.evaluatorInfo&&(o={...o,...i.evaluatorInfo}),await this.createFeedback(a.id,i.key,{score:i.score,value:i.value,comment:i.comment,correction:i.correction,sourceInfo:o,feedbackSourceType:"MODEL"})}async createFeedback(e,t,{score:r,value:n,correction:a,comment:s,sourceInfo:i,feedbackSourceType:o="API",sourceRunId:u}){let l;if("API"===o)l={type:"api",metadata:i??{}};else{if("MODEL"!==o)throw new Error(`Unknown feedback source type ${o}`);l={type:"model",metadata:i??{}}}void 0===u||void 0===l?.metadata||l.metadata.__run||(l.metadata.__run={run_id:u});const d={id:c(),run_id:e,key:t,score:r,value:n,correction:a,comment:s,feedback_source:l},h=await this.caller.call(fetch,`${this.apiUrl}/feedback`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(d),signal:AbortSignal.timeout(this.timeout_ms)});if(!h.ok)throw new Error(`Failed to create feedback for run ${e}: ${h.status} ${h.statusText}`);return await h.json()}async updateFeedback(e,{score:t,value:r,correction:n,comment:a}){const s={};return null!=t&&(s.score=t),null!=r&&(s.value=r),null!=n&&(s.correction=n),null!=a&&(s.comment=a),(await this.caller.call(fetch,`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms)})).json()}async readFeedback(e){const t=`/feedback/${e}`;return await this._get(t)}async deleteFeedback(e){const t=`/feedback/${e}`,r=await this.caller.call(fetch,this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!r.ok)throw new Error(`Failed to delete ${t}: ${r.status} ${r.statusText}`);await r.json()}async*listFeedback({runIds:e}={}){const t=new URLSearchParams;e&&t.append("run",e.join(","));for await(const e of this._getPaginated("/feedback",t))yield*e}}var N=r(5606);class R extends f{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:t,projectName:r,client:n}=e;this.projectName=r??(0,N.lS)("LANGCHAIN_PROJECT")??(0,N.lS)("LANGCHAIN_SESSION"),this.exampleId=t,this.client=n??new C({})}async _convertToCreate(e,t=void 0){return{...e,extra:{...e.extra,runtime:await(0,N.sA)()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:t}}async persistRun(e){}async _persistRunSingle(e){const t=await this._convertToCreate(e,this.exampleId);await this.client.createRun(t)}async _updateRunSingle(e){const t={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events,inputs:e.inputs};await this.client.updateRun(e.id,t)}async onRetrieverStart(e){await this._persistRunSingle(e)}async onRetrieverEnd(e){await this._updateRunSingle(e)}async onRetrieverError(e){await this._updateRunSingle(e)}async onLLMStart(e){await this._persistRunSingle(e)}async onLLMEnd(e){await this._updateRunSingle(e)}async onLLMError(e){await this._updateRunSingle(e)}async onChainStart(e){await this._persistRunSingle(e)}async onChainEnd(e){await this._updateRunSingle(e)}async onChainError(e){await this._updateRunSingle(e)}async onToolStart(e){await this._persistRunSingle(e)}async onToolEnd(e){await this._updateRunSingle(e)}async onToolError(e){await this._updateRunSingle(e)}}var M=r(7967);class L extends f{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"endpoint",{enumerable:!0,configurable:!0,writable:!0,value:(0,N.lS)("LANGCHAIN_ENDPOINT")||"http://localhost:1984"}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:{"Content-Type":"application/json"}}),Object.defineProperty(this,"session",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const e=(0,N.lS)("LANGCHAIN_API_KEY");e&&(this.headers["x-api-key"]=e)}async newSession(e){const t={start_time:Date.now(),name:e},r=await this.persistSession(t);return this.session=r,r}async loadSession(e){const t=`${this.endpoint}/sessions?name=${e}`;return this._handleSessionResponse(t)}async loadDefaultSession(){const e=`${this.endpoint}/sessions?name=default`;return this._handleSessionResponse(e)}async convertV2RunToRun(e){const t=this.session??await this.loadDefaultSession(),r=e.serialized;let n;if("llm"===e.run_type){const a=e.inputs.prompts?e.inputs.prompts:e.inputs.messages.map((e=>(0,M.zs)(e)));n={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:r,type:e.run_type,session_id:t.id,prompts:a,response:e.outputs}}else if("chain"===e.run_type){const a=await Promise.all(e.child_runs.map((e=>this.convertV2RunToRun(e))));n={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:r,type:e.run_type,session_id:t.id,inputs:e.inputs,outputs:e.outputs,child_llm_runs:a.filter((e=>"llm"===e.type)),child_chain_runs:a.filter((e=>"chain"===e.type)),child_tool_runs:a.filter((e=>"tool"===e.type))}}else{if("tool"!==e.run_type)throw new Error(`Unknown run type: ${e.run_type}`);{const a=await Promise.all(e.child_runs.map((e=>this.convertV2RunToRun(e))));n={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:r,type:e.run_type,session_id:t.id,tool_input:e.inputs.input,output:e.outputs?.output,action:JSON.stringify(r),child_llm_runs:a.filter((e=>"llm"===e.type)),child_chain_runs:a.filter((e=>"chain"===e.type)),child_tool_runs:a.filter((e=>"tool"===e.type))}}}return n}async persistRun(e){let t,r;r=void 0!==e.run_type?await this.convertV2RunToRun(e):e,t="llm"===r.type?`${this.endpoint}/llm-runs`:"chain"===r.type?`${this.endpoint}/chain-runs`:`${this.endpoint}/tool-runs`;const n=await fetch(t,{method:"POST",headers:this.headers,body:JSON.stringify(r)});n.ok||console.error(`Failed to persist run: ${n.status} ${n.statusText}`)}async persistSession(e){const t=`${this.endpoint}/sessions`,r=await fetch(t,{method:"POST",headers:this.headers,body:JSON.stringify(e)});return r.ok?{id:(await r.json()).id,...e}:(console.error(`Failed to persist session: ${r.status} ${r.statusText}, using default session.`),{id:1,...e})}async _handleSessionResponse(e){const t=await fetch(e,{method:"GET",headers:this.headers});let r;if(!t.ok)return console.error(`Failed to load session: ${t.status} ${t.statusText}`),r={id:1,start_time:Date.now()},this.session=r,r;const n=await t.json();return 0===n.length?(r={id:1,start_time:Date.now()},this.session=r,r):([r]=n,this.session=r,r)}}let Z;async function D(e,t){!0===t?await e():(void 0===Z&&(Z=new(0,w.default)({autoStart:!0,concurrency:1})),Z.add(e))}function U(e){return e?Array.isArray(e)||"name"in e?{callbacks:e}:e:{}}class z{setHandler(e){return this.setHandlers([e])}}class ${constructor(e,t,r,n,a,s,i,o){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:o})}async handleText(e){await Promise.all(this.handlers.map((t=>D((async()=>{try{await(t.handleText?.(e,this.runId,this._parentRunId,this.tags))}catch(e){console.error(`Error in handler ${t.constructor.name}, handleText: ${e}`)}}),t.awaitHandlers))))}}class K extends ${getChild(e){const t=new V(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleRetrieverEnd(e){await Promise.all(this.handlers.map((t=>D((async()=>{if(!t.ignoreRetriever)try{await(t.handleRetrieverEnd?.(e,this.runId,this._parentRunId,this.tags))}catch(e){console.error(`Error in handler ${t.constructor.name}, handleRetriever`)}}),t.awaitHandlers))))}async handleRetrieverError(e){await Promise.all(this.handlers.map((t=>D((async()=>{if(!t.ignoreRetriever)try{await(t.handleRetrieverError?.(e,this.runId,this._parentRunId,this.tags))}catch(e){console.error(`Error in handler ${t.constructor.name}, handleRetrieverError: ${e}`)}}),t.awaitHandlers))))}}class F extends ${async handleLLMNewToken(e,t,r,n,a,s){await Promise.all(this.handlers.map((r=>D((async()=>{if(!r.ignoreLLM)try{await(r.handleLLMNewToken?.(e,t??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,s))}catch(e){console.error(`Error in handler ${r.constructor.name}, handleLLMNewToken: ${e}`)}}),r.awaitHandlers))))}async handleLLMError(e){await Promise.all(this.handlers.map((t=>D((async()=>{if(!t.ignoreLLM)try{await(t.handleLLMError?.(e,this.runId,this._parentRunId,this.tags))}catch(e){console.error(`Error in handler ${t.constructor.name}, handleLLMError: ${e}`)}}),t.awaitHandlers))))}async handleLLMEnd(e){await Promise.all(this.handlers.map((t=>D((async()=>{if(!t.ignoreLLM)try{await(t.handleLLMEnd?.(e,this.runId,this._parentRunId,this.tags))}catch(e){console.error(`Error in handler ${t.constructor.name}, handleLLMEnd: ${e}`)}}),t.awaitHandlers))))}}class B extends ${getChild(e){const t=new V(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleChainError(e,t,r,n,a){await Promise.all(this.handlers.map((t=>D((async()=>{if(!t.ignoreChain)try{await(t.handleChainError?.(e,this.runId,this._parentRunId,this.tags,a))}catch(e){console.error(`Error in handler ${t.constructor.name}, handleChainError: ${e}`)}}),t.awaitHandlers))))}async handleChainEnd(e,t,r,n,a){await Promise.all(this.handlers.map((t=>D((async()=>{if(!t.ignoreChain)try{await(t.handleChainEnd?.(e,this.runId,this._parentRunId,this.tags,a))}catch(e){console.error(`Error in handler ${t.constructor.name}, handleChainEnd: ${e}`)}}),t.awaitHandlers))))}async handleAgentAction(e){await Promise.all(this.handlers.map((t=>D((async()=>{if(!t.ignoreAgent)try{await(t.handleAgentAction?.(e,this.runId,this._parentRunId,this.tags))}catch(e){console.error(`Error in handler ${t.constructor.name}, handleAgentAction: ${e}`)}}),t.awaitHandlers))))}async handleAgentEnd(e){await Promise.all(this.handlers.map((t=>D((async()=>{if(!t.ignoreAgent)try{await(t.handleAgentEnd?.(e,this.runId,this._parentRunId,this.tags))}catch(e){console.error(`Error in handler ${t.constructor.name}, handleAgentEnd: ${e}`)}}),t.awaitHandlers))))}}class q extends ${getChild(e){const t=new V(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleToolError(e){await Promise.all(this.handlers.map((t=>D((async()=>{if(!t.ignoreAgent)try{await(t.handleToolError?.(e,this.runId,this._parentRunId,this.tags))}catch(e){console.error(`Error in handler ${t.constructor.name}, handleToolError: ${e}`)}}),t.awaitHandlers))))}async handleToolEnd(e){await Promise.all(this.handlers.map((t=>D((async()=>{if(!t.ignoreAgent)try{await(t.handleToolEnd?.(e,this.runId,this._parentRunId,this.tags))}catch(e){console.error(`Error in handler ${t.constructor.name}, handleToolEnd: ${e}`)}}),t.awaitHandlers))))}}class V extends z{constructor(e){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=[],this.inheritableHandlers=[],this._parentRunId=e}async handleLLMStart(e,t,r=void 0,n=void 0,a=void 0){return Promise.all(t.map((async t=>{const r=c();return await Promise.all(this.handlers.map((n=>D((async()=>{if(!n.ignoreLLM)try{await(n.handleLLMStart?.(e,[t],r,this._parentRunId,a,this.tags,this.metadata))}catch(e){console.error(`Error in handler ${n.constructor.name}, handleLLMStart: ${e}`)}}),n.awaitHandlers)))),new F(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)})))}async handleChatModelStart(e,t,r=void 0,n=void 0,a=void 0){return Promise.all(t.map((async t=>{const r=c();return await Promise.all(this.handlers.map((n=>D((async()=>{if(!n.ignoreLLM)try{if(n.handleChatModelStart)await(n.handleChatModelStart?.(e,[t],r,this._parentRunId,a,this.tags,this.metadata));else if(n.handleLLMStart){const s=(0,M.zs)(t);await(n.handleLLMStart?.(e,[s],r,this._parentRunId,a,this.tags,this.metadata))}}catch(e){console.error(`Error in handler ${n.constructor.name}, handleLLMStart: ${e}`)}}),n.awaitHandlers)))),new F(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)})))}async handleChainStart(e,t,r=c(),n=void 0){return await Promise.all(this.handlers.map((a=>D((async()=>{if(!a.ignoreChain)try{await(a.handleChainStart?.(e,t,r,this._parentRunId,this.tags,this.metadata,n))}catch(e){console.error(`Error in handler ${a.constructor.name}, handleChainStart: ${e}`)}}),a.awaitHandlers)))),new B(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,t,r=c()){return await Promise.all(this.handlers.map((n=>D((async()=>{if(!n.ignoreAgent)try{await(n.handleToolStart?.(e,t,r,this._parentRunId,this.tags,this.metadata))}catch(e){console.error(`Error in handler ${n.constructor.name}, handleToolStart: ${e}`)}}),n.awaitHandlers)))),new q(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,t,r=c(),n=void 0){return await Promise.all(this.handlers.map((n=>D((async()=>{if(!n.ignoreRetriever)try{await(n.handleRetrieverStart?.(e,t,r,this._parentRunId,this.tags,this.metadata))}catch(e){console.error(`Error in handler ${n.constructor.name}, handleRetrieverStart: ${e}`)}}),n.awaitHandlers)))),new K(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}addHandler(e,t=!0){this.handlers.push(e),t&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter((t=>t!==e)),this.inheritableHandlers=this.inheritableHandlers.filter((t=>t!==e))}setHandlers(e,t=!0){this.handlers=[],this.inheritableHandlers=[];for(const r of e)this.addHandler(r,t)}addTags(e,t=!0){this.removeTags(e),this.tags.push(...e),t&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter((t=>!e.includes(t))),this.inheritableTags=this.inheritableTags.filter((t=>!e.includes(t)))}addMetadata(e,t=!0){this.metadata={...this.metadata,...e},t&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const t of Object.keys(e))delete this.metadata[t],delete this.inheritableMetadata[t]}copy(e=[],t=!0){const r=new V(this._parentRunId);for(const e of this.handlers){const t=this.inheritableHandlers.includes(e);r.addHandler(e,t)}for(const e of this.tags){const t=this.inheritableTags.includes(e);r.addTags([e],t)}for(const e of Object.keys(this.metadata)){const t=Object.keys(this.inheritableMetadata).includes(e);r.addMetadata({[e]:this.metadata[e]},t)}for(const n of e)r.handlers.filter((e=>"console_callback_handler"===e.name)).some((e=>e.name===n.name))||r.addHandler(n,t);return r}static fromHandlers(e){const t=new this;return t.addHandler(new class extends d{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:c()}),Object.assign(this,e)}}),t}static async configure(e,t,r,n,a,s,i){let o;(e||t)&&(Array.isArray(e)||!e?(o=new V,o.setHandlers(e?.map(H)??[],!0)):o=e,o=o.copy(Array.isArray(t)?t.map(H):t?.handlers,!1));const c=(0,N.lS)("LANGCHAIN_VERBOSE")||i?.verbose,u="true"===(0,N.lS)("LANGCHAIN_TRACING_V2"),l=u||((0,N.lS)("LANGCHAIN_TRACING")??!1);if(c||l){if(o||(o=new V),c&&!o.handlers.some((e=>e.name===v.prototype.name))){const e=new v;o.addHandler(e,!0)}if(l&&!o.handlers.some((e=>"langchain_tracer"===e.name)))if(u)o.addHandler(await async function(){return new R}(),!0);else{const e=(0,N.lS)("LANGCHAIN_PROJECT")&&(0,N.lS)("LANGCHAIN_SESSION");o.addHandler(await async function(e){const t=new L;return e?await t.loadSession(e):await t.loadDefaultSession(),t}(e),!0)}}return(r||n)&&o&&(o.addTags(r??[]),o.addTags(n??[],!1)),(a||s)&&o&&(o.addMetadata(a??{}),o.addMetadata(s??{},!1)),o}}function H(e){return"name"in e?e:d.fromMethods(e)}},2702:(e,t,r)=>{"use strict";r.d(t,{APIChain:()=>l});var n=r(5641),a=r(3995),s=r(6430);const i="You are given the below API Documentation:\n{api_docs}\nUsing this documentation, generate the full API url to call for answering the user question.\nYou should build the API url in order to get a response that is as short as possible, while still getting the necessary information to answer the question. Pay attention to deliberately exclude any unnecessary pieces of data in the API call.\n\nQuestion:{question}\nAPI url:",o=new s.PromptTemplate({inputVariables:["api_docs","question"],template:i}),c=`${i} {api_url}\n\nHere is the response from the API:\n\n{api_response}\n\nSummarize this response to answer the original question.\n\nSummary:`,u=new s.PromptTemplate({inputVariables:["api_docs","question","api_url","api_response"],template:c});class l extends n.l{get inputKeys(){return[this.inputKey]}get outputKeys(){return[this.outputKey]}constructor(e){super(e),Object.defineProperty(this,"apiAnswerChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiRequestChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiDocs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"question"}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output"}),this.apiRequestChain=e.apiRequestChain,this.apiAnswerChain=e.apiAnswerChain,this.apiDocs=e.apiDocs,this.inputKey=e.inputKey??this.inputKey,this.outputKey=e.outputKey??this.outputKey,this.headers=e.headers??this.headers}async _call(e,t){const r=e[this.inputKey],n=await this.apiRequestChain.predict({question:r,api_docs:this.apiDocs},t?.getChild("request")),a=await fetch(n,{headers:this.headers}),s=await a.text(),i=await this.apiAnswerChain.predict({question:r,api_docs:this.apiDocs,api_url:n,api_response:s},t?.getChild("response"));return{[this.outputKey]:i}}_chainType(){return"api_chain"}static async deserialize(e){const{api_request_chain:t,api_answer_chain:r,api_docs:n}=e;if(!t)throw new Error("LLMChain must have api_request_chain");if(!r)throw new Error("LLMChain must have api_answer_chain");if(!n)throw new Error("LLMChain must have api_docs");return new l({apiAnswerChain:await a.LLMChain.deserialize(r),apiRequestChain:await a.LLMChain.deserialize(t),apiDocs:n})}serialize(){return{_type:this._chainType(),api_answer_chain:this.apiAnswerChain.serialize(),api_request_chain:this.apiRequestChain.serialize(),api_docs:this.apiDocs}}static fromLLMAndAPIDocs(e,t,r={}){const{apiUrlPrompt:n=o,apiResponsePrompt:s=u}=r,i=new a.LLMChain({prompt:n,llm:e});return new this({apiAnswerChain:new a.LLMChain({prompt:s,llm:e}),apiRequestChain:i,apiDocs:t,...r})}}},5641:(e,t,r)=>{"use strict";r.d(t,{l:()=>i});var n=r(6134),a=r(1512),s=r(8610);class i extends s.BD{get lc_namespace(){return["langchain","chains",this._chainType()]}constructor(e,t,r){if(1!==arguments.length||"object"!=typeof e||"saveContext"in e)super({verbose:t,callbacks:r}),this.memory=e;else{const{memory:t,callbackManager:r,...n}=e;super({...n,callbacks:r??n.callbacks}),this.memory=t}}_selectMemoryInputs(e){const t={...e};return"signal"in t&&delete t.signal,"timeout"in t&&delete t.timeout,t}async invoke(e,t){return this.call(e,t)}serialize(){throw new Error("Method not implemented.")}async run(e,t){const r=this.inputKeys.filter((e=>!this.memory?.memoryKeys.includes(e)??!0));if(!(r.length<=1))throw new Error(`Chain ${this._chainType()} expects multiple inputs, cannot use 'run' `);const n=r.length?{[r[0]]:e}:{},a=await this.call(n,t),s=Object.keys(a);if(1===s.length)return a[s[0]];throw new Error("return values have multiple keys, `run` only supported when one key currently")}async _formatValues(e){const t={...e};if(t.timeout&&!t.signal&&(t.signal=AbortSignal.timeout(t.timeout),delete t.timeout),null!=this.memory){const r=await this.memory.loadMemoryVariables(this._selectMemoryInputs(e));for(const[e,n]of Object.entries(r))t[e]=n}return t}async call(e,t,r){const s=await this._formatValues(e),i=(0,a.QH)(t),o=await a.Ye.configure(i.callbacks,this.callbacks,i.tags||r,this.tags,i.metadata,this.metadata,{verbose:this.verbose}),c=await(o?.handleChainStart(this.toJSON(),s));let u;try{u=await(e.signal?Promise.race([this._call(s,c),new Promise(((t,r)=>{e.signal?.addEventListener("abort",(()=>{r(new Error("AbortError"))}))}))]):this._call(s,c))}catch(e){throw await(c?.handleChainError(e)),e}return null!=this.memory&&await this.memory.saveContext(this._selectMemoryInputs(e),u),await(c?.handleChainEnd(u)),Object.defineProperty(u,n.WH,{value:c?{runId:c?.runId}:void 0,configurable:!0}),u}async apply(e,t){return Promise.all(e.map((async(e,r)=>this.call(e,t?.[r]))))}static async deserialize(e,t={}){switch(e._type){case"llm_chain":{const{LLMChain:t}=await Promise.resolve().then(r.bind(r,3995));return t.deserialize(e)}case"sequential_chain":{const{SequentialChain:t}=await Promise.resolve().then(r.bind(r,3685));return t.deserialize(e)}case"simple_sequential_chain":{const{SimpleSequentialChain:t}=await Promise.resolve().then(r.bind(r,3685));return t.deserialize(e)}case"stuff_documents_chain":{const{StuffDocumentsChain:t}=await Promise.resolve().then(r.bind(r,6090));return t.deserialize(e)}case"map_reduce_documents_chain":{const{MapReduceDocumentsChain:t}=await Promise.resolve().then(r.bind(r,6090));return t.deserialize(e)}case"refine_documents_chain":{const{RefineDocumentsChain:t}=await Promise.resolve().then(r.bind(r,6090));return t.deserialize(e)}case"vector_db_qa":{const{VectorDBQAChain:n}=await Promise.resolve().then(r.bind(r,1545));return n.deserialize(e,t)}case"api_chain":{const{APIChain:t}=await Promise.resolve().then(r.bind(r,2702));return t.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}},6090:(e,t,r)=>{"use strict";r.d(t,{MapReduceDocumentsChain:()=>o,RefineDocumentsChain:()=>c,StuffDocumentsChain:()=>i});var n=r(5641),a=r(3995),s=r(6430);class i extends n.l{static lc_name(){return"StuffDocumentsChain"}get inputKeys(){return[this.inputKey,...this.llmChain.inputKeys].filter((e=>e!==this.documentVariableName))}get outputKeys(){return this.llmChain.outputKeys}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),this.llmChain=e.llmChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.inputKey=e.inputKey??this.inputKey}_prepInputs(e){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:t,...r}=e,n=t.map((({pageContent:e})=>e)).join("\n\n");return{...r,[this.documentVariableName]:n}}async _call(e,t){return await this.llmChain.call(this._prepInputs(e),t?.getChild("combine_documents"))}_chainType(){return"stuff_documents_chain"}static async deserialize(e){if(!e.llm_chain)throw new Error("Missing llm_chain");return new i({llmChain:await a.LLMChain.deserialize(e.llm_chain)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize()}}}class o extends n.l{static lc_name(){return"MapReduceDocumentsChain"}get inputKeys(){return[this.inputKey,...this.combineDocumentChain.inputKeys]}get outputKeys(){return this.combineDocumentChain.outputKeys}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),Object.defineProperty(this,"returnIntermediateSteps",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:3e3}),Object.defineProperty(this,"maxIterations",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"ensureMapStep",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"combineDocumentChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmChain=e.llmChain,this.combineDocumentChain=e.combineDocumentChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.ensureMapStep=e.ensureMapStep??this.ensureMapStep,this.inputKey=e.inputKey??this.inputKey,this.maxTokens=e.maxTokens??this.maxTokens,this.maxIterations=e.maxIterations??this.maxIterations,this.returnIntermediateSteps=e.returnIntermediateSteps??!1}async _call(e,t){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:r,...n}=e;let a=r,s=[];for(let e=0;e<this.maxIterations;e+=1){const r=a.map((e=>({[this.documentVariableName]:e.pageContent,...n})));if(0!==e||!this.ensureMapStep){const e=await this.combineDocumentChain.llmChain.prompt.format(this.combineDocumentChain._prepInputs({[this.combineDocumentChain.inputKey]:a,...n}));if(await this.combineDocumentChain.llmChain.llm.getNumTokens(e)<this.maxTokens)break}const i=await this.llmChain.apply(r,t?Array.from({length:r.length},((e,r)=>t.getChild(`map_${r+1}`))):void 0),{outputKey:o}=this.llmChain;this.returnIntermediateSteps&&(s=s.concat(i.map((e=>e[o])))),a=i.map((e=>({pageContent:e[o],metadata:{}})))}const i={[this.combineDocumentChain.inputKey]:a,...n},o=await this.combineDocumentChain.call(i,t?.getChild("combine_documents"));return this.returnIntermediateSteps?{...o,intermediateSteps:s}:o}_chainType(){return"map_reduce_documents_chain"}static async deserialize(e){if(!e.llm_chain)throw new Error("Missing llm_chain");if(!e.combine_document_chain)throw new Error("Missing combine_document_chain");return new o({llmChain:await a.LLMChain.deserialize(e.llm_chain),combineDocumentChain:await i.deserialize(e.combine_document_chain)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize(),combine_document_chain:this.combineDocumentChain.serialize()}}}class c extends n.l{static lc_name(){return"RefineDocumentsChain"}get defaultDocumentPrompt(){return new s.PromptTemplate({inputVariables:["page_content"],template:"{page_content}"})}get inputKeys(){return[...new Set([this.inputKey,...this.llmChain.inputKeys,...this.refineLLMChain.inputKeys])].filter((e=>e!==this.documentVariableName&&e!==this.initialResponseName))}get outputKeys(){return[this.outputKey]}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output_text"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),Object.defineProperty(this,"initialResponseName",{enumerable:!0,configurable:!0,writable:!0,value:"existing_answer"}),Object.defineProperty(this,"refineLLMChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"documentPrompt",{enumerable:!0,configurable:!0,writable:!0,value:this.defaultDocumentPrompt}),this.llmChain=e.llmChain,this.refineLLMChain=e.refineLLMChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.inputKey=e.inputKey??this.inputKey,this.outputKey=e.outputKey??this.outputKey,this.documentPrompt=e.documentPrompt??this.documentPrompt,this.initialResponseName=e.initialResponseName??this.initialResponseName}async _constructInitialInputs(e,t){const r={page_content:e.pageContent,...e.metadata},n={};return this.documentPrompt.inputVariables.forEach((e=>{n[e]=r[e]})),{[this.documentVariableName]:await this.documentPrompt.format({...n}),...t}}async _constructRefineInputs(e,t){const r={page_content:e.pageContent,...e.metadata},n={};this.documentPrompt.inputVariables.forEach((e=>{n[e]=r[e]}));const a={[this.documentVariableName]:await this.documentPrompt.format({...n})};return{[this.initialResponseName]:t,...a}}async _call(e,t){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:r,...n}=e,a=r,s=await this._constructInitialInputs(a[0],n);let i=await this.llmChain.predict({...s},t?.getChild("answer"));const o=[i];for(let e=1;e<a.length;e+=1){const r={...await this._constructRefineInputs(a[e],i),...n};i=await this.refineLLMChain.predict({...r},t?.getChild("refine")),o.push(i)}return{[this.outputKey]:i}}_chainType(){return"refine_documents_chain"}static async deserialize(e){const t=e.llm_chain;if(!t)throw new Error("Missing llm_chain");const r=e.refine_llm_chain;if(!r)throw new Error("Missing refine_llm_chain");return new c({llmChain:await a.LLMChain.deserialize(t),refineLLMChain:await a.LLMChain.deserialize(r)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize(),refine_llm_chain:this.refineLLMChain.serialize()}}}},3995:(e,t,r)=>{"use strict";r.d(t,{LLMChain:()=>c});var n=r(5641),a=r(5962),s=r(8610),i=r(8869);class o extends i.bI{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","default"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"NoOpOutputParser"}parse(e){return Promise.resolve(e)}getFormatInstructions(){return""}}class c extends n.l{static lc_name(){return"LLMChain"}get inputKeys(){return this.prompt.inputVariables}get outputKeys(){return[this.outputKey]}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llmKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"text"}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt,this.llm=e.llm,this.llmKwargs=e.llmKwargs,this.outputKey=e.outputKey??this.outputKey,this.outputParser=e.outputParser??new o,this.prompt.outputParser){if(e.outputParser)throw new Error("Cannot set both outputParser and prompt.outputParser");this.outputParser=this.prompt.outputParser}}_selectMemoryInputs(e){const t=super._selectMemoryInputs(e);for(const r of this.llm.callKeys)r in e&&delete t[r];return t}async _getFinalOutput(e,t,r){let n;return n=this.outputParser?await this.outputParser.parseResultWithPrompt(e,t,r?.getChild()):e[0].text,n}call(e,t){return super.call(e,t)}async _call(e,t){const r={...e},n={...this.llmKwargs};for(const t of this.llm.callKeys)t in e&&(n[t]=e[t],delete r[t]);const a=await this.prompt.formatPromptValue(r),{generations:s}=await this.llm.generatePrompt([a],n,t?.getChild());return{[this.outputKey]:await this._getFinalOutput(s[0],a,t)}}async predict(e,t){return(await this.call(e,t))[this.outputKey]}_chainType(){return"llm"}static async deserialize(e){const{llm:t,prompt:r}=e;if(!t)throw new Error("LLMChain must have llm");if(!r)throw new Error("LLMChain must have prompt");return new c({llm:await s.qV.deserialize(t),prompt:await a.dy.deserialize(r)})}serialize(){return{_type:`${this._chainType()}_chain`,llm:this.llm.serialize(),prompt:this.prompt.serialize()}}}},768:(e,t,r)=>{"use strict";r.d(t,{Xx:()=>w,cf:()=>_});var n=r(3995),a=r(6090),s=r(6430),i=r(2587);class o{async getPromptAsync(e,t){return this.getPrompt(e).partial(t?.partialVariables??{})}}class c extends o{constructor(e,t=[]){super(),Object.defineProperty(this,"defaultPrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"conditionals",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.defaultPrompt=e,this.conditionals=t}getPrompt(e){for(const[t,r]of this.conditionals)if(t(e))return r;return this.defaultPrompt}}function u(e){return"base_chat_model"===e._modelType()}const l=new s.PromptTemplate({template:"Use the following pieces of context to answer the question at the end. If you don't know the answer, just say that you don't know, don't try to make up an answer.\n\n{context}\n\nQuestion: {question}\nHelpful Answer:",inputVariables:["context","question"]}),d=[i.ov.fromTemplate("Use the following pieces of context to answer the users question. \nIf you don't know the answer, just say that you don't know, don't try to make up an answer.\n----------------\n{context}"),i.kq.fromTemplate("{question}")],h=new c(l,[[u,i.ks.fromPromptMessages(d)]]);var p=r(3271);const f=new p.Pf({inputVariables:["question","existing_answer","context"],template:"The original question is as follows: {question}\nWe have provided an existing answer: {existing_answer}\nWe have the opportunity to refine the existing answer\n(only if needed) with some more context below.\n------------\n{context}\n------------\nGiven the new context, refine the original answer to better answer the question. \nIf the context isn't useful, return the original answer."}),m=[p.kq.fromTemplate("{question}"),p.gc.fromTemplate("{existing_answer}"),p.kq.fromTemplate("The original question is as follows: {question}\nWe have provided an existing answer: {existing_answer}\nWe have the opportunity to refine the existing answer\n(only if needed) with some more context below.\n------------\n{context}\n------------\nGiven the new context, refine the original answer to better answer the question. \nIf the context isn't useful, return the original answer.")],g=new c(f,[[u,p.ks.fromPromptMessages(m)]]),y=new p.Pf({inputVariables:["context","question"],template:"Context information is below. \n---------------------\n{context}\n---------------------\nGiven the context information and no prior knowledge, answer the question: {question}"}),b=[p.ov.fromTemplate("Context information is below. \n---------------------\n{context}\n---------------------\nGiven the context information and no prior knowledge, answer any questions"),p.kq.fromTemplate("{question}")],v=new c(y,[[u,p.ks.fromPromptMessages(b)]]);function _(e,t={}){const{prompt:r=h.getPrompt(e),verbose:s}=t,i=new n.LLMChain({prompt:r,llm:e,verbose:s});return new a.StuffDocumentsChain({llmChain:i,verbose:s})}function w(e,t={}){const{questionPrompt:r=v.getPrompt(e),refinePrompt:s=g.getPrompt(e),verbose:i}=t,o=new n.LLMChain({prompt:r,llm:e,verbose:i}),c=new n.LLMChain({prompt:s,llm:e,verbose:i});return new a.RefineDocumentsChain({llmChain:o,refineLLMChain:c,verbose:i})}},3685:(e,t,r)=>{"use strict";r.d(t,{SequentialChain:()=>o,SimpleSequentialChain:()=>c});var n=r(5641);function a(e,t){const r=new Set;for(const n of t)e.has(n)&&r.add(n);return r}function s(e,t){const r=new Set(e);for(const e of t)r.delete(e);return r}function i(e){return Array.from(e).map((e=>`"${e}"`)).join(", ")}class o extends n.l{static lc_name(){return"SequentialChain"}get inputKeys(){return this.inputVariables}get outputKeys(){return this.outputVariables}constructor(e){if(super(e),Object.defineProperty(this,"chains",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnAll",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.chains=e.chains,this.inputVariables=e.inputVariables,this.outputVariables=e.outputVariables??[],this.outputVariables.length>0&&e.returnAll)throw new Error("Either specify variables to return using `outputVariables` or use `returnAll` param. Cannot apply both conditions at the same time.");this.returnAll=e.returnAll??!1,this._validateChains()}_validateChains(){if(0===this.chains.length)throw new Error("Sequential chain must have at least one chain.");const e=this.memory?.memoryKeys??[],t=new Set(this.inputKeys),r=new Set(e),n=a(t,r);if(n.size>0)throw new Error(`The following keys: ${i(n)} are overlapping between memory and input keys of the chain variables. This can lead to unexpected behaviour. Please use input and memory keys that don't overlap.`);const o=function(e,t){const r=new Set(e);for(const e of t)r.add(e);return r}(t,r);for(const e of this.chains){let t=s(new Set(e.inputKeys),o);if(e.memory&&(t=s(t,new Set(e.memory.memoryKeys))),t.size>0)throw new Error(`Missing variables for chain "${e._chainType()}": ${i(t)}. Only got the following variables: ${i(o)}.`);const r=new Set(e.outputKeys),n=a(o,r);if(n.size>0)throw new Error(`The following output variables for chain "${e._chainType()}" are overlapping: ${i(n)}. This can lead to unexpected behaviour.`);for(const e of r)o.add(e)}if(0===this.outputVariables.length)if(this.returnAll){const e=s(o,t);this.outputVariables=Array.from(e)}else this.outputVariables=this.chains[this.chains.length-1].outputKeys;else{const e=s(new Set(this.outputVariables),new Set(o));if(e.size>0)throw new Error(`The following output variables were expected to be in the final chain output but were not found: ${i(e)}.`)}}async _call(e,t){let r={};const n=e;let a=0;for(const e of this.chains){a+=1,r=await e.call(n,t?.getChild(`step_${a}`));for(const e of Object.keys(r))n[e]=r[e]}const s={};for(const e of this.outputVariables)s[e]=n[e];return s}_chainType(){return"sequential_chain"}static async deserialize(e){const t=[],r=e.input_variables,a=e.output_variables,s=e.chains;for(const e of s){const r=await n.l.deserialize(e);t.push(r)}return new o({chains:t,inputVariables:r,outputVariables:a})}serialize(){const e=[];for(const t of this.chains)e.push(t.serialize());return{_type:this._chainType(),input_variables:this.inputVariables,output_variables:this.outputVariables,chains:e}}}class c extends n.l{static lc_name(){return"SimpleSequentialChain"}get inputKeys(){return[this.inputKey]}get outputKeys(){return[this.outputKey]}constructor(e){super(e),Object.defineProperty(this,"chains",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input"}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output"}),Object.defineProperty(this,"trimOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.chains=e.chains,this.trimOutputs=e.trimOutputs??!1,this._validateChains()}_validateChains(){for(const e of this.chains){if(1!==e.inputKeys.filter((t=>!e.memory?.memoryKeys.includes(t)??!0)).length)throw new Error(`Chains used in SimpleSequentialChain should all have one input, got ${e.inputKeys.length} for ${e._chainType()}.`);if(1!==e.outputKeys.length)throw new Error(`Chains used in SimpleSequentialChain should all have one output, got ${e.outputKeys.length} for ${e._chainType()}.`)}}async _call(e,t){let r=e[this.inputKey],n=0;for(const a of this.chains)n+=1,r=(await a.call({[a.inputKeys[0]]:r,signal:e.signal},t?.getChild(`step_${n}`)))[a.outputKeys[0]],this.trimOutputs&&(r=r.trim()),await(t?.handleText(r));return{[this.outputKey]:r}}_chainType(){return"simple_sequential_chain"}static async deserialize(e){const t=[],r=e.chains;for(const e of r){const r=await n.l.deserialize(e);t.push(r)}return new c({chains:t})}serialize(){const e=[];for(const t of this.chains)e.push(t.serialize());return{_type:this._chainType(),chains:e}}}},1545:(e,t,r)=>{"use strict";r.d(t,{VectorDBQAChain:()=>s});var n=r(5641),a=r(768);class s extends n.l{static lc_name(){return"VectorDBQAChain"}get inputKeys(){return[this.inputKey]}get outputKeys(){return this.combineDocumentsChain.outputKeys.concat(this.returnSourceDocuments?["sourceDocuments"]:[])}constructor(e){super(e),Object.defineProperty(this,"k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"query"}),Object.defineProperty(this,"vectorstore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"combineDocumentsChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSourceDocuments",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.vectorstore=e.vectorstore,this.combineDocumentsChain=e.combineDocumentsChain,this.inputKey=e.inputKey??this.inputKey,this.k=e.k??this.k,this.returnSourceDocuments=e.returnSourceDocuments??this.returnSourceDocuments}async _call(e,t){if(!(this.inputKey in e))throw new Error(`Question key ${this.inputKey} not found.`);const r=e[this.inputKey],n=await this.vectorstore.similaritySearch(r,this.k,e.filter,t?.getChild("vectorstore")),a={question:r,input_documents:n},s=await this.combineDocumentsChain.call(a,t?.getChild("combine_documents"));return this.returnSourceDocuments?{...s,sourceDocuments:n}:s}_chainType(){return"vector_db_qa"}static async deserialize(e,t){if(!("vectorstore"in t))throw new Error("Need to pass in a vectorstore to deserialize VectorDBQAChain");const{vectorstore:r}=t;if(!e.combine_documents_chain)throw new Error("VectorDBQAChain must have combine_documents_chain in serialized data");return new s({combineDocumentsChain:await n.l.deserialize(e.combine_documents_chain),k:e.k,vectorstore:r})}serialize(){return{_type:this._chainType(),combine_documents_chain:this.combineDocumentsChain.serialize(),k:this.k}}static fromLLM(e,t,r){return new this({vectorstore:t,combineDocumentsChain:(0,a.cf)(e),...r})}}},4182:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ChatOpenAI:()=>v,PromptLayerChatOpenAI:()=>_});var n=r(5524),a=r(1023),s=r(6134),i=r(8841);function o(e){return{name:e.name,description:e.description,parameters:(0,i.Y_)(e.schema)}}var c=r(566),u=r(3153),l=r(5606),d=r(3551),h=r(1858),p=r(8610),f=r(1512);class m extends p.qV{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]})}_separateRunnableConfigFromCallOptions(e){const[t,r]=super._separateRunnableConfigFromCallOptions(e);return r?.timeout&&!r.signal&&(r.signal=AbortSignal.timeout(r.timeout)),[t,r]}async invoke(e,t){const r=m._convertInputToPromptValue(e);return(await this.generatePrompt([r],t,t?.callbacks)).generations[0][0].message}async*_streamResponseChunks(e,t,r){throw new Error("Not implemented.")}async*_streamIterator(e,t){if(this._streamResponseChunks===m.prototype._streamResponseChunks)yield this.invoke(e,t);else{const r=m._convertInputToPromptValue(e).toChatMessages(),[n,a]=this._separateRunnableConfigFromCallOptions(t),s=await f.Ye.configure(n.callbacks,this.callbacks,n.tags,this.tags,n.metadata,this.metadata,{verbose:this.verbose}),i={options:a,invocation_params:this?.invocationParams(a)},o=await(s?.handleChatModelStart(this.toJSON(),[r],void 0,void 0,i));let c;try{for await(const e of this._streamResponseChunks(r,a,o?.[0]))yield e.message,c=c?c.concat(e):e}catch(e){throw await Promise.all((o??[]).map((t=>t?.handleLLMError(e)))),e}await Promise.all((o??[]).map((e=>e?.handleLLMEnd({generations:[[c]]}))))}}async generate(e,t,r){let n;n=Array.isArray(t)?{stop:t}:t;const[a,i]=this._separateRunnableConfigFromCallOptions(n),o=await f.Ye.configure(a.callbacks??r,this.callbacks,a.tags,this.tags,a.metadata,this.metadata,{verbose:this.verbose}),c={options:i,invocation_params:this?.invocationParams(n)},u=await(o?.handleChatModelStart(this.toJSON(),e,void 0,void 0,c)),l=await Promise.allSettled(e.map(((e,t)=>this._generate(e,{...i,promptIndex:t},u?.[t])))),d=[],h=[];await Promise.all(l.map((async(e,t)=>{if("fulfilled"===e.status){const r=e.value;return d[t]=r.generations,h[t]=r.llmOutput,u?.[t]?.handleLLMEnd({generations:[r.generations],llmOutput:r.llmOutput})}return await(u?.[t]?.handleLLMError(e.reason)),Promise.reject(e.reason)})));const p={generations:d,llmOutput:h.length?this._combineLLMOutput?.(...h):void 0};return Object.defineProperty(p,s.WH,{value:u?{runIds:u?.map((e=>e.runId))}:void 0,configurable:!0}),p}invocationParams(e){return{}}_modelType(){return"base_chat_model"}async generatePrompt(e,t,r){const n=e.map((e=>e.toChatMessages()));return this.generate(n,t,r)}async call(e,t,r){return(await this.generate([e],t,r)).generations[0][0].message}async callPrompt(e,t,r){const n=e.toChatMessages();return this.call(n,t,r)}async predictMessages(e,t,r){return this.call(e,t,r)}async predict(e,t,r){const n=new s.xk(e);return(await this.call([n],t,r)).content}}function g(e){const t=e._getType();switch(t){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"generic":if(!s.J.isInstance(e))throw new Error("Invalid generic chat message");return function(e){return"system"!==e.role&&"assistant"!==e.role&&"user"!==e.role&&"function"!==e.role&&console.warn(`Unknown message role: ${e.role}`),e.role}(e);default:throw new Error(`Unknown message type: ${t}`)}}function y(e){switch(e.role){case"user":return new s.xk(e.content||"");case"assistant":return new s.gY(e.content||"",{function_call:e.function_call});case"system":return new s.jN(e.content||"");default:return new s.J(e.content||"",e.role??"unknown")}}function b(e,t){const r=e.role??t,n=e.content??"";let a;return a=e.function_call?{function_call:e.function_call}:{},"user"===r?new s.ro({content:n}):"assistant"===r?new s.GC({content:n,additional_kwargs:a}):"system"===r?new s.xq({content:n}):"function"===r?new s.Cr({content:n,additional_kwargs:a,name:e.name}):new s.HD({content:n,role:r})}class v extends m{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","promptIndex"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,t){if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=e?.openAIApiKey??(0,l.lS)("OPENAI_API_KEY"),this.azureOpenAIApiKey=e?.azureOpenAIApiKey??(0,l.lS)("AZURE_OPENAI_API_KEY"),!this.azureOpenAIApiKey&&!this.openAIApiKey)throw new Error("OpenAI or Azure OpenAI API key not found");if(this.azureOpenAIApiInstanceName=e?.azureOpenAIApiInstanceName??(0,l.lS)("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=e?.azureOpenAIApiDeploymentName??(0,l.lS)("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=e?.azureOpenAIApiVersion??(0,l.lS)("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=e?.azureOpenAIBasePath??(0,l.lS)("AZURE_OPENAI_BASE_PATH"),this.organization=e?.configuration?.organization??(0,l.lS)("OPENAI_ORGANIZATION"),this.modelName=e?.modelName??this.modelName,this.modelKwargs=e?.modelKwargs??{},this.timeout=e?.timeout,this.temperature=e?.temperature??this.temperature,this.topP=e?.topP??this.topP,this.frequencyPenalty=e?.frequencyPenalty??this.frequencyPenalty,this.presencePenalty=e?.presencePenalty??this.presencePenalty,this.maxTokens=e?.maxTokens,this.n=e?.n??this.n,this.logitBias=e?.logitBias,this.stop=e?.stop,this.user=e?.user,this.streaming=e?.streaming??!1,this.azureOpenAIApiKey){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found")}this.clientConfig={apiKey:this.openAIApiKey,organization:this.organization,...t,...e?.configuration}}invocationParams(e){return{model:this.modelName,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:-1===this.maxTokens?void 0:this.maxTokens,n:this.n,logit_bias:this.logitBias,stop:e?.stop??this.stop,user:this.user,stream:this.streaming,functions:e?.functions??(e?.tools?e?.tools.map(o):void 0),function_call:e?.function_call,...this.modelKwargs}}_identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}async*_streamResponseChunks(e,t,r){const n=e.map((e=>({role:g(e),content:e.content,name:e.name,function_call:e.additional_kwargs.function_call}))),a={...this.invocationParams(t),messages:n,stream:!0};let i="assistant";const o=this.startStream(a,t);for await(const e of o){const t=JSON.parse(e),n=t.choices?.[0];if(!n)continue;const{delta:a}=n,o=b(a,i);i=a.role??i;const c=new s.Ls({message:o,text:o.content});yield c,r?.handleLLMNewToken(c.text??"",{prompt:0,completion:n.index},void 0,void 0,void 0,{chunk:c})}}startStream(e,t){let r=!1;const n=new TransformStream,a=n.writable.getWriter(),s=(0,h.H)(n.readable);let i;return this.completionWithRetry(e,{...t,adapter:c.Z,responseType:"stream",onmessage:e=>{if(!r)if("[DONE]"===e.data?.trim?.())r=!0,a.close();else{const t=JSON.parse(e.data);if(t.error)throw r=!0,t.error;a.write(e.data)}}}).catch((e=>{r||(i=e,r=!0,a.close())})),{async next(){const e=await s.next();if(i)throw i;return e},[Symbol.asyncIterator](){return this}}}identifyingParams(){return this._identifyingParams()}async _generate(e,t,r){const n={},a=this.invocationParams(t),i=e.map((e=>({role:g(e),content:e.content,name:e.name,function_call:e.additional_kwargs.function_call}))),o=a.stream?await new Promise(((e,n)=>{let o,u=!1,l=!1;this.completionWithRetry({...a,messages:i},{signal:t?.signal,...t?.options,adapter:c.Z,responseType:"stream",onmessage:a=>{if("[DONE]"===a.data?.trim?.()){if(l||u)return;l=!0,e(o)}else{const i=JSON.parse(a.data);if(!i.id)return;if(i?.error){if(u)return;return u=!0,void n(i.error)}const c=i;o||(o={id:c.id,object:c.object,created:c.created,model:c.model,choices:[]});for(const e of c.choices??[])if(null!=e){let n=o.choices.find((t=>t.index===e.index));n||(n={index:e.index,finish_reason:e.finish_reason??void 0},o.choices[e.index]=n),n.message||(n.message={role:e.delta?.role,content:""}),e.delta.function_call&&!n.message.function_call&&(n.message.function_call={name:"",arguments:""}),n.message.content+=e.delta?.content??"",n.message.function_call&&(n.message.function_call.name+=e.delta?.function_call?.name??"",n.message.function_call.arguments+=e.delta?.function_call?.arguments??"");const a=b(e.delta,"assistant"),i=new s.Ls({message:a,text:a.content});r?.handleLLMNewToken(e.delta?.content??"",{prompt:t.promptIndex??0,completion:e.index},void 0,void 0,void 0,{chunk:i})}l||u||!c.choices?.every((e=>null!=e.finish_reason))||(l=!0,e(o))}}}).catch((e=>{u||(u=!0,n(e))}))})):await this.completionWithRetry({...a,messages:i},{signal:t?.signal,...t?.options}),{completion_tokens:u,prompt_tokens:l,total_tokens:d}=o.usage??{};u&&(n.completionTokens=(n.completionTokens??0)+u),l&&(n.promptTokens=(n.promptTokens??0)+l),d&&(n.totalTokens=(n.totalTokens??0)+d);const h=[];for(const e of o.choices){const t=e.message?.content??"";h.push({text:t,message:y(e.message??{role:"assistant"})})}return{generations:h,llmOutput:{tokenUsage:n}}}async getNumTokensFromMessages(e){let t=0,r=0,n=0;"gpt-3.5-turbo"===(0,a._i)(this.modelName)?(r=4,n=-1):(0,a._i)(this.modelName).startsWith("gpt-4")&&(r=3,n=1);const s=await Promise.all(e.map((async e=>{const a=await this.getNumTokens(e.content),s=await this.getNumTokens(g(e)),i=void 0!==e.name?n+await this.getNumTokens(e.name):0,o=a+r+s+i;return t+=o,o})));return t+=3,{totalCount:t,countPerMessage:s}}async completionWithRetry(e,t){if(!this.client){const e={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,basePath:this.clientConfig.basePath},t=(0,u.O)(e),r=new n.Configuration({...this.clientConfig,basePath:t,baseOptions:{timeout:this.timeout,...this.clientConfig.baseOptions}});this.client=new n.OpenAIApi(r)}const r={adapter:(0,l.UG)()?void 0:c.Z,...this.clientConfig.baseOptions,...t};return this.azureOpenAIApiKey&&(r.headers={"api-key":this.azureOpenAIApiKey,...r.headers},r.params={"api-version":this.azureOpenAIApiVersion,...r.params}),this.caller.call(this.client.createChatCompletion.bind(this.client),e,r).then((e=>e.data))}_llmType(){return"openai"}_combineLLMOutput(...e){return e.reduce(((e,t)=>(t&&t.tokenUsage&&(e.tokenUsage.completionTokens+=t.tokenUsage.completionTokens??0,e.tokenUsage.promptTokens+=t.tokenUsage.promptTokens??0,e.tokenUsage.totalTokens+=t.tokenUsage.totalTokens??0),e)),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}}class _ extends v{constructor(e){super(e),Object.defineProperty(this,"promptLayerApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"plTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnPromptLayerId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.promptLayerApiKey=e?.promptLayerApiKey??("undefined"!=typeof process?process.env?.PROMPTLAYER_API_KEY:void 0),this.plTags=e?.plTags??[],this.returnPromptLayerId=e?.returnPromptLayerId??!1}async _generate(e,t,r){const n=Date.now();let a;a=Array.isArray(t)?{stop:t}:t?.timeout&&!t.signal?{...t,signal:AbortSignal.timeout(t.timeout)}:t??{};const s=await super._generate(e,a,r),i=Date.now(),o=(e,t)=>{const r={...this.invocationParams(),model:this.modelName};if(t?.stop&&Object.keys(r).includes("stop"))throw new Error("`stop` found in both the input and default params.");return e.map((e=>(e=>{let t;if("human"===e._getType())t={role:"user",content:e.content};else if("ai"===e._getType())t={role:"assistant",content:e.content};else if("function"===e._getType())t={role:"assistant",content:e.content};else if("system"===e._getType())t={role:"system",content:e.content};else{if("generic"!==e._getType())throw new Error(`Got unknown type ${e}`);t={role:e.role,content:e.content}}return t})(e)))};for(let t=0;t<s.generations.length;t+=1){const r=s.generations[t],c=o(e,a);let u;const l=[{content:r.text,role:g(r.message)}],h=await(0,d.r)(this.caller,"langchain.PromptLayerChatOpenAI",c,this._identifyingParams(),this.plTags,l,n,i,this.promptLayerApiKey);!0===this.returnPromptLayerId&&(!0===h.success&&(u=h.request_id),r.generationInfo&&"object"==typeof r.generationInfo||(r.generationInfo={}),r.generationInfo.promptLayerRequestId=u)}return s}}},2776:(e,t,r)=>{"use strict";r.r(t),r.d(t,{OpenAI:()=>x,OpenAIChat:()=>w,PromptLayerOpenAI:()=>P,PromptLayerOpenAIChat:()=>O});var n=r(5524),a=r(1023),s=r(6134),i=r(566),o=r(3153),c=r(4427),u=r(5606),l=r(3551),d=r(1858),h=r(705);const p=(...e)=>h(e.join("_")),f=new Map;class m extends s.H2{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,t){return Promise.resolve(this.cache.get(p(e,t))??null)}async update(e,t,r){this.cache.set(p(e,t),r)}static global(){return new m(f)}}var g=r(8610),y=r(1512),b=r(7967);class v extends g.qV{constructor({cache:e,concurrency:t,...r}){super(t?{maxConcurrency:t,...r}:r),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","llms",this._llmType()]}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache="object"==typeof e?e:e?m.global():void 0}async invoke(e,t){const r=v._convertInputToPromptValue(e);return(await this.generatePrompt([r],t,t?.callbacks)).generations[0][0].text}async*_streamResponseChunks(e,t,r){throw new Error("Not implemented.")}_separateRunnableConfigFromCallOptions(e){const[t,r]=super._separateRunnableConfigFromCallOptions(e);return r?.timeout&&!r.signal&&(r.signal=AbortSignal.timeout(r.timeout)),[t,r]}async*_streamIterator(e,t){if(this._streamResponseChunks===v.prototype._streamResponseChunks)yield this.invoke(e,t);else{const r=v._convertInputToPromptValue(e),[n,a]=this._separateRunnableConfigFromCallOptions(t),i=await y.Ye.configure(n.callbacks,this.callbacks,n.tags,this.tags,n.metadata,this.metadata,{verbose:this.verbose}),o={options:a,invocation_params:this?.invocationParams(a)},c=await(i?.handleLLMStart(this.toJSON(),[r.toString()],void 0,void 0,o));let u=new s.b6({text:""});try{for await(const t of this._streamResponseChunks(e.toString(),a,c?.[0]))u=u?u.concat(t):t,"string"==typeof t.text&&(yield t.text)}catch(e){throw await Promise.all((c??[]).map((t=>t?.handleLLMError(e)))),e}await Promise.all((c??[]).map((e=>e?.handleLLMEnd({generations:[[u]]}))))}}async generatePrompt(e,t,r){const n=e.map((e=>e.toString()));return this.generate(n,t,r)}invocationParams(e){return{}}_flattenLLMResult(e){const t=[];for(let r=0;r<e.generations.length;r+=1){const n=e.generations[r];if(0===r)t.push({generations:[n],llmOutput:e.llmOutput});else{const r=e.llmOutput?{...e.llmOutput,tokenUsage:{}}:void 0;t.push({generations:[n],llmOutput:r})}}return t}async _generateUncached(e,t,r){const n=await y.Ye.configure(r.callbacks,this.callbacks,r.tags,this.tags,r.metadata,this.metadata,{verbose:this.verbose}),a={options:t,invocation_params:this?.invocationParams(t)},i=await(n?.handleLLMStart(this.toJSON(),e,void 0,void 0,a));let o;try{o=await this._generate(e,t,i?.[0])}catch(e){throw await Promise.all((i??[]).map((t=>t?.handleLLMError(e)))),e}const c=this._flattenLLMResult(o);await Promise.all((i??[]).map(((e,t)=>e?.handleLLMEnd(c[t]))));const u=i?.map((e=>e.runId))||void 0;return Object.defineProperty(o,s.WH,{value:u?{runIds:u}:void 0,configurable:!0}),o}async generate(e,t,r){if(!Array.isArray(e))throw new Error("Argument 'prompts' is expected to be a string[]");let n;n=Array.isArray(t)?{stop:t}:t;const[a,s]=this._separateRunnableConfigFromCallOptions(n);if(a.callbacks=a.callbacks??r,!this.cache)return this._generateUncached(e,s,a);const{cache:i}=this,o=this.serialize();o.stop=s.stop??o.stop;const c=`${Object.entries(o).sort()}`,u=[],l=await Promise.all(e.map((async(e,t)=>{const r=await i.lookup(e,c);return r||u.push(t),r})));let d={};if(u.length>0){const t=await this._generateUncached(u.map((t=>e[t])),s,a);await Promise.all(t.generations.map((async(t,r)=>{const n=u[r];return l[n]=t,i.update(e[n],c,t)}))),d=t.llmOutput??{}}return{generations:l,llmOutput:d}}async call(e,t,r){const{generations:n}=await this.generate([e],t,r);return n[0][0].text}async predict(e,t,r){return this.call(e,t,r)}async predictMessages(e,t,r){const n=(0,b.zs)(e),a=await this.call(n,t,r);return new s.gY(a)}_identifyingParams(){return{}}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}_modelType(){return"base_llm"}static async deserialize(e){const{_type:t,_model:n,...a}=e;if(n&&"base_llm"!==n)throw new Error(`Cannot load LLM with model ${n}`);const s={openai:(await Promise.resolve().then(r.bind(r,2776))).OpenAI}[t];if(void 0===s)throw new Error(`Cannot load  LLM with type ${t}`);return new s(a)}}class _ extends v{async _generate(e,t,r){return{generations:await Promise.all(e.map(((e,n)=>this._call(e,{...t,promptIndex:n},r).then((e=>[{text:e}])))))}}}class w extends _{static lc_name(){return"OpenAIChat"}get callKeys(){return[...super.callKeys,"options","promptIndex"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,t){if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"prefixMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=e?.openAIApiKey??(0,u.lS)("OPENAI_API_KEY"),this.azureOpenAIApiKey=e?.azureOpenAIApiKey??(0,u.lS)("AZURE_OPENAI_API_KEY"),!this.azureOpenAIApiKey&&!this.openAIApiKey)throw new Error("OpenAI or Azure OpenAI API key not found");if(this.azureOpenAIApiInstanceName=e?.azureOpenAIApiInstanceName??(0,u.lS)("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=(e?.azureOpenAIApiCompletionsDeploymentName||e?.azureOpenAIApiDeploymentName)??((0,u.lS)("AZURE_OPENAI_API_COMPLETIONS_DEPLOYMENT_NAME")||(0,u.lS)("AZURE_OPENAI_API_DEPLOYMENT_NAME")),this.azureOpenAIApiVersion=e?.azureOpenAIApiVersion??(0,u.lS)("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=e?.azureOpenAIBasePath??(0,u.lS)("AZURE_OPENAI_BASE_PATH"),this.organization=e?.configuration?.organization??(0,u.lS)("OPENAI_ORGANIZATION"),this.modelName=e?.modelName??this.modelName,this.prefixMessages=e?.prefixMessages??this.prefixMessages,this.modelKwargs=e?.modelKwargs??{},this.timeout=e?.timeout,this.temperature=e?.temperature??this.temperature,this.topP=e?.topP??this.topP,this.frequencyPenalty=e?.frequencyPenalty??this.frequencyPenalty,this.presencePenalty=e?.presencePenalty??this.presencePenalty,this.n=e?.n??this.n,this.logitBias=e?.logitBias,this.maxTokens=e?.maxTokens,this.stop=e?.stop,this.user=e?.user,this.streaming=e?.streaming??!1,this.n>1)throw new Error("Cannot use n > 1 in OpenAIChat LLM. Use ChatOpenAI Chat Model instead.");if(this.azureOpenAIApiKey){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found")}this.clientConfig={apiKey:this.openAIApiKey,organization:this.organization,...t,...e?.configuration}}invocationParams(e){return{model:this.modelName,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,n:this.n,logit_bias:this.logitBias,max_tokens:-1===this.maxTokens?void 0:this.maxTokens,stop:e?.stop??this.stop,user:this.user,stream:this.streaming,...this.modelKwargs}}_identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}formatMessages(e){const t={role:"user",content:e};return this.prefixMessages?[...this.prefixMessages,t]:[t]}async*_streamResponseChunks(e,t,r){const n={...this.invocationParams(t),messages:this.formatMessages(e),stream:!0},a=this.startStream(n,t);for await(const e of a){const t=JSON.parse(e),n=t.choices?.[0];if(!n)continue;const{delta:a}=n,i=new s.b6({text:a.content??""});yield i,r?.handleLLMNewToken(i.text??"")}}startStream(e,t){let r=!1;const n=new TransformStream,a=n.writable.getWriter(),s=(0,d.H)(n.readable);let o;return this.completionWithRetry(e,{...t,adapter:i.Z,responseType:"stream",onmessage:e=>{if(!r)if("[DONE]"===e.data?.trim?.())r=!0,a.close();else{const t=JSON.parse(e.data);if(t.error)throw r=!0,t.error;a.write(e.data)}}}).catch((e=>{r||(o=e,r=!0,a.close())})),{async next(){const e=await s.next();if(o)throw o;return e},[Symbol.asyncIterator](){return this}}}async _call(e,t,r){const n=this.invocationParams(t),a=n.stream?await new Promise(((a,s)=>{let o,c=!1,u=!1;this.completionWithRetry({...n,messages:this.formatMessages(e)},{signal:t.signal,...t.options,adapter:i.Z,responseType:"stream",onmessage:e=>{if("[DONE]"===e.data?.trim?.()){if(u||c)return;u=!0,a(o)}else{const n=JSON.parse(e.data);if(n?.error){if(c)return;return c=!0,void s(n.error)}const i=n;o||(o={id:i.id,object:i.object,created:i.created,model:i.model,choices:[]});for(const e of i.choices)if(null!=e){let n=o.choices.find((t=>t.index===e.index));n||(n={index:e.index,finish_reason:e.finish_reason??void 0},o.choices.push(n)),n.message||(n.message={role:e.delta?.role,content:e.delta?.content??""}),n.message.content+=e.delta?.content??"",r?.handleLLMNewToken(e.delta?.content??"",{prompt:t.promptIndex??0,completion:e.index})}u||c||!i.choices.every((e=>null!=e.finish_reason))||(u=!0,a(o))}}}).catch((e=>{c||(c=!0,s(e))}))})):await this.completionWithRetry({...n,messages:this.formatMessages(e)},{signal:t.signal,...t.options});return a.choices[0].message?.content??""}async completionWithRetry(e,t){if(!this.client){const e={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,basePath:this.clientConfig.basePath},t=(0,o.O)(e),r=new n.Configuration({...this.clientConfig,basePath:t,baseOptions:{timeout:this.timeout,...this.clientConfig.baseOptions}});this.client=new n.OpenAIApi(r)}const r={adapter:(0,u.UG)()?void 0:i.Z,...this.clientConfig.baseOptions,...t};return this.azureOpenAIApiKey&&(r.headers={"api-key":this.azureOpenAIApiKey,...r.headers},r.params={"api-version":this.azureOpenAIApiVersion,...r.params}),this.caller.call(this.client.createChatCompletion.bind(this.client),e,r).then((e=>e.data))}_llmType(){return"openai"}}class O extends w{get lc_secrets(){return{promptLayerApiKey:"PROMPTLAYER_API_KEY"}}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"promptLayerApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"plTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnPromptLayerId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.plTags=e?.plTags??[],this.returnPromptLayerId=e?.returnPromptLayerId??!1,this.promptLayerApiKey=e?.promptLayerApiKey??(0,u.lS)("PROMPTLAYER_API_KEY"),!this.promptLayerApiKey)throw new Error("Missing PromptLayer API key")}async completionWithRetry(e,t){return e.stream?super.completionWithRetry(e,t):await super.completionWithRetry(e)}async _generate(e,t,r){let n;return{generations:await Promise.all(e.map((async e=>{const a=Date.now(),s=await this._call(e,t,r),i=Date.now();n=[{text:s}];const o={text:s},c=await(0,l.r)(this.caller,"langchain.PromptLayerOpenAIChat",[e],this._identifyingParams(),this.plTags,o,a,i,this.promptLayerApiKey);return!0===this.returnPromptLayerId&&!0===c.success&&(n[0].generationInfo={promptLayerRequestId:c.request_id}),n})))}}}class x extends v{static lc_name(){return"OpenAI"}get callKeys(){return[...super.callKeys,"options"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,t){if(e?.modelName?.startsWith("gpt-3.5-turbo")||e?.modelName?.startsWith("gpt-4")||e?.modelName?.startsWith("gpt-4-32k"))return new w(e,t);if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:.7}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:256}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"bestOf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"text-davinci-003"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:20}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=e?.openAIApiKey??(0,u.lS)("OPENAI_API_KEY"),this.azureOpenAIApiKey=e?.azureOpenAIApiKey??(0,u.lS)("AZURE_OPENAI_API_KEY"),!this.azureOpenAIApiKey&&!this.openAIApiKey)throw new Error("OpenAI or Azure OpenAI API key not found");if(this.azureOpenAIApiInstanceName=e?.azureOpenAIApiInstanceName??(0,u.lS)("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=(e?.azureOpenAIApiCompletionsDeploymentName||e?.azureOpenAIApiDeploymentName)??((0,u.lS)("AZURE_OPENAI_API_COMPLETIONS_DEPLOYMENT_NAME")||(0,u.lS)("AZURE_OPENAI_API_DEPLOYMENT_NAME")),this.azureOpenAIApiVersion=e?.azureOpenAIApiVersion??(0,u.lS)("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=e?.azureOpenAIBasePath??(0,u.lS)("AZURE_OPENAI_BASE_PATH"),this.organization=e?.configuration?.organization??(0,u.lS)("OPENAI_ORGANIZATION"),this.modelName=e?.modelName??this.modelName,this.modelKwargs=e?.modelKwargs??{},this.batchSize=e?.batchSize??this.batchSize,this.timeout=e?.timeout,this.temperature=e?.temperature??this.temperature,this.maxTokens=e?.maxTokens??this.maxTokens,this.topP=e?.topP??this.topP,this.frequencyPenalty=e?.frequencyPenalty??this.frequencyPenalty,this.presencePenalty=e?.presencePenalty??this.presencePenalty,this.n=e?.n??this.n,this.bestOf=e?.bestOf??this.bestOf,this.logitBias=e?.logitBias,this.stop=e?.stop,this.user=e?.user,this.streaming=e?.streaming??!1,this.streaming&&this.bestOf&&this.bestOf>1)throw new Error("Cannot stream results when bestOf > 1");if(this.azureOpenAIApiKey){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found")}this.clientConfig={apiKey:this.openAIApiKey,organization:this.organization,...t,...e?.configuration}}invocationParams(e){return{model:this.modelName,temperature:this.temperature,max_tokens:this.maxTokens,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,n:this.n,best_of:this.bestOf,logit_bias:this.logitBias,stop:e?.stop??this.stop,user:this.user,stream:this.streaming,...this.modelKwargs}}_identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}identifyingParams(){return this._identifyingParams()}async _generate(e,t,r){const n=(0,c.F)(e,this.batchSize),s=[],o={},u=this.invocationParams(t);if(-1===u.max_tokens){if(1!==e.length)throw new Error("max_tokens set to -1 not supported for multiple inputs");u.max_tokens=await(0,a.F1)({prompt:e[0],modelName:this.modelName})}for(let e=0;e<n.length;e+=1){const a=u.stream?await new Promise(((a,s)=>{const o=[];let c,l=!1,d=!1;this.completionWithRetry({...u,prompt:n[e]},{signal:t.signal,...t.options,adapter:i.Z,responseType:"stream",onmessage:e=>{if("[DONE]"===e.data?.trim?.()){if(d||l)return;d=!0,a({...c,choices:o})}else{const t=JSON.parse(e.data);if(t?.error){if(l)return;return l=!0,void s(t.error)}const n=t;c||(c={id:n.id,object:n.object,created:n.created,model:n.model});for(const e of n.choices)if(null!=e&&null!=e.index){o[e.index]||(o[e.index]={});const t=o[e.index];t.text=(t.text??"")+(e.text??""),t.finish_reason=e.finish_reason,t.logprobs=e.logprobs,r?.handleLLMNewToken(e.text??"",{prompt:Math.floor(e.index/this.n),completion:e.index%this.n})}d||l||!o.every((e=>null!=e.finish_reason))||(d=!0,a({...c,choices:o}))}}}).catch((e=>{l||(l=!0,s(e))}))})):await this.completionWithRetry({...u,prompt:n[e]},{signal:t.signal,...t.options});s.push(...a.choices);const{completion_tokens:c,prompt_tokens:l,total_tokens:d}=a.usage??{};c&&(o.completionTokens=(o.completionTokens??0)+c),l&&(o.promptTokens=(o.promptTokens??0)+l),d&&(o.totalTokens=(o.totalTokens??0)+d)}return{generations:(0,c.F)(s,this.n).map((e=>e.map((e=>({text:e.text??"",generationInfo:{finishReason:e.finish_reason,logprobs:e.logprobs}}))))),llmOutput:{tokenUsage:o}}}async*_streamResponseChunks(e,t,r){const n={...this.invocationParams(t),prompt:e,stream:!0},a=this.startStream(n,t);for await(const e of a){const t=JSON.parse(e),n=t.choices?.[0];if(!n)continue;const a=new s.b6({text:n.text,generationInfo:{finishReason:n.finish_reason,logprobs:n.logprobs}});yield a,r?.handleLLMNewToken(a.text??"")}}startStream(e,t){let r=!1;const n=new TransformStream,a=n.writable.getWriter(),s=(0,d.H)(n.readable);let o;return this.completionWithRetry(e,{...t,adapter:i.Z,responseType:"stream",onmessage:e=>{if(!r)if("[DONE]"===e.data?.trim?.())r=!0,a.close();else{const t=JSON.parse(e.data);if(t.error)throw r=!0,t.error;a.write(e.data)}}}).catch((e=>{r||(o=e,r=!0,a.close())})),{async next(){const e=await s.next();if(o)throw o;return e},[Symbol.asyncIterator](){return this}}}async completionWithRetry(e,t){if(!this.client){const e={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,basePath:this.clientConfig.basePath},t=(0,o.O)(e),r=new n.Configuration({...this.clientConfig,basePath:t,baseOptions:{timeout:this.timeout,...this.clientConfig.baseOptions}});this.client=new n.OpenAIApi(r)}const r={adapter:(0,u.UG)()?void 0:i.Z,...this.clientConfig.baseOptions,...t};return this.azureOpenAIApiKey&&(r.headers={"api-key":this.azureOpenAIApiKey,...r.headers},r.params={"api-version":this.azureOpenAIApiVersion,...r.params}),this.caller.call(this.client.createCompletion.bind(this.client),e,r).then((e=>e.data))}_llmType(){return"openai"}}class P extends x{get lc_secrets(){return{promptLayerApiKey:"PROMPTLAYER_API_KEY"}}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"promptLayerApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"plTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnPromptLayerId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.plTags=e?.plTags??[],this.promptLayerApiKey=e?.promptLayerApiKey??(0,u.lS)("PROMPTLAYER_API_KEY"),this.returnPromptLayerId=e?.returnPromptLayerId,!this.promptLayerApiKey)throw new Error("Missing PromptLayer API key")}async completionWithRetry(e,t){return e.stream?super.completionWithRetry(e,t):await super.completionWithRetry(e)}async _generate(e,t,r){const n=Date.now(),a=await super._generate(e,t,r);for(let t=0;t<a.generations.length;t+=1){const r=Date.now(),s={text:a.generations[t][0].text,llm_output:a.llmOutput},i=await(0,l.r)(this.caller,"langchain.PromptLayerOpenAI",[e[t]],this._identifyingParams(),this.plTags,s,n,r,this.promptLayerApiKey);let o;!0===this.returnPromptLayerId&&(i&&!0===i.success&&(o=i.request_id),a.generations[t][0].generationInfo={...a.generations[t][0].generationInfo,promptLayerRequestId:o})}return a}}},2385:(e,t,r)=>{"use strict";r.d(t,{i:()=>u,j:()=>c});var n=r(2466);function a(e,t){return t?.[e]||n(e)}function s(e,t,r){const n={};for(const a in e)Object.hasOwn(e,a)&&(n[t(a,r)]=e[a]);return n}function i(e){return Array.isArray(e)?[...e]:{...e}}function o(e,t){const r=i(e);for(const[e,n]of Object.entries(t)){const[t,...a]=e.split(".").reverse();let s=r;for(const e of a.reverse()){if(void 0===s[e])break;s[e]=i(s[e]),s=s[e]}void 0!==s[t]&&(s[t]={lc:1,type:"secret",id:[n]})}return r}function c(e){const t=Object.getPrototypeOf(e);return"function"!=typeof e.lc_name||"function"==typeof t.lc_name&&e.lc_name()===t.lc_name()?e.name:e.lc_name()}r(3204);class u{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,c(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}constructor(e,...t){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_kwargs=e||{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof u||"object"!=typeof this.lc_kwargs||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},t={},r=Object.keys(this.lc_kwargs).reduce(((e,t)=>(e[t]=t in this?this[t]:this.lc_kwargs[t],e)),{});for(let n=Object.getPrototypeOf(this);n;n=Object.getPrototypeOf(n))Object.assign(e,Reflect.get(n,"lc_aliases",this)),Object.assign(t,Reflect.get(n,"lc_secrets",this)),Object.assign(r,Reflect.get(n,"lc_attributes",this));for(const e in t)e in this&&void 0!==this[e]&&(r[e]=this[e]||r[e]);return{lc:1,type:"constructor",id:this.lc_id,kwargs:s(Object.keys(t).length?o(r,t):r,a,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}},7967:(e,t,r)=>{"use strict";r.d(t,{d9:()=>s,fF:()=>n,jG:()=>i,zs:()=>o});class n{}const a=(e,t)=>{if(void 0!==t)return e[t];const r=Object.keys(e);return 1===r.length?e[r[0]]:void 0},s=(e,t)=>{const r=a(e,t);if(!r){const t=Object.keys(e);throw new Error(`input values have ${t.length} keys, you must specify an input key or pass only 1 key as input`)}return r},i=(e,t)=>{const r=a(e,t);if(!r){const t=Object.keys(e);throw new Error(`output values have ${t.length} keys, you must specify an output key or pass only 1 key as output`)}return r};function o(e,t="Human",r="AI"){const n=[];for(const a of e){let e;if("human"===a._getType())e=t;else if("ai"===a._getType())e=r;else if("system"===a._getType())e="System";else if("function"===a._getType())e="Function";else{if("generic"!==a._getType())throw new Error(`Got unsupported message type: ${a}`);e=a.role}const s=a.name?`${a.name}, `:"";n.push(`${e}: ${s}${a.content}`)}return n.join("\n")}},5962:(e,t,r)=>{"use strict";r.d(t,{Al:()=>o,dy:()=>i,nw:()=>s});var n=r(6134),a=(r(2385),r(0));class s extends n.MJ{constructor(e){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","base"]}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new n.xk(this.value)]}}class i extends a.eq{get lc_attributes(){return{partialVariables:void 0}}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{inputVariables:t}=e;if(t.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,e)}async mergePartialAndUserVariables(e){const t=this.partialVariables??{},r={};for(const[e,n]of Object.entries(t))r[e]="string"==typeof n?n:await n();return{...r,...e}}async invoke(e,t){return this._callWithConfig((e=>this.formatPromptValue(e)),e,{...t,runType:"prompt"})}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(e){switch(e._type){case"prompt":{const{PromptTemplate:t}=await Promise.resolve().then(r.bind(r,6430));return t.deserialize(e)}case void 0:{const{PromptTemplate:t}=await Promise.resolve().then(r.bind(r,6430));return t.deserialize({...e,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:t}=await Promise.resolve().then(r.bind(r,2832));return t.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}class o extends i{async formatPromptValue(e){const t=await this.format(e);return new s(t)}}},2587:(e,t,r)=>{"use strict";r.d(t,{GU:()=>c,gc:()=>h,kq:()=>d,ks:()=>f,ov:()=>p});var n=r(6134),a=r(0),s=r(5962),i=r(6430);class o extends a.eq{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}async invoke(e,t){return this._callWithConfig((e=>this.formatMessages(e)),e,{...t,runType:"prompt"})}}class c extends n.MJ{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return JSON.stringify(this.messages)}toChatMessages(){return this.messages}}class u extends o{constructor(e){"prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt}get inputVariables(){return this.prompt.inputVariables}async formatMessages(e){return[await this.format(e)]}}class l extends s.dy{constructor(e){super(e)}async format(e){return(await this.formatPromptValue(e)).toString()}async formatPromptValue(e){const t=await this.formatMessages(e);return new c(t)}}class d extends u{static lc_name(){return"HumanMessagePromptTemplate"}async format(e){return new n.xk(await this.prompt.format(e))}static fromTemplate(e){return new this(i.PromptTemplate.fromTemplate(e))}}class h extends u{static lc_name(){return"AIMessagePromptTemplate"}async format(e){return new n.gY(await this.prompt.format(e))}static fromTemplate(e){return new this(i.PromptTemplate.fromTemplate(e))}}class p extends u{static lc_name(){return"SystemMessagePromptTemplate"}async format(e){return new n.jN(await this.prompt.format(e))}static fromTemplate(e){return new this(i.PromptTemplate.fromTemplate(e))}}class f extends l{static lc_name(){return"ChatPromptTemplate"}get lc_aliases(){return{promptMessages:"messages"}}constructor(e){if(super(e),Object.defineProperty(this,"promptMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.assign(this,e),this.validateTemplate){const e=new Set;for(const t of this.promptMessages)for(const r of t.inputVariables)e.add(r);const t=this.inputVariables,r=new Set(this.partialVariables?t.concat(Object.keys(this.partialVariables)):t),n=new Set([...r].filter((t=>!e.has(t))));if(n.size>0)throw new Error(`Input variables \`${[...n]}\` are not used in any of the prompt messages.`);const a=new Set([...e].filter((e=>!r.has(e))));if(a.size>0)throw new Error(`Input variables \`${[...a]}\` are used in prompt messages but not in the prompt template.`)}}_getPromptType(){return"chat"}async formatMessages(e){const t=await this.mergePartialAndUserVariables(e);let r=[];for(const e of this.promptMessages){const n=e.inputVariables.reduce(((e,r)=>{if(!(r in t))throw new Error(`Missing value for input variable \`${r.toString()}\``);return e[r]=t[r],e}),{}),a=await e.formatMessages(n);r=r.concat(a)}return r}async partial(e){const t=this.inputVariables.filter((t=>!(t in e))),r={...this.partialVariables??{},...e},n={...this,inputVariables:t,partialVariables:r};return new f(n)}static fromPromptMessages(e){const t=e.reduce(((e,t)=>e.concat(t instanceof f?t.promptMessages:[t])),[]),r=e.reduce(((e,t)=>t instanceof f?Object.assign(e,t.partialVariables):e),Object.create(null)),n=new Set;for(const e of t)for(const t of e.inputVariables)t in r||n.add(t);return new f({inputVariables:[...n],promptMessages:t,partialVariables:r})}}},2832:(e,t,r)=>{"use strict";r.d(t,{FewShotPromptTemplate:()=>i});var n=r(5962),a=r(5738),s=r(6430);class i extends n.Al{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"examples",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleSelector",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"examplePrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"suffix",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"exampleSeparator",{enumerable:!0,configurable:!0,writable:!0,value:"\n\n"}),Object.defineProperty(this,"prefix",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.assign(this,e),void 0!==this.examples&&void 0!==this.exampleSelector)throw new Error("Only one of 'examples' and 'example_selector' should be provided");if(void 0===this.examples&&void 0===this.exampleSelector)throw new Error("One of 'examples' and 'example_selector' should be provided");if(this.validateTemplate){let e=this.inputVariables;this.partialVariables&&(e=e.concat(Object.keys(this.partialVariables))),(0,a.af)(this.prefix+this.suffix,this.templateFormat,e)}}_getPromptType(){return"few_shot"}async getExamples(e){if(void 0!==this.examples)return this.examples;if(void 0!==this.exampleSelector)return this.exampleSelector.selectExamples(e);throw new Error("One of 'examples' and 'example_selector' should be provided")}async partial(e){const t=this.inputVariables.filter((t=>!(t in e))),r={...this.partialVariables??{},...e},n={...this,inputVariables:t,partialVariables:r};return new i(n)}async format(e){const t=await this.mergePartialAndUserVariables(e),r=await this.getExamples(t),n=await Promise.all(r.map((e=>this.examplePrompt.format(e)))),s=[this.prefix,...n,this.suffix].join(this.exampleSeparator);return(0,a.SM)(s,this.templateFormat,t)}serialize(){if(this.exampleSelector||!this.examples)throw new Error("Serializing an example selector is not currently supported");if(void 0!==this.outputParser)throw new Error("Serializing an output parser is not currently supported");return{_type:this._getPromptType(),input_variables:this.inputVariables,example_prompt:this.examplePrompt.serialize(),example_separator:this.exampleSeparator,suffix:this.suffix,prefix:this.prefix,template_format:this.templateFormat,examples:this.examples}}static async deserialize(e){const{example_prompt:t}=e;if(!t)throw new Error("Missing example prompt");const r=await s.PromptTemplate.deserialize(t);let n;if(!Array.isArray(e.examples))throw new Error("Invalid examples format. Only list or string are supported.");return n=e.examples,new i({inputVariables:e.input_variables,examplePrompt:r,examples:n,exampleSeparator:e.example_separator,prefix:e.prefix,suffix:e.suffix,templateFormat:e.template_format})}}},3271:(e,t,r)=>{"use strict";r.d(t,{gc:()=>a.gc,ks:()=>a.ks,kq:()=>a.kq,Pf:()=>n.PromptTemplate,ov:()=>a.ov}),r(5962);var n=r(6430);r(2832);var a=r(2587);r(5738)},6430:(e,t,r)=>{"use strict";r.d(t,{PromptTemplate:()=>s});var n=r(5962),a=r(5738);class s extends n.Al{static lc_name(){return"PromptTemplate"}constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.assign(this,e),this.validateTemplate){let e=this.inputVariables;this.partialVariables&&(e=e.concat(Object.keys(this.partialVariables))),(0,a.af)(this.template,this.templateFormat,e)}}_getPromptType(){return"prompt"}async format(e){const t=await this.mergePartialAndUserVariables(e);return(0,a.SM)(this.template,this.templateFormat,t)}static fromExamples(e,t,r,n="\n\n",a=""){const i=[a,...e,t].join(n);return new s({inputVariables:r,template:i})}static fromTemplate(e,{templateFormat:t="f-string",...r}={}){if("jinja2"===t)throw new Error("jinja2 templates are not currently supported.");const n=new Set;return(0,a.$M)(e,t).forEach((e=>{"variable"===e.type&&n.add(e.name)})),new s({inputVariables:[...n],templateFormat:t,template:e,...r})}async partial(e){const t=this.inputVariables.filter((t=>!(t in e))),r={...this.partialVariables??{},...e},n={...this,inputVariables:t,partialVariables:r};return new s(n)}serialize(){if(void 0!==this.outputParser)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new s({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}}},5738:(e,t,r)=>{"use strict";r.d(t,{$M:()=>o,SM:()=>i,af:()=>c});const n=e=>{const t=e.split(""),r=[],n=(e,r)=>{for(let n=r;n<t.length;n+=1)if(e.includes(t[n]))return n;return-1};let a=0;for(;a<t.length;)if("{"===t[a]&&a+1<t.length&&"{"===t[a+1])r.push({type:"literal",text:"{"}),a+=2;else if("}"===t[a]&&a+1<t.length&&"}"===t[a+1])r.push({type:"literal",text:"}"}),a+=2;else if("{"===t[a]){const e=n("}",a);if(e<0)throw new Error("Unclosed '{' in template.");r.push({type:"variable",name:t.slice(a+1,e).join("")}),a=e+1}else{if("}"===t[a])throw new Error("Single '}' in template.");{const e=n("{}",a),s=(e<0?t.slice(a):t.slice(a,e)).join("");r.push({type:"literal",text:s}),a=e<0?t.length:e}}return r},a={"f-string":(e,t)=>n(e).reduce(((e,r)=>{if("variable"===r.type){if(r.name in t)return e+t[r.name];throw new Error(`Missing value for input ${r.name}`)}return e+r.text}),""),jinja2:(e,t)=>""},s={"f-string":n,jinja2:e=>[]},i=(e,t,r)=>a[t](e,r),o=(e,t)=>s[t](e),c=(e,t,r)=>{if(!(t in a)){const e=Object.keys(a);throw new Error(`Invalid template format. Got \`${t}\`;\n                         should be one of ${e}`)}try{const n=r.reduce(((e,t)=>(e[t]="foo",e)),{});i(e,t,n)}catch(e){throw new Error(`Invalid prompt schema: ${e.message}`)}}},6134:(e,t,r)=>{"use strict";r.d(t,{Cr:()=>f,GC:()=>d,H2:()=>_,HD:()=>g,J:()=>m,Ls:()=>y,MJ:()=>b,WH:()=>a,b6:()=>s,gY:()=>l,jN:()=>h,oV:()=>v,ro:()=>u,xk:()=>c,xq:()=>p});var n=r(2385);const a="__run";class s{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new s({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}class i extends n.i{get text(){return this.content}constructor(e,t){"string"==typeof e&&(e={content:e,additional_kwargs:t}),e.additional_kwargs||(e.additional_kwargs={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","schema"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}}class o extends i{static _mergeAdditionalKwargs(e,t){const r={...e};for(const[e,n]of Object.entries(t))if(void 0===r[e])r[e]=n;else{if(typeof r[e]!=typeof n)throw new Error(`additional_kwargs[${e}] already exists in the message chunk, but with a different type.`);if("string"==typeof r[e])r[e]=r[e]+n;else{if(Array.isArray(r[e])||"object"!=typeof r[e])throw new Error(`additional_kwargs[${e}] already exists in this message chunk.`);r[e]=this._mergeAdditionalKwargs(r[e],n)}}return r}}class c extends i{static lc_name(){return"HumanMessage"}_getType(){return"human"}}class u extends o{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}concat(e){return new u({content:this.content+e.content,additional_kwargs:u._mergeAdditionalKwargs(this.additional_kwargs,e.additional_kwargs)})}}class l extends i{static lc_name(){return"AIMessage"}_getType(){return"ai"}}class d extends o{static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}concat(e){return new d({content:this.content+e.content,additional_kwargs:d._mergeAdditionalKwargs(this.additional_kwargs,e.additional_kwargs)})}}class h extends i{static lc_name(){return"SystemMessage"}_getType(){return"system"}}class p extends o{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}concat(e){return new p({content:this.content+e.content,additional_kwargs:p._mergeAdditionalKwargs(this.additional_kwargs,e.additional_kwargs)})}}class f extends o{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(e){return new f({content:this.content+e.content,additional_kwargs:f._mergeAdditionalKwargs(this.additional_kwargs,e.additional_kwargs),name:this.name??""})}}class m extends i{static lc_name(){return"ChatMessage"}constructor(e,t){"string"==typeof e&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return"generic"===e._getType()}}class g extends o{static lc_name(){return"ChatMessageChunk"}constructor(e,t){"string"==typeof e&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}concat(e){return new g({content:this.content+e.content,additional_kwargs:g._mergeAdditionalKwargs(this.additional_kwargs,e.additional_kwargs),role:this.role})}}class y extends s{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new y({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}class b extends n.i{}class v extends n.i{addUserMessage(e){return this.addMessage(new c(e))}addAIChatMessage(e){return this.addMessage(new l(e))}}class _{}},8869:(e,t,r)=>{"use strict";r.d(t,{bI:()=>s,dS:()=>i});var n=r(0);class a extends n.eq{parseResultWithPrompt(e,t,r){return this.parseResult(e,r)}async invoke(e,t){return"string"==typeof e?this._callWithConfig((async e=>this.parseResult([{text:e}])),e,{...t,runType:"parser"}):this._callWithConfig((async e=>this.parseResult([{message:e,text:e.content}])),e,{...t,runType:"parser"})}}class s extends a{parseResult(e,t){return this.parse(e[0].text,t)}async parseWithPrompt(e,t,r){return this.parse(e,r)}_type(){throw new Error("_type not implemented")}}class i extends Error{constructor(e,t){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=t}}},0:(e,t,r)=>{"use strict";r.d(t,{eq:()=>o});var n=r(1512),a=r(2385),s=r(1858);function i(e,t){return e&&!Array.isArray(e)&&"object"==typeof e?e:{[t]:e}}class o extends a.i{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}bind(e){return new d({bound:this,kwargs:e})}withFallbacks(e){return new h({runnable:this,fallbacks:e.fallbacks})}_getOptionsList(e,t=0){if(Array.isArray(e)){if(e.length!==t)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${t} inputs`);return e}return Array.from({length:t},(()=>e))}async batch(e,t,r){const n=this._getOptionsList(t??{},e.length),a=r?.maxConcurrency&&r.maxConcurrency>0?r?.maxConcurrency:e.length,s=[];for(let t=0;t<e.length;t+=a){const r=e.slice(t,t+a).map(((e,t)=>this.invoke(e,n[t]))),i=await Promise.all(r);s.push(i)}return s.flat()}async*_streamIterator(e,t){yield this.invoke(e,t)}async stream(e,t){return s.Q.fromAsyncGenerator(this._streamIterator(e,t))}_separateRunnableConfigFromCallOptions(e={}){const t={callbacks:e.callbacks,tags:e.tags,metadata:e.metadata},r={...e};return delete r.callbacks,delete r.tags,delete r.metadata,[t,r]}async _callWithConfig(e,t,r){const a=await n.Ye.configure(r?.callbacks,void 0,r?.tags,void 0,r?.metadata),s=await(a?.handleChainStart(this.toJSON(),i(t,"input"),void 0,r?.runType));let o;try{o=await e.bind(this)(t)}catch(e){throw await(s?.handleChainError(e)),e}return await(s?.handleChainEnd(i(o,"output"))),o}async*_transformStreamWithConfig(e,t,r){let a,s,o=!0,c=!0;const u=await n.Ye.configure(r?.callbacks,void 0,r?.tags,void 0,r?.metadata);let l;const d=this.toJSON(),h=async function*(){for await(const t of e){if(l||(l=await(u?.handleChainStart(d,{input:""},void 0,r?.runType))),o)if(void 0===a)a=t;else try{a=a.concat(t)}catch{a=void 0,o=!1}yield t}}();try{const e=t(h,l,r);for await(const t of e)if(yield t,c)if(void 0===s)s=t;else try{s=s.concat(t)}catch{s=void 0,c=!1}}catch(e){throw await(l?.handleChainError(e,void 0,void 0,void 0,{inputs:i(a,"input")})),e}await(l?.handleChainEnd(s??{},void 0,void 0,void 0,{inputs:i(a,"input")}))}_patchConfig(e={},t=void 0){return{...e,callbacks:t}}pipe(e){return new c({first:this,last:p(e)})}static isRunnable(e){return e.lc_runnable}}class c extends o{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","schema","runnable"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,t){const r=await n.Ye.configure(t?.callbacks,void 0,t?.tags,void 0,t?.metadata),a=await(r?.handleChainStart(this.toJSON(),i(e,"input")));let s,o=e;try{for(const e of[this.first,...this.middle])o=await e.invoke(o,this._patchConfig(t,a?.getChild()));s=await this.last.invoke(o,this._patchConfig(t,a?.getChild()))}catch(e){throw await(a?.handleChainError(e)),e}return await(a?.handleChainEnd(i(s,"output"))),s}async batch(e,t,r){const a=this._getOptionsList(t??{},e.length),s=await Promise.all(a.map((e=>n.Ye.configure(e?.callbacks,void 0,e?.tags,void 0,e?.metadata)))),o=await Promise.all(s.map(((t,r)=>t?.handleChainStart(this.toJSON(),i(e[r],"input")))));let c,u=e;try{for(let e=0;e<[this.first,...this.middle].length;e+=1){const t=this.steps[e];u=await t.batch(u,o.map(((e,t)=>this._patchConfig(a[t],e?.getChild()))),r)}c=await this.last.batch(u,o.map((e=>this._patchConfig(a[this.steps.length-1],e?.getChild()))),r)}catch(e){throw await Promise.all(o.map((t=>t?.handleChainError(e)))),e}return await Promise.all(o.map(((e,t)=>e?.handleChainEnd(i(c[t],"output"))))),c}async*_streamIterator(e,t){const r=await n.Ye.configure(t?.callbacks,void 0,t?.tags,void 0,t?.metadata),a=await(r?.handleChainStart(this.toJSON(),i(e,"input")));let s=e;const o=[this.first,...this.middle,this.last],c=o.length-[...o].reverse().findIndex((e=>"function"!=typeof e.transform))-1;try{for(const e of o.slice(0,c))s=await e.invoke(s,this._patchConfig(t,a?.getChild()))}catch(e){throw await(a?.handleChainError(e)),e}let u,l=!0;try{let e=await o[c]._streamIterator(s,this._patchConfig(t,a?.getChild()));for(const r of o.slice(c+1))e=await r.transform(e,this._patchConfig(t,a?.getChild()));for await(const t of e)if(yield t,l)if(void 0===u)u=t;else try{u=u.concat(t)}catch(e){u=void 0,l=!1}}catch(e){throw await(a?.handleChainError(e)),e}await(a?.handleChainEnd(i(u,"output")))}pipe(e){return c.isRunnableSequence(e)?new c({first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last}):new c({first:this.first,middle:[...this.middle,this.last],last:p(e)})}static isRunnableSequence(e){return Array.isArray(e.middle)&&o.isRunnable(e)}static from([e,...t]){return new c({first:p(e),middle:t.slice(0,-1).map(p),last:p(t[t.length-1])})}}class u extends o{static lc_name(){return"RunnableMap"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","schema","runnable"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(const[t,r]of Object.entries(e.steps))this.steps[t]=p(r)}async invoke(e,t){const r=await n.Ye.configure(t?.callbacks,void 0,t?.tags,void 0,t?.metadata),a=await(r?.handleChainStart(this.toJSON(),{input:e})),s={};try{for(const[r,n]of Object.entries(this.steps)){const i=await n.invoke(e,this._patchConfig(t,a?.getChild()));s[r]=i}}catch(e){throw await(a?.handleChainError(e)),e}return await(a?.handleChainEnd(s)),s}}class l extends o{static lc_name(){return"RunnableLambda"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","schema","runnable"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.func=e.func}async invoke(e,t){return this._callWithConfig((async e=>this.func(e)),e,t)}}class d extends o{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","schema","runnable"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs}bind(e){return new d({bound:this.bound,kwargs:{...this.kwargs,...e}})}async invoke(e,t){return this.bound.invoke(e,{...t,...this.kwargs})}async batch(e,t,r){const n=Array.isArray(t)?t.map((e=>({...e,...this.kwargs}))):{...t,...this.kwargs};return this.bound.batch(e,n,r)}async stream(e,t){return this.bound.stream(e,{...t,...this.kwargs})}}class h extends o{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","schema","runnable"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,t){const r=await n.Ye.configure(t?.callbacks,void 0,t?.tags,void 0,t?.metadata),a=await(r?.handleChainStart(this.toJSON(),i(e,"input")));let s;for(const r of this.runnables())try{const n=await r.invoke(e,this._patchConfig(t,a?.getChild()));return await(a?.handleChainEnd(i(n,"output"))),n}catch(e){void 0===s&&(s=e)}if(void 0===s)throw new Error("No error stored at end of fallback.");throw await(a?.handleChainError(s)),s}async batch(e,t,r){const a=this._getOptionsList(t??{},e.length),s=await Promise.all(a.map((e=>n.Ye.configure(e?.callbacks,void 0,e?.tags,void 0,e?.metadata)))),o=await Promise.all(s.map(((t,r)=>t?.handleChainStart(this.toJSON(),i(e[r],"input")))));let c;for(const t of this.runnables())try{const n=await t.batch(e,o.map(((e,t)=>this._patchConfig(a[t],e?.getChild()))),r);return await Promise.all(o.map(((e,t)=>e?.handleChainEnd(i(n[t],"output"))))),n}catch(e){void 0===c&&(c=e)}if(!c)throw new Error("No error stored at end of fallbacks.");throw await Promise.all(o.map((e=>e?.handleChainError(c)))),c}}function p(e){if("function"==typeof e)return new l({func:e});if(o.isRunnable(e))return e;if(Array.isArray(e)||"object"!=typeof e)throw new Error("Expected a Runnable, function or object.\nInstead got an unsupported type.");{const t={};for(const[r,n]of Object.entries(e))t[r]=p(n);return new u({steps:t})}}},803:(e,t,r)=>{"use strict";r.d(t,{L:()=>i});var n=r(2693),a=r(5860);const s=[400,401,403,404,405,406,407,408,409];class i{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6;const t=a.default;this.queue=new t({concurrency:this.maxConcurrency})}call(e,...t){return this.queue.add((()=>n((()=>e(...t).catch((e=>{throw e instanceof Error?e:new Error(e)}))),{onFailedAttempt(e){if(e.message.startsWith("Cancel")||e.message.startsWith("TimeoutError")||e.message.startsWith("AbortError"))throw e;if("ECONNABORTED"===e?.code)throw e;const t=e?.response?.status;if(t&&s.includes(+t))throw e;const r=e?.response?.data;if("insufficient_quota"===r?.error?.code){const e=new Error(r?.error?.message);throw e.name="InsufficientQuotaError",e}},retries:this.maxRetries,randomize:!0})),{throwOnTimeout:!0})}callWithOptions(e,t,...r){return e.signal?Promise.race([this.call(t,...r),new Promise(((t,r)=>{e.signal?.addEventListener("abort",(()=>{r(new Error("AbortError"))}))}))]):this.call(t,...r)}fetch(...e){return this.call((()=>fetch(...e).then((e=>e.ok?e:Promise.reject(e)))))}}},566:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(9669);const a="text/event-stream";function s(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function i(e){return Array.isArray(e)}function o(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),i(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.call(null,e[a],a,e)}async function c(e){const t=function(e){const t=new Headers(e.headers);if(e.auth){const r=e.auth.username||"",n=e.auth.password?decodeURI(encodeURIComponent(e.auth.password)):"";t.set("Authorization",`Basic ${btoa(`${r}:${n}`)}`)}const r=e.method.toUpperCase(),n={headers:t,method:r};var c;"GET"!==r&&"HEAD"!==r&&(n.body=e.data,c=n.body,"[object FormData]"===toString.call(c)&&("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document&&t.delete("Content-Type")),"string"==typeof n.body&&(n.body=(new TextEncoder).encode(n.body)),e.mode&&(n.mode=e.mode),e.cache&&(n.cache=e.cache),e.integrity&&(n.integrity=e.integrity),e.redirect&&(n.redirect=e.redirect),e.referrer&&(n.referrer=e.referrer),e.timeout&&e.timeout>0&&(n.signal=AbortSignal.timeout(e.timeout)),e.signal&&(n.signal=e.signal),function(e){return void 0===e}(e.withCredentials)||(n.credentials=e.withCredentials?"include":"omit"),"stream"===e.responseType&&n.headers.set("Accept",a);const u=function(e,t,r){if(!t)return e;var n,a;if(r)n=r(t);else if(a=t,"[object URLSearchParams]"===toString.call(a))n=t.toString();else{var c=[];o(t,(function(e,t){null!=e&&(i(e)?t=`${t}[]`:e=[e],o(e,(function(e){!function(e){return"[object Date]"===toString.call(e)}(e)?function(e){return null!==e&&"object"==typeof e}(e)&&(e=JSON.stringify(e)):e=e.toISOString(),c.push(`${s(t)}=${s(e)}`)})))})),n=c.join("&")}if(n){var u=e.indexOf("#");-1!==u&&(e=e.slice(0,u)),e+=(-1===e.indexOf("?")?"?":"&")+n}return e}((l=e.baseURL,d=e.url,l&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(d)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(l,d):d),e.params,e.paramsSerializer);var l,d;return new Request(u,n)}(e),r=await async function(e,t){let r;try{r=await fetch(e)}catch(r){return r&&"AbortError"===r.name?u("Request aborted",t,"ECONNABORTED",e):r&&"TimeoutError"===r.name?u("Request timeout",t,"ECONNABORTED",e):u("Network Error",t,"ERR_NETWORK",e)}const n={};r.headers.forEach(((e,t)=>{n[t]=e}));const s={ok:r.ok,status:r.status,statusText:r.statusText,headers:n,config:t,request:e};if(r.status>=200&&204!==r.status)if("stream"===t.responseType){const e=r.headers.get("content-type");if(!e?.startsWith(a)){if(r.status>=400)return e?.startsWith("application/json")?(s.data=await r.json(),s):(s.data=await r.text(),s);throw new Error(`Expected content-type to be ${a}, Actual: ${e}`)}await async function(e,t){if(null!=(r=e)&&"object"==typeof r&&"on"in r)return new Promise((r=>{e.on("readable",(()=>{let n;for(;;){if(n=e.read(),null==n){t(new Uint8Array,!0);break}t(n)}r()}))}));var r;const n=e.getReader();for(;;){const e=await n.read();if(e.done){t(new Uint8Array,!0);break}t(e.value)}}(r.body,function(e){let t,r,n,a=!1;return function(s,i){if(i)return void e(s,0,!0);void 0===t?(t=s,r=0,n=-1):t=function(e,t){const r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}(t,s);const o=t.length;let c=0;for(;r<o;){a&&(10===t[r]&&(c=++r),a=!1);let s=-1;for(;r<o&&-1===s;++r)switch(t[r]){case 58:-1===n&&(n=r-c);break;case 13:a=!0;case 10:s=r}if(-1===s)break;e(t.subarray(c,s),n),c=r,n=-1}c===o?t=void 0:0!==c&&(t=t.subarray(c),r-=c)}}(function(e,t,r){let n={data:"",event:"",id:"",retry:void 0};const a=new TextDecoder;return function(s,i,o){if(o)(function(e){return""===e.data&&""===e.event&&""===e.id&&void 0===e.retry})(n)||(e?.(n),n={data:"",event:"",id:"",retry:void 0});else if(0===s.length)e?.(n),n={data:"",event:"",id:"",retry:void 0};else if(i>0){const e=a.decode(s.subarray(0,i)),o=i+(32===s[i+1]?2:1),c=a.decode(s.subarray(o));switch(e){case"data":n.data=n.data?n.data+"\n"+c:c;break;case"event":n.event=c;break;case"id":t?.(n.id=c);break;case"retry":{const e=parseInt(c,10);Number.isNaN(e)||r?.(n.retry=e);break}}}}}(t.onmessage)))}else switch(t.responseType){case"arraybuffer":s.data=await r.arrayBuffer();break;case"blob":s.data=await r.blob();break;case"json":s.data=await r.json();break;case"formData":s.data=await r.formData();break;default:s.data=await r.text()}return s}(t,e);return new Promise(((t,n)=>{r instanceof Error?n(r):"[object Function]"===Object.prototype.toString.call(e.settle)?e.settle(t,n,r):function(e,t,r){const{validateStatus:n}=r.config;r.status&&n&&!n(r.status)?t(u(`Request failed with status code ${r.status} and body ${"string"==typeof r.data?r.data:function(e){try{return JSON.stringify(e)}catch(t){return e}}(r.data)}`,r.config,null,r.request,r)):e(r)}(t,n,r)}))}function u(e,t,r,a,s){return n.AxiosError&&"function"==typeof n.AxiosError?new n.AxiosError(e,n.AxiosError[r],t,a,s):function(e,t,r,n,a){return e.config=t,r&&(e.code=r),e.request=n,e.response=a,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e}(new Error(e),t,r,a,s)}},3153:(e,t,r)=>{"use strict";function n(e){const{azureOpenAIApiDeploymentName:t,azureOpenAIApiInstanceName:r,azureOpenAIApiKey:n,azureOpenAIBasePath:a,basePath:s}=e;if(n&&a&&t)return`${a}/${t}`;if(n){if(!r)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!t)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${r}.openai.azure.com/openai/deployments/${t}`}return s}r.d(t,{O:()=>n})},4427:(e,t,r)=>{"use strict";r.d(t,{F:()=>n});const n=(e,t)=>e.reduce(((e,r,n)=>{const a=Math.floor(n/t),s=e[a]||[];return e[a]=s.concat([r]),e}),[])},5606:(e,t,r)=>{"use strict";r.d(t,{UG:()=>a,lS:()=>c,sA:()=>o});const n=()=>"undefined"!=typeof Deno,a=()=>"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node&&!n(),s=()=>{let e;return e="undefined"!=typeof window&&void 0!==window.document?"browser":a()?"node":"object"==typeof globalThis&&globalThis.constructor&&"DedicatedWorkerGlobalScope"===globalThis.constructor.name?"webworker":"undefined"!=typeof window&&"nodejs"===window.name||"undefined"!=typeof navigator&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom"))?"jsdom":n()?"deno":"other",e};let i;async function o(){if(void 0===i){const e=s();i={library:"langchain-js",runtime:e}}return i}function c(e){try{return"undefined"!=typeof process?process.env?.[e]:void 0}catch(e){return}}},3551:(e,t,r)=>{"use strict";r.d(t,{r:()=>n});const n=async(e,t,r,n,a,s,i,o,c)=>(await e.call(fetch,"https://api.promptlayer.com/track-request",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({function_name:t,provider:"langchain",args:r,kwargs:n,tags:a,request_response:s,request_start_time:Math.floor(i/1e3),request_end_time:Math.floor(o/1e3),api_key:c})})).json()},1858:(e,t,r)=>{"use strict";function n(e,t=!1){if(e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();const r=e.getReader();return{async next(){try{const e=await r.read();return e.done&&r.releaseLock(),e}catch(e){throw r.releaseLock(),e}},async return(){if(t)r.releaseLock();else{const e=r.cancel();r.releaseLock(),await e}return{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}r.d(t,{H:()=>n,Q:()=>a});class a extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const e=await this.reader.read();return e.done&&this.reader.releaseLock(),e}catch(e){throw this.reader.releaseLock(),e}}async return(){this.ensureReader();const e=this.reader.cancel();return this.reader.releaseLock(),await e,{done:!0,value:void 0}}[Symbol.asyncIterator](){return this}static fromReadableStream(e){const t=e.getReader();return new a({start:e=>function r(){return t.read().then((({done:t,value:n})=>{if(!t)return e.enqueue(n),r();e.close()}))}()})}static fromAsyncGenerator(e){return new a({async pull(t){const{value:r,done:n}=await e.next();n?t.close():r&&t.enqueue(r)}})}}},8186:(e,t,r)=>{"use strict";r.d(t,{b:()=>h});var n=Object.defineProperty,a=r(9742);function s(e,t){return 1===e.length?[t.get(e.join(","))]:function(e,t){let r=Array.from({length:e.length},((e,t)=>({start:t,end:t+1})));for(;r.length>1;){let n=null;for(let a=0;a<r.length-1;a++){const s=e.slice(r[a].start,r[a+1].end),i=t.get(s.join(","));null!=i&&(null==n||i<n[0])&&(n=[i,a])}if(null==n)break;{const e=n[1];r[e]={start:r[e].start,end:r[e+1].end},r.splice(e+1,1)}}return r}(e,t).map((r=>t.get(e.slice(r.start,r.end).join(",")))).filter((e=>null!=e))}var i,o=class{specialTokens;inverseSpecialTokens;patStr;textEncoder=new TextEncoder;textDecoder=new TextDecoder("utf-8");rankMap=new Map;textMap=new Map;constructor(e,t){this.patStr=e.pat_str;const r=e.bpe_ranks.split("\n").filter(Boolean).reduce(((e,t)=>{const[r,n,...a]=t.split(" "),s=Number.parseInt(n,10);return a.forEach(((t,r)=>e[t]=s+r)),e}),{});for(const[e,t]of Object.entries(r)){const r=a.toByteArray(e);this.rankMap.set(r.join(","),t),this.textMap.set(t,r)}this.specialTokens={...e.special_tokens,...t},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce(((e,[t,r])=>(e[r]=this.textEncoder.encode(t),e)),{})}encode(e,t=[],r="all"){const n=new RegExp(this.patStr,"ug"),a=o.specialTokenRegex(Object.keys(this.specialTokens)),i=[],c=new Set("all"===t?Object.keys(this.specialTokens):t),u=new Set("all"===r?Object.keys(this.specialTokens).filter((e=>!c.has(e))):r);if(u.size>0){const t=o.specialTokenRegex([...u]),r=e.match(t);if(null!=r)throw new Error(`The text contains a special token that is not allowed: ${r[0]}`)}let l=0;for(;;){let t=null,r=l;for(;a.lastIndex=r,t=a.exec(e),null!=t&&!c.has(t[0]);)r=t.index+1;const o=t?.index??e.length;for(const t of e.substring(l,o).matchAll(n)){const e=this.textEncoder.encode(t[0]),r=this.rankMap.get(e.join(","));null==r?i.push(...s(e,this.rankMap)):i.push(r)}if(null==t)break;let u=this.specialTokens[t[0]];i.push(u),l=t.index+t[0].length}return i}decode(e){const t=[];let r=0;for(let n=0;n<e.length;++n){const a=e[n],s=this.textMap.get(a)??this.inverseSpecialTokens[a];null!=s&&(t.push(s),r+=s.length)}const n=new Uint8Array(r);let a=0;for(const e of t)n.set(e,a),a+=e.length;return this.textDecoder.decode(n)}},c=o;((e,t,r)=>{t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(c,"symbol"!=typeof(i="specialTokenRegex")?i+"":i,(e=>new RegExp(e.map((e=>e.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&"))).join("|"),"g")));var u=r(803);const l={},d=new u.L({});async function h(e,t){return async function(e,t){return e in l||(l[e]=d.fetch(`https://tiktoken.pages.dev/js/${e}.json`,{signal:t?.signal}).then((e=>e.json())).catch((t=>{throw delete l[e],t}))),new c(await l[e],t?.extendedSpecialTokens)}(function(e){switch(e){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"text-embedding-ada-002":return"cl100k_base";default:throw new Error("Unknown model")}}(e),t)}},2611:e=>{"use strict";e.exports=JSON.parse('{"name":"openai","version":"3.3.0","description":"Node.js library for the OpenAI API","repository":{"type":"git","url":"git@github.com:openai/openai-node.git"},"keywords":["openai","open","ai","gpt-3","gpt3"],"author":"OpenAI","license":"MIT","main":"./dist/index.js","types":"./dist/index.d.ts","scripts":{"build":"tsc --outDir dist/"},"dependencies":{"axios":"^0.26.0","form-data":"^4.0.0"},"devDependencies":{"@types/node":"^12.11.5","typescript":"^3.6.4"}}')}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var s=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.loaded=!0,s.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";var e={};r.r(e),r.d(e,{APIConnectionError:()=>Nr,APIConnectionTimeoutError:()=>Rr,APIError:()=>Sr,APIUserAbortError:()=>Cr,AuthenticationError:()=>Lr,BadRequestError:()=>Mr,ConflictError:()=>Ur,InternalServerError:()=>Kr,NotFoundError:()=>Dr,PermissionDeniedError:()=>Zr,RateLimitError:()=>$r,UnprocessableEntityError:()=>zr});var t=r(3271),n=r(3995),a=(r(2776),r(4182)),s=r(6134),i=r(7967);class o extends s.oV{constructor(e){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","stores","message","in_memory"]}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.messages=e??[]}async getMessages(){return this.messages}async addMessage(e){this.messages.push(e)}async clear(){this.messages=[]}}class c extends i.fF{constructor(e){super(),Object.defineProperty(this,"chatHistory",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnMessages",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.chatHistory=e?.chatHistory??new o,this.returnMessages=e?.returnMessages??this.returnMessages,this.inputKey=e?.inputKey??this.inputKey,this.outputKey=e?.outputKey??this.outputKey}async saveContext(e,t){await this.chatHistory.addUserMessage((0,i.d9)(e,this.inputKey)),await this.chatHistory.addAIChatMessage((0,i.jG)(t,this.outputKey))}async clear(){await this.chatHistory.clear()}}class u extends c{constructor(e){super({chatHistory:e?.chatHistory,returnMessages:e?.returnMessages??!1,inputKey:e?.inputKey,outputKey:e?.outputKey}),Object.defineProperty(this,"humanPrefix",{enumerable:!0,configurable:!0,writable:!0,value:"Human"}),Object.defineProperty(this,"aiPrefix",{enumerable:!0,configurable:!0,writable:!0,value:"AI"}),Object.defineProperty(this,"memoryKey",{enumerable:!0,configurable:!0,writable:!0,value:"history"}),this.humanPrefix=e?.humanPrefix??this.humanPrefix,this.aiPrefix=e?.aiPrefix??this.aiPrefix,this.memoryKey=e?.memoryKey??this.memoryKey}get memoryKeys(){return[this.memoryKey]}async loadMemoryVariables(e){const t=await this.chatHistory.getMessages();return this.returnMessages?{[this.memoryKey]:t}:{[this.memoryKey]:(0,i.zs)(t,this.humanPrefix,this.aiPrefix)}}}var l=r(6430),d=r(803);r(5641),r(2702);class h extends n.LLMChain{static lc_name(){return"ConversationChain"}constructor({prompt:e,outputKey:t,memory:r,...n}){super({prompt:e??new l.PromptTemplate({template:"The following is a friendly conversation between a human and an AI. The AI is talkative and provides lots of specific details from its context. If the AI does not know the answer to a question, it truthfully says it does not know.\n\nCurrent conversation:\n{history}\nHuman: {input}\nAI:",inputVariables:["history","input"]}),outputKey:t??"response",memory:r??new u,...n})}}r(3685),r(6090);var p=r(768);class f{constructor(e){Object.defineProperty(this,"pageContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.pageContent=e.pageContent?e.pageContent.toString():this.pageContent,this.metadata=e.metadata??{}}}r(8186);var m=r(0);class g extends m.eq{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","document_transformers"]})}invoke(e,t){return this.transformDocuments(e)}}class y extends g{constructor(e){if(super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","document_transformers","text_splitters"]}),Object.defineProperty(this,"chunkSize",{enumerable:!0,configurable:!0,writable:!0,value:1e3}),Object.defineProperty(this,"chunkOverlap",{enumerable:!0,configurable:!0,writable:!0,value:200}),Object.defineProperty(this,"keepSeparator",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lengthFunction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.chunkSize=e?.chunkSize??this.chunkSize,this.chunkOverlap=e?.chunkOverlap??this.chunkOverlap,this.keepSeparator=e?.keepSeparator??this.keepSeparator,this.lengthFunction=e?.lengthFunction??(e=>e.length),this.chunkOverlap>=this.chunkSize)throw new Error("Cannot have chunkOverlap >= chunkSize")}async transformDocuments(e,t={}){return this.splitDocuments(e,t)}splitOnSeparator(e,t){let r;if(t)if(this.keepSeparator){const n=t.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&");r=e.split(new RegExp(`(?=${n})`))}else r=e.split(t);else r=e.split("");return r.filter((e=>""!==e))}async createDocuments(e,t=[],r={}){const n=t.length>0?t:new Array(e.length).fill({}),{chunkHeader:a="",chunkOverlapHeader:s="(cont'd) ",appendChunkOverlapHeader:i=!1}=r,o=new Array;for(let t=0;t<e.length;t+=1){const r=e[t];let c=1,u=null;for(const e of await this.splitText(r)){let l=a,d=0;if(u){const t=r.indexOf(e),n=r.indexOf(u)+await this.lengthFunction(u);d=(r.slice(n,t).match(/\n/g)||[]).length,i&&(l+=s)}c+=d;const h=(e.match(/\n/g)||[]).length,p=n[t].loc&&"object"==typeof n[t].loc?{...n[t].loc}:{};p.lines={from:c,to:c+h};const m={...n[t],loc:p};l+=e,o.push(new f({pageContent:l,metadata:m})),c+=h,u=e}}return o}async splitDocuments(e,t={}){const r=e.filter((e=>void 0!==e.pageContent)),n=r.map((e=>e.pageContent)),a=r.map((e=>e.metadata));return this.createDocuments(n,a,t)}joinDocs(e,t){const r=e.join(t).trim();return""===r?null:r}async mergeSplits(e,t){const r=[],n=[];let a=0;for(const s of e){const e=await this.lengthFunction(s);if(a+e+(n.length>0?t.length:0)>this.chunkSize&&(a>this.chunkSize&&console.warn(`Created a chunk of size ${a}, +\nwhich is longer than the specified ${this.chunkSize}`),n.length>0)){const s=this.joinDocs(n,t);for(null!==s&&r.push(s);a>this.chunkOverlap||a+e>this.chunkSize&&a>0;)a-=await this.lengthFunction(n[0]),n.shift()}n.push(s),a+=e}const s=this.joinDocs(n,t);return null!==s&&r.push(s),r}}class b extends y{static lc_name(){return"RecursiveCharacterTextSplitter"}constructor(e){super(e),Object.defineProperty(this,"separators",{enumerable:!0,configurable:!0,writable:!0,value:["\n\n","\n"," ",""]}),this.separators=e?.separators??this.separators,this.keepSeparator=e?.keepSeparator??!0}async _splitText(e,t){const r=[];let n,a=t[t.length-1];for(let r=0;r<t.length;r+=1){const s=t[r];if(""===s){a=s;break}if(e.includes(s)){a=s,n=t.slice(r+1);break}}const s=this.splitOnSeparator(e,a);let i=[];const o=this.keepSeparator?"":a;for(const e of s)if(await this.lengthFunction(e)<this.chunkSize)i.push(e);else{if(i.length){const e=await this.mergeSplits(i,o);r.push(...e),i=[]}if(n){const t=await this._splitText(e,n);r.push(...t)}else r.push(e)}if(i.length){const e=await this.mergeSplits(i,o);r.push(...e)}return r}async splitText(e){return this._splitText(e,this.separators)}static fromLanguage(e,t){return new b({...t,separators:b.getSeparatorsForLanguage(e)})}static getSeparatorsForLanguage(e){if("cpp"===e)return["\nclass ","\nvoid ","\nint ","\nfloat ","\ndouble ","\nif ","\nfor ","\nwhile ","\nswitch ","\ncase ","\n\n","\n"," ",""];if("go"===e)return["\nfunc ","\nvar ","\nconst ","\ntype ","\nif ","\nfor ","\nswitch ","\ncase ","\n\n","\n"," ",""];if("java"===e)return["\nclass ","\npublic ","\nprotected ","\nprivate ","\nstatic ","\nif ","\nfor ","\nwhile ","\nswitch ","\ncase ","\n\n","\n"," ",""];if("js"===e)return["\nfunction ","\nconst ","\nlet ","\nvar ","\nclass ","\nif ","\nfor ","\nwhile ","\nswitch ","\ncase ","\ndefault ","\n\n","\n"," ",""];if("php"===e)return["\nfunction ","\nclass ","\nif ","\nforeach ","\nwhile ","\ndo ","\nswitch ","\ncase ","\n\n","\n"," ",""];if("proto"===e)return["\nmessage ","\nservice ","\nenum ","\noption ","\nimport ","\nsyntax ","\n\n","\n"," ",""];if("python"===e)return["\nclass ","\ndef ","\n\tdef ","\n\n","\n"," ",""];if("rst"===e)return["\n===\n","\n---\n","\n***\n","\n.. ","\n\n","\n"," ",""];if("ruby"===e)return["\ndef ","\nclass ","\nif ","\nunless ","\nwhile ","\nfor ","\ndo ","\nbegin ","\nrescue ","\n\n","\n"," ",""];if("rust"===e)return["\nfn ","\nconst ","\nlet ","\nif ","\nwhile ","\nfor ","\nloop ","\nmatch ","\nconst ","\n\n","\n"," ",""];if("scala"===e)return["\nclass ","\nobject ","\ndef ","\nval ","\nvar ","\nif ","\nfor ","\nwhile ","\nmatch ","\ncase ","\n\n","\n"," ",""];if("swift"===e)return["\nfunc ","\nclass ","\nstruct ","\nenum ","\nif ","\nfor ","\nwhile ","\ndo ","\nswitch ","\ncase ","\n\n","\n"," ",""];if("markdown"===e)return["\n## ","\n### ","\n#### ","\n##### ","\n###### ","```\n\n","\n\n***\n\n","\n\n---\n\n","\n\n___\n\n","\n\n","\n"," ",""];if("latex"===e)return["\n\\chapter{","\n\\section{","\n\\subsection{","\n\\subsubsection{","\n\\begin{enumerate}","\n\\begin{itemize}","\n\\begin{description}","\n\\begin{list}","\n\\begin{quote}","\n\\begin{quotation}","\n\\begin{verse}","\n\\begin{verbatim}","\n\\begin{align}","$$","$","\n\n","\n"," ",""];if("html"===e)return["<body>","<div>","<p>","<br>","<li>","<h1>","<h2>","<h3>","<h4>","<h5>","<h6>","<span>","<table>","<tr>","<td>","<th>","<ul>","<ol>","<header>","<footer>","<nav>","<head>","<style>","<script>","<meta>","<title>"," ",""];if("sol"===e)return["\npragma ","\nusing ","\ncontract ","\ninterface ","\nlibrary ","\nconstructor ","\ntype ","\nfunction ","\nevent ","\nmodifier ","\nerror ","\nstruct ","\nenum ","\nif ","\nfor ","\nwhile ","\ndo while ","\nassembly ","\n\n","\n"," ",""];throw new Error(`Language ${e} is not supported.`)}}r(1545),r(2832);var v,_,w=r(5524),O=r(566);r(5738),function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const r of e)t[r]=r;return t},e.getValidEnumValues=t=>{const r=e.objectKeys(t).filter((e=>"number"!=typeof t[t[e]])),n={};for(const e of r)n[e]=t[e];return e.objectValues(n)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(const r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`'${e}'`:e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(v||(v={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}(_||(_={}));const x=v.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),P=e=>{switch(typeof e){case"undefined":return x.undefined;case"string":return x.string;case"number":return isNaN(e)?x.nan:x.number;case"boolean":return x.boolean;case"function":return x.function;case"bigint":return x.bigint;case"symbol":return x.symbol;case"object":return Array.isArray(e)?x.array:null===e?x.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?x.promise:"undefined"!=typeof Map&&e instanceof Map?x.map:"undefined"!=typeof Set&&e instanceof Set?x.set:"undefined"!=typeof Date&&e instanceof Date?x.date:x.object;default:return x.unknown}},A=v.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class I extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(e){return e.message},r={_errors:[]},n=e=>{for(const a of e.issues)if("invalid_union"===a.code)a.unionErrors.map(n);else if("invalid_return_type"===a.code)n(a.returnTypeError);else if("invalid_arguments"===a.code)n(a.argumentsError);else if(0===a.path.length)r._errors.push(t(a));else{let e=r,n=0;for(;n<a.path.length;){const r=a.path[n];n===a.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(a))):e[r]=e[r]||{_errors:[]},e=e[r],n++}}};return n(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,v.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=(e=>e.message)){const t={},r=[];for(const n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):r.push(e(n));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}I.create=e=>new I(e);const T=(e,t)=>{let r;switch(e.code){case A.invalid_type:r=e.received===x.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case A.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,v.jsonStringifyReplacer)}`;break;case A.unrecognized_keys:r=`Unrecognized key(s) in object: ${v.joinValues(e.keys,", ")}`;break;case A.invalid_union:r="Invalid input";break;case A.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${v.joinValues(e.options)}`;break;case A.invalid_enum_value:r=`Invalid enum value. Expected ${v.joinValues(e.options)}, received '${e.received}'`;break;case A.invalid_arguments:r="Invalid function arguments";break;case A.invalid_return_type:r="Invalid function return type";break;case A.invalid_date:r="Invalid date";break;case A.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:v.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case A.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case A.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case A.custom:r="Invalid input";break;case A.invalid_intersection_types:r="Intersection results could not be merged";break;case A.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case A.not_finite:r="Number must be finite";break;default:r=t.defaultError,v.assertNever(e)}return{message:r}};let E=T;function k(){return E}const j=e=>{const{data:t,path:r,errorMaps:n,issueData:a}=e,s=[...r,...a.path||[]],i={...a,path:s};let o="";const c=n.filter((e=>!!e)).slice().reverse();for(const e of c)o=e(i,{data:t,defaultError:o}).message;return{...a,path:s,message:a.message||o}};function S(e,t){const r=j({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,k(),T].filter((e=>!!e))});e.common.issues.push(r)}class C{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const n of t){if("aborted"===n.status)return N;"dirty"===n.status&&e.dirty(),r.push(n.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const e of t)r.push({key:await e.key,value:await e.value});return C.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const n of t){const{key:t,value:a}=n;if("aborted"===t.status)return N;if("aborted"===a.status)return N;"dirty"===t.status&&e.dirty(),"dirty"===a.status&&e.dirty(),"__proto__"===t.value||void 0===a.value&&!n.alwaysSet||(r[t.value]=a.value)}return{status:e.value,value:r}}}const N=Object.freeze({status:"aborted"}),R=e=>({status:"dirty",value:e}),M=e=>({status:"valid",value:e}),L=e=>"aborted"===e.status,Z=e=>"dirty"===e.status,D=e=>"valid"===e.status,U=e=>"undefined"!=typeof Promise&&e instanceof Promise;var $;!function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:null==e?void 0:e.message}($||($={}));class K{constructor(e,t,r,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const F=(e,t)=>{if(D(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new I(e.common.issues);return this._error=t,this._error}}};function B(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:a}=e;if(t&&(r||n))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:a}:{errorMap:(e,t)=>"invalid_type"!==e.code?{message:t.defaultError}:void 0===t.data?{message:null!=n?n:t.defaultError}:{message:null!=r?r:t.defaultError},description:a}}class q{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return P(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:P(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new C,ctx:{common:e.parent.common,data:e.data,parsedType:P(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(U(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const n={common:{issues:[],async:null!==(r=null==t?void 0:t.async)&&void 0!==r&&r,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:P(e)},a=this._parseSync({data:e,path:n.path,parent:n});return F(n,a)}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:P(e)},n=this._parse({data:e,path:r.path,parent:r}),a=await(U(n)?n:Promise.resolve(n));return F(r,a)}refine(e,t){const r=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,n)=>{const a=e(t),s=()=>n.addIssue({code:A.custom,...r(t)});return"undefined"!=typeof Promise&&a instanceof Promise?a.then((e=>!!e||(s(),!1))):!!a||(s(),!1)}))}refinement(e,t){return this._refinement(((r,n)=>!!e(r)||(n.addIssue("function"==typeof t?t(r,n):t),!1)))}_refinement(e){return new Ce({schema:this,typeName:Be.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Ne.create(this,this._def)}nullable(){return Re.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return pe.create(this,this._def)}promise(){return Se.create(this,this._def)}or(e){return ge.create([this,e],this._def)}and(e){return _e.create(this,e,this._def)}transform(e){return new Ce({...B(this._def),schema:this,typeName:Be.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new Me({...B(this._def),innerType:this,defaultValue:t,typeName:Be.ZodDefault})}brand(){return new Ue({typeName:Be.ZodBranded,type:this,...B(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new Le({...B(this._def),innerType:this,catchValue:t,typeName:Be.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return ze.create(this,e)}readonly(){return $e.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const V=/^c[^\s-]{8,}$/i,H=/^[a-z][a-z0-9]*$/,W=/[0-9A-HJKMNP-TV-Z]{26}/,Y=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,J=/^([A-Z0-9_+-]+\.?)*[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,G=/^(\p{Extended_Pictographic}|\p{Emoji_Component})+$/u,X=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,Q=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/;class ee extends q{constructor(){super(...arguments),this._regex=(e,t,r)=>this.refinement((t=>e.test(t)),{validation:t,code:A.invalid_string,...$.errToObj(r)}),this.nonempty=e=>this.min(1,$.errToObj(e)),this.trim=()=>new ee({...this._def,checks:[...this._def.checks,{kind:"trim"}]}),this.toLowerCase=()=>new ee({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]}),this.toUpperCase=()=>new ee({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==x.string){const t=this._getOrReturnCtx(e);return S(t,{code:A.invalid_type,expected:x.string,received:t.parsedType}),N}const t=new C;let r;for(const i of this._def.checks)if("min"===i.kind)e.data.length<i.value&&(r=this._getOrReturnCtx(e,r),S(r,{code:A.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("max"===i.kind)e.data.length>i.value&&(r=this._getOrReturnCtx(e,r),S(r,{code:A.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("length"===i.kind){const n=e.data.length>i.value,a=e.data.length<i.value;(n||a)&&(r=this._getOrReturnCtx(e,r),n?S(r,{code:A.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&S(r,{code:A.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),t.dirty())}else if("email"===i.kind)J.test(e.data)||(r=this._getOrReturnCtx(e,r),S(r,{validation:"email",code:A.invalid_string,message:i.message}),t.dirty());else if("emoji"===i.kind)G.test(e.data)||(r=this._getOrReturnCtx(e,r),S(r,{validation:"emoji",code:A.invalid_string,message:i.message}),t.dirty());else if("uuid"===i.kind)Y.test(e.data)||(r=this._getOrReturnCtx(e,r),S(r,{validation:"uuid",code:A.invalid_string,message:i.message}),t.dirty());else if("cuid"===i.kind)V.test(e.data)||(r=this._getOrReturnCtx(e,r),S(r,{validation:"cuid",code:A.invalid_string,message:i.message}),t.dirty());else if("cuid2"===i.kind)H.test(e.data)||(r=this._getOrReturnCtx(e,r),S(r,{validation:"cuid2",code:A.invalid_string,message:i.message}),t.dirty());else if("ulid"===i.kind)W.test(e.data)||(r=this._getOrReturnCtx(e,r),S(r,{validation:"ulid",code:A.invalid_string,message:i.message}),t.dirty());else if("url"===i.kind)try{new URL(e.data)}catch(n){r=this._getOrReturnCtx(e,r),S(r,{validation:"url",code:A.invalid_string,message:i.message}),t.dirty()}else"regex"===i.kind?(i.regex.lastIndex=0,i.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),S(r,{validation:"regex",code:A.invalid_string,message:i.message}),t.dirty())):"trim"===i.kind?e.data=e.data.trim():"includes"===i.kind?e.data.includes(i.value,i.position)||(r=this._getOrReturnCtx(e,r),S(r,{code:A.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),t.dirty()):"toLowerCase"===i.kind?e.data=e.data.toLowerCase():"toUpperCase"===i.kind?e.data=e.data.toUpperCase():"startsWith"===i.kind?e.data.startsWith(i.value)||(r=this._getOrReturnCtx(e,r),S(r,{code:A.invalid_string,validation:{startsWith:i.value},message:i.message}),t.dirty()):"endsWith"===i.kind?e.data.endsWith(i.value)||(r=this._getOrReturnCtx(e,r),S(r,{code:A.invalid_string,validation:{endsWith:i.value},message:i.message}),t.dirty()):"datetime"===i.kind?((s=i).precision?s.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${s.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${s.precision}}Z$`):0===s.precision?s.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):s.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$")).test(e.data)||(r=this._getOrReturnCtx(e,r),S(r,{code:A.invalid_string,validation:"datetime",message:i.message}),t.dirty()):"ip"===i.kind?(n=e.data,("v4"!==(a=i.version)&&a||!X.test(n))&&("v6"!==a&&a||!Q.test(n))&&(r=this._getOrReturnCtx(e,r),S(r,{validation:"ip",code:A.invalid_string,message:i.message}),t.dirty())):v.assertNever(i);var n,a,s;return{status:t.value,value:e.data}}_addCheck(e){return new ee({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...$.errToObj(e)})}url(e){return this._addCheck({kind:"url",...$.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...$.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...$.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...$.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...$.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...$.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...$.errToObj(e)})}datetime(e){var t;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,...$.errToObj(null==e?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...$.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...$.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...$.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...$.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...$.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...$.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...$.errToObj(t)})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function te(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,a=r>n?r:n;return parseInt(e.toFixed(a).replace(".",""))%parseInt(t.toFixed(a).replace(".",""))/Math.pow(10,a)}ee.create=e=>{var t;return new ee({checks:[],typeName:Be.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...B(e)})};class re extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==x.number){const t=this._getOrReturnCtx(e);return S(t,{code:A.invalid_type,expected:x.number,received:t.parsedType}),N}let t;const r=new C;for(const n of this._def.checks)"int"===n.kind?v.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),S(t,{code:A.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty()):"min"===n.kind?(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),S(t,{code:A.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):"max"===n.kind?(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),S(t,{code:A.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):"multipleOf"===n.kind?0!==te(e.data,n.value)&&(t=this._getOrReturnCtx(e,t),S(t,{code:A.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):"finite"===n.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),S(t,{code:A.not_finite,message:n.message}),r.dirty()):v.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,$.toString(t))}gt(e,t){return this.setLimit("min",e,!1,$.toString(t))}lte(e,t){return this.setLimit("max",e,!0,$.toString(t))}lt(e,t){return this.setLimit("max",e,!1,$.toString(t))}setLimit(e,t,r,n){return new re({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:$.toString(n)}]})}_addCheck(e){return new re({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:$.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:$.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:$.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:$.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:$.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:$.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:$.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:$.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:$.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&v.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}re.create=e=>new re({checks:[],typeName:Be.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...B(e)});class ne extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==x.bigint){const t=this._getOrReturnCtx(e);return S(t,{code:A.invalid_type,expected:x.bigint,received:t.parsedType}),N}let t;const r=new C;for(const n of this._def.checks)"min"===n.kind?(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),S(t,{code:A.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"max"===n.kind?(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),S(t,{code:A.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"multipleOf"===n.kind?e.data%n.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),S(t,{code:A.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):v.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,$.toString(t))}gt(e,t){return this.setLimit("min",e,!1,$.toString(t))}lte(e,t){return this.setLimit("max",e,!0,$.toString(t))}lt(e,t){return this.setLimit("max",e,!1,$.toString(t))}setLimit(e,t,r,n){return new ne({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:$.toString(n)}]})}_addCheck(e){return new ne({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:$.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:$.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:$.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:$.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:$.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}ne.create=e=>{var t;return new ne({checks:[],typeName:Be.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...B(e)})};class ae extends q{_parse(e){if(this._def.coerce&&(e.data=Boolean(e.data)),this._getType(e)!==x.boolean){const t=this._getOrReturnCtx(e);return S(t,{code:A.invalid_type,expected:x.boolean,received:t.parsedType}),N}return M(e.data)}}ae.create=e=>new ae({typeName:Be.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...B(e)});class se extends q{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==x.date){const t=this._getOrReturnCtx(e);return S(t,{code:A.invalid_type,expected:x.date,received:t.parsedType}),N}if(isNaN(e.data.getTime()))return S(this._getOrReturnCtx(e),{code:A.invalid_date}),N;const t=new C;let r;for(const n of this._def.checks)"min"===n.kind?e.data.getTime()<n.value&&(r=this._getOrReturnCtx(e,r),S(r,{code:A.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),t.dirty()):"max"===n.kind?e.data.getTime()>n.value&&(r=this._getOrReturnCtx(e,r),S(r,{code:A.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),t.dirty()):v.assertNever(n);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new se({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:$.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:$.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}se.create=e=>new se({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:Be.ZodDate,...B(e)});class ie extends q{_parse(e){if(this._getType(e)!==x.symbol){const t=this._getOrReturnCtx(e);return S(t,{code:A.invalid_type,expected:x.symbol,received:t.parsedType}),N}return M(e.data)}}ie.create=e=>new ie({typeName:Be.ZodSymbol,...B(e)});class oe extends q{_parse(e){if(this._getType(e)!==x.undefined){const t=this._getOrReturnCtx(e);return S(t,{code:A.invalid_type,expected:x.undefined,received:t.parsedType}),N}return M(e.data)}}oe.create=e=>new oe({typeName:Be.ZodUndefined,...B(e)});class ce extends q{_parse(e){if(this._getType(e)!==x.null){const t=this._getOrReturnCtx(e);return S(t,{code:A.invalid_type,expected:x.null,received:t.parsedType}),N}return M(e.data)}}ce.create=e=>new ce({typeName:Be.ZodNull,...B(e)});class ue extends q{constructor(){super(...arguments),this._any=!0}_parse(e){return M(e.data)}}ue.create=e=>new ue({typeName:Be.ZodAny,...B(e)});class le extends q{constructor(){super(...arguments),this._unknown=!0}_parse(e){return M(e.data)}}le.create=e=>new le({typeName:Be.ZodUnknown,...B(e)});class de extends q{_parse(e){const t=this._getOrReturnCtx(e);return S(t,{code:A.invalid_type,expected:x.never,received:t.parsedType}),N}}de.create=e=>new de({typeName:Be.ZodNever,...B(e)});class he extends q{_parse(e){if(this._getType(e)!==x.undefined){const t=this._getOrReturnCtx(e);return S(t,{code:A.invalid_type,expected:x.void,received:t.parsedType}),N}return M(e.data)}}he.create=e=>new he({typeName:Be.ZodVoid,...B(e)});class pe extends q{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),n=this._def;if(t.parsedType!==x.array)return S(t,{code:A.invalid_type,expected:x.array,received:t.parsedType}),N;if(null!==n.exactLength){const e=t.data.length>n.exactLength.value,a=t.data.length<n.exactLength.value;(e||a)&&(S(t,{code:e?A.too_big:A.too_small,minimum:a?n.exactLength.value:void 0,maximum:e?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(null!==n.minLength&&t.data.length<n.minLength.value&&(S(t,{code:A.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),null!==n.maxLength&&t.data.length>n.maxLength.value&&(S(t,{code:A.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map(((e,r)=>n.type._parseAsync(new K(t,e,t.path,r))))).then((e=>C.mergeArray(r,e)));const a=[...t.data].map(((e,r)=>n.type._parseSync(new K(t,e,t.path,r))));return C.mergeArray(r,a)}get element(){return this._def.type}min(e,t){return new pe({...this._def,minLength:{value:e,message:$.toString(t)}})}max(e,t){return new pe({...this._def,maxLength:{value:e,message:$.toString(t)}})}length(e,t){return new pe({...this._def,exactLength:{value:e,message:$.toString(t)}})}nonempty(e){return this.min(1,e)}}function fe(e){if(e instanceof me){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=Ne.create(fe(n))}return new me({...e._def,shape:()=>t})}return e instanceof pe?new pe({...e._def,type:fe(e.element)}):e instanceof Ne?Ne.create(fe(e.unwrap())):e instanceof Re?Re.create(fe(e.unwrap())):e instanceof we?we.create(e.items.map((e=>fe(e)))):e}pe.create=(e,t)=>new pe({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Be.ZodArray,...B(t)});class me extends q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=v.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==x.object){const t=this._getOrReturnCtx(e);return S(t,{code:A.invalid_type,expected:x.object,received:t.parsedType}),N}const{status:t,ctx:r}=this._processInputParams(e),{shape:n,keys:a}=this._getCached(),s=[];if(!(this._def.catchall instanceof de&&"strip"===this._def.unknownKeys))for(const e in r.data)a.includes(e)||s.push(e);const i=[];for(const e of a){const t=n[e],a=r.data[e];i.push({key:{status:"valid",value:e},value:t._parse(new K(r,a,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof de){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of s)i.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)s.length>0&&(S(r,{code:A.unrecognized_keys,keys:s}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of s){const n=r.data[t];i.push({key:{status:"valid",value:t},value:e._parse(new K(r,n,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of i){const r=await t.key;e.push({key:r,value:await t.value,alwaysSet:t.alwaysSet})}return e})).then((e=>C.mergeObjectSync(t,e))):C.mergeObjectSync(t,i)}get shape(){return this._def.shape()}strict(e){return $.errToObj,new me({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{var n,a,s,i;const o=null!==(s=null===(a=(n=this._def).errorMap)||void 0===a?void 0:a.call(n,t,r).message)&&void 0!==s?s:r.defaultError;return"unrecognized_keys"===t.code?{message:null!==(i=$.errToObj(e).message)&&void 0!==i?i:o}:{message:o}}}:{}})}strip(){return new me({...this._def,unknownKeys:"strip"})}passthrough(){return new me({...this._def,unknownKeys:"passthrough"})}extend(e){return new me({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new me({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Be.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new me({...this._def,catchall:e})}pick(e){const t={};return v.objectKeys(e).forEach((r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])})),new me({...this._def,shape:()=>t})}omit(e){const t={};return v.objectKeys(this.shape).forEach((r=>{e[r]||(t[r]=this.shape[r])})),new me({...this._def,shape:()=>t})}deepPartial(){return fe(this)}partial(e){const t={};return v.objectKeys(this.shape).forEach((r=>{const n=this.shape[r];e&&!e[r]?t[r]=n:t[r]=n.optional()})),new me({...this._def,shape:()=>t})}required(e){const t={};return v.objectKeys(this.shape).forEach((r=>{if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof Ne;)e=e._def.innerType;t[r]=e}})),new me({...this._def,shape:()=>t})}keyof(){return Ee(v.objectKeys(this.shape))}}me.create=(e,t)=>new me({shape:()=>e,unknownKeys:"strip",catchall:de.create(),typeName:Be.ZodObject,...B(t)}),me.strictCreate=(e,t)=>new me({shape:()=>e,unknownKeys:"strict",catchall:de.create(),typeName:Be.ZodObject,...B(t)}),me.lazycreate=(e,t)=>new me({shape:e,unknownKeys:"strip",catchall:de.create(),typeName:Be.ZodObject,...B(t)});class ge extends q{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map((async e=>{const r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;const r=e.map((e=>new I(e.ctx.common.issues)));return S(t,{code:A.invalid_union,unionErrors:r}),N}));{let e;const n=[];for(const a of r){const r={...t,common:{...t.common,issues:[]},parent:null},s=a._parseSync({data:t.data,path:t.path,parent:r});if("valid"===s.status)return s;"dirty"!==s.status||e||(e={result:s,ctx:r}),r.common.issues.length&&n.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const a=n.map((e=>new I(e)));return S(t,{code:A.invalid_union,unionErrors:a}),N}}get options(){return this._def.options}}ge.create=(e,t)=>new ge({options:e,typeName:Be.ZodUnion,...B(t)});const ye=e=>e instanceof Ie?ye(e.schema):e instanceof Ce?ye(e.innerType()):e instanceof Te?[e.value]:e instanceof ke?e.options:e instanceof je?Object.keys(e.enum):e instanceof Me?ye(e._def.innerType):e instanceof oe?[void 0]:e instanceof ce?[null]:null;class be extends q{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==x.object)return S(t,{code:A.invalid_type,expected:x.object,received:t.parsedType}),N;const r=this.discriminator,n=t.data[r],a=this.optionsMap.get(n);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):(S(t,{code:A.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),N)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const n=new Map;for(const r of t){const t=ye(r.shape[e]);if(!t)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of t){if(n.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);n.set(a,r)}}return new be({typeName:Be.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...B(r)})}}function ve(e,t){const r=P(e),n=P(t);if(e===t)return{valid:!0,data:e};if(r===x.object&&n===x.object){const r=v.objectKeys(t),n=v.objectKeys(e).filter((e=>-1!==r.indexOf(e))),a={...e,...t};for(const r of n){const n=ve(e[r],t[r]);if(!n.valid)return{valid:!1};a[r]=n.data}return{valid:!0,data:a}}if(r===x.array&&n===x.array){if(e.length!==t.length)return{valid:!1};const r=[];for(let n=0;n<e.length;n++){const a=ve(e[n],t[n]);if(!a.valid)return{valid:!1};r.push(a.data)}return{valid:!0,data:r}}return r===x.date&&n===x.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class _e extends q{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),n=(e,n)=>{if(L(e)||L(n))return N;const a=ve(e.value,n.value);return a.valid?((Z(e)||Z(n))&&t.dirty(),{status:t.value,value:a.data}):(S(r,{code:A.invalid_intersection_types}),N)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then((([e,t])=>n(e,t))):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}_e.create=(e,t,r)=>new _e({left:e,right:t,typeName:Be.ZodIntersection,...B(r)});class we extends q{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==x.array)return S(r,{code:A.invalid_type,expected:x.array,received:r.parsedType}),N;if(r.data.length<this._def.items.length)return S(r,{code:A.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),N;!this._def.rest&&r.data.length>this._def.items.length&&(S(r,{code:A.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const n=[...r.data].map(((e,t)=>{const n=this._def.items[t]||this._def.rest;return n?n._parse(new K(r,e,r.path,t)):null})).filter((e=>!!e));return r.common.async?Promise.all(n).then((e=>C.mergeArray(t,e))):C.mergeArray(t,n)}get items(){return this._def.items}rest(e){return new we({...this._def,rest:e})}}we.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new we({items:e,typeName:Be.ZodTuple,rest:null,...B(t)})};class Oe extends q{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==x.object)return S(r,{code:A.invalid_type,expected:x.object,received:r.parsedType}),N;const n=[],a=this._def.keyType,s=this._def.valueType;for(const e in r.data)n.push({key:a._parse(new K(r,e,r.path,e)),value:s._parse(new K(r,r.data[e],r.path,e))});return r.common.async?C.mergeObjectAsync(t,n):C.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(e,t,r){return new Oe(t instanceof q?{keyType:e,valueType:t,typeName:Be.ZodRecord,...B(r)}:{keyType:ee.create(),valueType:e,typeName:Be.ZodRecord,...B(t)})}}class xe extends q{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==x.map)return S(r,{code:A.invalid_type,expected:x.map,received:r.parsedType}),N;const n=this._def.keyType,a=this._def.valueType,s=[...r.data.entries()].map((([e,t],s)=>({key:n._parse(new K(r,e,r.path,[s,"key"])),value:a._parse(new K(r,t,r.path,[s,"value"]))})));if(r.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const r of s){const n=await r.key,a=await r.value;if("aborted"===n.status||"aborted"===a.status)return N;"dirty"!==n.status&&"dirty"!==a.status||t.dirty(),e.set(n.value,a.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const r of s){const n=r.key,a=r.value;if("aborted"===n.status||"aborted"===a.status)return N;"dirty"!==n.status&&"dirty"!==a.status||t.dirty(),e.set(n.value,a.value)}return{status:t.value,value:e}}}}xe.create=(e,t,r)=>new xe({valueType:t,keyType:e,typeName:Be.ZodMap,...B(r)});class Pe extends q{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==x.set)return S(r,{code:A.invalid_type,expected:x.set,received:r.parsedType}),N;const n=this._def;null!==n.minSize&&r.data.size<n.minSize.value&&(S(r,{code:A.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),null!==n.maxSize&&r.data.size>n.maxSize.value&&(S(r,{code:A.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());const a=this._def.valueType;function s(e){const r=new Set;for(const n of e){if("aborted"===n.status)return N;"dirty"===n.status&&t.dirty(),r.add(n.value)}return{status:t.value,value:r}}const i=[...r.data.values()].map(((e,t)=>a._parse(new K(r,e,r.path,t))));return r.common.async?Promise.all(i).then((e=>s(e))):s(i)}min(e,t){return new Pe({...this._def,minSize:{value:e,message:$.toString(t)}})}max(e,t){return new Pe({...this._def,maxSize:{value:e,message:$.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Pe.create=(e,t)=>new Pe({valueType:e,minSize:null,maxSize:null,typeName:Be.ZodSet,...B(t)});class Ae extends q{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==x.function)return S(t,{code:A.invalid_type,expected:x.function,received:t.parsedType}),N;function r(e,r){return j({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,k(),T].filter((e=>!!e)),issueData:{code:A.invalid_arguments,argumentsError:r}})}function n(e,r){return j({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,k(),T].filter((e=>!!e)),issueData:{code:A.invalid_return_type,returnTypeError:r}})}const a={errorMap:t.common.contextualErrorMap},s=t.data;if(this._def.returns instanceof Se){const e=this;return M((async function(...t){const i=new I([]),o=await e._def.args.parseAsync(t,a).catch((e=>{throw i.addIssue(r(t,e)),i})),c=await Reflect.apply(s,this,o);return await e._def.returns._def.type.parseAsync(c,a).catch((e=>{throw i.addIssue(n(c,e)),i}))}))}{const e=this;return M((function(...t){const i=e._def.args.safeParse(t,a);if(!i.success)throw new I([r(t,i.error)]);const o=Reflect.apply(s,this,i.data),c=e._def.returns.safeParse(o,a);if(!c.success)throw new I([n(o,c.error)]);return c.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Ae({...this._def,args:we.create(e).rest(le.create())})}returns(e){return new Ae({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new Ae({args:e||we.create([]).rest(le.create()),returns:t||le.create(),typeName:Be.ZodFunction,...B(r)})}}class Ie extends q{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Ie.create=(e,t)=>new Ie({getter:e,typeName:Be.ZodLazy,...B(t)});class Te extends q{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return S(t,{received:t.data,code:A.invalid_literal,expected:this._def.value}),N}return{status:"valid",value:e.data}}get value(){return this._def.value}}function Ee(e,t){return new ke({values:e,typeName:Be.ZodEnum,...B(t)})}Te.create=(e,t)=>new Te({value:e,typeName:Be.ZodLiteral,...B(t)});class ke extends q{_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),r=this._def.values;return S(t,{expected:v.joinValues(r),received:t.parsedType,code:A.invalid_type}),N}if(-1===this._def.values.indexOf(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return S(t,{received:t.data,code:A.invalid_enum_value,options:r}),N}return M(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return ke.create(e)}exclude(e){return ke.create(this.options.filter((t=>!e.includes(t))))}}ke.create=Ee;class je extends q{_parse(e){const t=v.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==x.string&&r.parsedType!==x.number){const e=v.objectValues(t);return S(r,{expected:v.joinValues(e),received:r.parsedType,code:A.invalid_type}),N}if(-1===t.indexOf(e.data)){const e=v.objectValues(t);return S(r,{received:r.data,code:A.invalid_enum_value,options:e}),N}return M(e.data)}get enum(){return this._def.values}}je.create=(e,t)=>new je({values:e,typeName:Be.ZodNativeEnum,...B(t)});class Se extends q{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==x.promise&&!1===t.common.async)return S(t,{code:A.invalid_type,expected:x.promise,received:t.parsedType}),N;const r=t.parsedType===x.promise?t.data:Promise.resolve(t.data);return M(r.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}Se.create=(e,t)=>new Se({type:e,typeName:Be.ZodPromise,...B(t)});class Ce extends q{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Be.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),n=this._def.effect||null,a={addIssue:e=>{S(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),"preprocess"===n.type){const e=n.transform(r.data,a);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(e).then((e=>this._def.schema._parseAsync({data:e,path:r.path,parent:r}))):this._def.schema._parseSync({data:e,path:r.path,parent:r})}if("refinement"===n.type){const e=e=>{const t=n.refinement(e,a);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===r.common.async){const n=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===n.status?N:("dirty"===n.status&&t.dirty(),e(n.value),{status:t.value,value:n.value})}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then((r=>"aborted"===r.status?N:("dirty"===r.status&&t.dirty(),e(r.value).then((()=>({status:t.value,value:r.value}))))))}if("transform"===n.type){if(!1===r.common.async){const e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!D(e))return e;const s=n.transform(e.value,a);if(s instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:s}}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then((e=>D(e)?Promise.resolve(n.transform(e.value,a)).then((e=>({status:t.value,value:e}))):e))}v.assertNever(n)}}Ce.create=(e,t,r)=>new Ce({schema:e,typeName:Be.ZodEffects,effect:t,...B(r)}),Ce.createWithPreprocess=(e,t,r)=>new Ce({schema:t,effect:{type:"preprocess",transform:e},typeName:Be.ZodEffects,...B(r)});class Ne extends q{_parse(e){return this._getType(e)===x.undefined?M(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ne.create=(e,t)=>new Ne({innerType:e,typeName:Be.ZodOptional,...B(t)});class Re extends q{_parse(e){return this._getType(e)===x.null?M(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Re.create=(e,t)=>new Re({innerType:e,typeName:Be.ZodNullable,...B(t)});class Me extends q{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===x.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Me.create=(e,t)=>new Me({innerType:e,typeName:Be.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...B(t)});class Le extends q{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return U(n)?n.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new I(r.common.issues)},input:r.data})}))):{status:"valid",value:"valid"===n.status?n.value:this._def.catchValue({get error(){return new I(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Le.create=(e,t)=>new Le({innerType:e,typeName:Be.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...B(t)});class Ze extends q{_parse(e){if(this._getType(e)!==x.nan){const t=this._getOrReturnCtx(e);return S(t,{code:A.invalid_type,expected:x.nan,received:t.parsedType}),N}return{status:"valid",value:e.data}}}Ze.create=e=>new Ze({typeName:Be.ZodNaN,...B(e)});const De=Symbol("zod_brand");class Ue extends q{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class ze extends q{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?N:"dirty"===e.status?(t.dirty(),R(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})();{const e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?N:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new ze({in:e,out:t,typeName:Be.ZodPipeline})}}class $e extends q{_parse(e){const t=this._def.innerType._parse(e);return D(t)&&(t.value=Object.freeze(t.value)),t}}$e.create=(e,t)=>new $e({innerType:e,typeName:Be.ZodReadonly,...B(t)});const Ke=(e,t={},r)=>e?ue.create().superRefine(((n,a)=>{var s,i;if(!e(n)){const e="function"==typeof t?t(n):"string"==typeof t?{message:t}:t,o=null===(i=null!==(s=e.fatal)&&void 0!==s?s:r)||void 0===i||i,c="string"==typeof e?{message:e}:e;a.addIssue({code:"custom",...c,fatal:o})}})):ue.create(),Fe={object:me.lazycreate};var Be;!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(Be||(Be={}));const qe=ee.create,Ve=re.create,He=Ze.create,We=ne.create,Ye=ae.create,Je=se.create,Ge=ie.create,Xe=oe.create,Qe=ce.create,et=ue.create,tt=le.create,rt=de.create,nt=he.create,at=pe.create,st=me.create,it=me.strictCreate,ot=ge.create,ct=be.create,ut=_e.create,lt=we.create,dt=Oe.create,ht=xe.create,pt=Pe.create,ft=Ae.create,mt=Ie.create,gt=Te.create,yt=ke.create,bt=je.create,vt=Se.create,_t=Ce.create,wt=Ne.create,Ot=Re.create,xt=Ce.createWithPreprocess,Pt=ze.create,At={string:e=>ee.create({...e,coerce:!0}),number:e=>re.create({...e,coerce:!0}),boolean:e=>ae.create({...e,coerce:!0}),bigint:e=>ne.create({...e,coerce:!0}),date:e=>se.create({...e,coerce:!0})},It=N;var Tt=Object.freeze({__proto__:null,defaultErrorMap:T,setErrorMap:function(e){E=e},getErrorMap:k,makeIssue:j,EMPTY_PATH:[],addIssueToContext:S,ParseStatus:C,INVALID:N,DIRTY:R,OK:M,isAborted:L,isDirty:Z,isValid:D,isAsync:U,get util(){return v},get objectUtil(){return _},ZodParsedType:x,getParsedType:P,ZodType:q,ZodString:ee,ZodNumber:re,ZodBigInt:ne,ZodBoolean:ae,ZodDate:se,ZodSymbol:ie,ZodUndefined:oe,ZodNull:ce,ZodAny:ue,ZodUnknown:le,ZodNever:de,ZodVoid:he,ZodArray:pe,ZodObject:me,ZodUnion:ge,ZodDiscriminatedUnion:be,ZodIntersection:_e,ZodTuple:we,ZodRecord:Oe,ZodMap:xe,ZodSet:Pe,ZodFunction:Ae,ZodLazy:Ie,ZodLiteral:Te,ZodEnum:ke,ZodNativeEnum:je,ZodPromise:Se,ZodEffects:Ce,ZodTransformer:Ce,ZodOptional:Ne,ZodNullable:Re,ZodDefault:Me,ZodCatch:Le,ZodNaN:Ze,BRAND:De,ZodBranded:Ue,ZodPipeline:ze,ZodReadonly:$e,custom:Ke,Schema:q,ZodSchema:q,late:Fe,get ZodFirstPartyTypeKind(){return Be},coerce:At,any:et,array:at,bigint:We,boolean:Ye,date:Je,discriminatedUnion:ct,effect:_t,enum:yt,function:ft,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>Ke((t=>t instanceof e),t),intersection:ut,lazy:mt,literal:gt,map:ht,nan:He,nativeEnum:bt,never:rt,null:Qe,nullable:Ot,number:Ve,object:st,oboolean:()=>Ye().optional(),onumber:()=>Ve().optional(),optional:wt,ostring:()=>qe().optional(),pipeline:Pt,preprocess:xt,promise:vt,record:dt,set:pt,strictObject:it,string:qe,symbol:Ge,transformer:_t,tuple:lt,undefined:Xe,union:ot,unknown:tt,void:nt,NEVER:It,ZodIssueCode:A,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:I}),Et=r(8841),kt=r(8869);class jt extends kt.bI{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){return new this(Tt.object(Object.fromEntries(Object.entries(e).map((([e,t])=>[e,Tt.string().describe(t)])))))}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.\n\n"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.\n\nFor example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}\nwould match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.\nThus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.\n\nYour output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!\n\nHere is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:\n\`\`\`json\n${JSON.stringify((0,Et.Y_)(this.schema))}\n\`\`\`\n`}async parse(e){try{const t=e.includes("```")?e.trim().split(/```(?:json)?/)[1]:e.trim();return await this.schema.parseAsync(JSON.parse(t))}catch(t){throw new kt.dS(`Failed to parse. Text: "${e}". Error: ${t}`,e)}}}function St(e){return null==e}var Ct={isNothing:St,isObject:function(e){return"object"==typeof e&&null!==e},toArray:function(e){return Array.isArray(e)?e:St(e)?[]:[e]},repeat:function(e,t){var r,n="";for(r=0;r<t;r+=1)n+=e;return n},isNegativeZero:function(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e},extend:function(e,t){var r,n,a,s;if(t)for(r=0,n=(s=Object.keys(t)).length;r<n;r+=1)e[a=s[r]]=t[a];return e}};function Nt(e,t){var r="",n=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(r+='in "'+e.mark.name+'" '),r+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(r+="\n\n"+e.mark.snippet),n+" "+r):n}function Rt(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=Nt(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}Rt.prototype=Object.create(Error.prototype),Rt.prototype.constructor=Rt,Rt.prototype.toString=function(e){return this.name+": "+Nt(this,e)};var Mt=Rt;var Lt=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],Zt=["scalar","sequence","mapping"],Dt=function(e,t){if(t=t||{},Object.keys(t).forEach((function(t){if(-1===Lt.indexOf(t))throw new Mt('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')})),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=function(e){var t={};return null!==e&&Object.keys(e).forEach((function(r){e[r].forEach((function(e){t[String(e)]=r}))})),t}(t.styleAliases||null),-1===Zt.indexOf(this.kind))throw new Mt('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')};function Ut(e,t){var r=[];return e[t].forEach((function(e){var t=r.length;r.forEach((function(r,n){r.tag===e.tag&&r.kind===e.kind&&r.multi===e.multi&&(t=n)})),r[t]=e})),r}function zt(e){return this.extend(e)}zt.prototype.extend=function(e){var t=[],r=[];if(e instanceof Dt)r.push(e);else if(Array.isArray(e))r=r.concat(e);else{if(!e||!Array.isArray(e.implicit)&&!Array.isArray(e.explicit))throw new Mt("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(r=r.concat(e.explicit))}t.forEach((function(e){if(!(e instanceof Dt))throw new Mt("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(e.loadKind&&"scalar"!==e.loadKind)throw new Mt("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(e.multi)throw new Mt("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")})),r.forEach((function(e){if(!(e instanceof Dt))throw new Mt("Specified list of YAML types (or a single Type object) contains a non-Type object.")}));var n=Object.create(zt.prototype);return n.implicit=(this.implicit||[]).concat(t),n.explicit=(this.explicit||[]).concat(r),n.compiledImplicit=Ut(n,"implicit"),n.compiledExplicit=Ut(n,"explicit"),n.compiledTypeMap=function(){var e,t,r={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function n(e){e.multi?(r.multi[e.kind].push(e),r.multi.fallback.push(e)):r[e.kind][e.tag]=r.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(n);return r}(n.compiledImplicit,n.compiledExplicit),n};var $t=new zt({explicit:[new Dt("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}}),new Dt("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}}),new Dt("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}})]}),Kt=new Dt("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),Ft=new Dt("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function Bt(e){return 48<=e&&e<=55}function qt(e){return 48<=e&&e<=57}var Vt=new Dt("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,r,n=e.length,a=0,s=!1;if(!n)return!1;if("-"!==(t=e[a])&&"+"!==t||(t=e[++a]),"0"===t){if(a+1===n)return!0;if("b"===(t=e[++a])){for(a++;a<n;a++)if("_"!==(t=e[a])){if("0"!==t&&"1"!==t)return!1;s=!0}return s&&"_"!==t}if("x"===t){for(a++;a<n;a++)if("_"!==(t=e[a])){if(!(48<=(r=e.charCodeAt(a))&&r<=57||65<=r&&r<=70||97<=r&&r<=102))return!1;s=!0}return s&&"_"!==t}if("o"===t){for(a++;a<n;a++)if("_"!==(t=e[a])){if(!Bt(e.charCodeAt(a)))return!1;s=!0}return s&&"_"!==t}}if("_"===t)return!1;for(;a<n;a++)if("_"!==(t=e[a])){if(!qt(e.charCodeAt(a)))return!1;s=!0}return!(!s||"_"===t)},construct:function(e){var t,r=e,n=1;if(-1!==r.indexOf("_")&&(r=r.replace(/_/g,"")),"-"!==(t=r[0])&&"+"!==t||("-"===t&&(n=-1),t=(r=r.slice(1))[0]),"0"===r)return 0;if("0"===t){if("b"===r[1])return n*parseInt(r.slice(2),2);if("x"===r[1])return n*parseInt(r.slice(2),16);if("o"===r[1])return n*parseInt(r.slice(2),8)}return n*parseInt(r,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!Ct.isNegativeZero(e)},represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),Ht=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),Wt=/^[-+]?[0-9]+e/,Yt=new Dt("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return null!==e&&!(!Ht.test(e)||"_"===e[e.length-1])},construct:function(e){var t,r;return r="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===r?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:r*parseFloat(t,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||Ct.isNegativeZero(e))},represent:function(e,t){var r;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Ct.isNegativeZero(e))return"-0.0";return r=e.toString(10),Wt.test(r)?r.replace("e",".e"):r},defaultStyle:"lowercase"}),Jt=$t.extend({implicit:[Kt,Ft,Vt,Yt]}),Gt=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),Xt=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),Qt=new Dt("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&(null!==Gt.exec(e)||null!==Xt.exec(e))},construct:function(e){var t,r,n,a,s,i,o,c,u=0,l=null;if(null===(t=Gt.exec(e))&&(t=Xt.exec(e)),null===t)throw new Error("Date resolve error");if(r=+t[1],n=+t[2]-1,a=+t[3],!t[4])return new Date(Date.UTC(r,n,a));if(s=+t[4],i=+t[5],o=+t[6],t[7]){for(u=t[7].slice(0,3);u.length<3;)u+="0";u=+u}return t[9]&&(l=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(l=-l)),c=new Date(Date.UTC(r,n,a,s,i,o,u)),l&&c.setTime(c.getTime()-l),c},instanceOf:Date,represent:function(e){return e.toISOString()}}),er=new Dt("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}}),tr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",rr=new Dt("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,r,n=0,a=e.length,s=tr;for(r=0;r<a;r++)if(!((t=s.indexOf(e.charAt(r)))>64)){if(t<0)return!1;n+=6}return n%8==0},construct:function(e){var t,r,n=e.replace(/[\r\n=]/g,""),a=n.length,s=tr,i=0,o=[];for(t=0;t<a;t++)t%4==0&&t&&(o.push(i>>16&255),o.push(i>>8&255),o.push(255&i)),i=i<<6|s.indexOf(n.charAt(t));return 0==(r=a%4*6)?(o.push(i>>16&255),o.push(i>>8&255),o.push(255&i)):18===r?(o.push(i>>10&255),o.push(i>>2&255)):12===r&&o.push(i>>4&255),new Uint8Array(o)},predicate:function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)},represent:function(e){var t,r,n="",a=0,s=e.length,i=tr;for(t=0;t<s;t++)t%3==0&&t&&(n+=i[a>>18&63],n+=i[a>>12&63],n+=i[a>>6&63],n+=i[63&a]),a=(a<<8)+e[t];return 0==(r=s%3)?(n+=i[a>>18&63],n+=i[a>>12&63],n+=i[a>>6&63],n+=i[63&a]):2===r?(n+=i[a>>10&63],n+=i[a>>4&63],n+=i[a<<2&63],n+=i[64]):1===r&&(n+=i[a>>2&63],n+=i[a<<4&63],n+=i[64],n+=i[64]),n}}),nr=Object.prototype.hasOwnProperty,ar=Object.prototype.toString,sr=new Dt("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,r,n,a,s,i=[],o=e;for(t=0,r=o.length;t<r;t+=1){if(n=o[t],s=!1,"[object Object]"!==ar.call(n))return!1;for(a in n)if(nr.call(n,a)){if(s)return!1;s=!0}if(!s)return!1;if(-1!==i.indexOf(a))return!1;i.push(a)}return!0},construct:function(e){return null!==e?e:[]}}),ir=Object.prototype.toString,or=new Dt("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,r,n,a,s,i=e;for(s=new Array(i.length),t=0,r=i.length;t<r;t+=1){if(n=i[t],"[object Object]"!==ir.call(n))return!1;if(1!==(a=Object.keys(n)).length)return!1;s[t]=[a[0],n[a[0]]]}return!0},construct:function(e){if(null===e)return[];var t,r,n,a,s,i=e;for(s=new Array(i.length),t=0,r=i.length;t<r;t+=1)n=i[t],a=Object.keys(n),s[t]=[a[0],n[a[0]]];return s}}),cr=Object.prototype.hasOwnProperty,ur=new Dt("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){if(null===e)return!0;var t,r=e;for(t in r)if(cr.call(r,t)&&null!==r[t])return!1;return!0},construct:function(e){return null!==e?e:{}}});Jt.extend({implicit:[Qt,er],explicit:[rr,sr,or,ur]}),Object.prototype.hasOwnProperty;function lr(e){return 48===e?"\0":97===e?"":98===e?"\b":116===e||9===e?"\t":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"":95===e?" ":76===e?"\u2028":80===e?"\u2029":""}for(var dr=new Array(256),hr=new Array(256),pr=0;pr<256;pr++)dr[pr]=lr(pr)?1:0,hr[pr]=lr(pr);Object.prototype.toString,Object.prototype.hasOwnProperty;function fr(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}function mr(e,t){let r=0,n=0,a=0;for(let s=0;s<e.length;s++)r+=e[s]*t[s],n+=e[s]*e[s],a+=t[s]*t[s];return r/(Math.sqrt(n)*Math.sqrt(a))}fr("safeLoad","load"),fr("safeLoadAll","loadAll"),fr("safeDump","dump"),r(2587),r(7513),r(6563),Object.prototype.toString;var gr=r(1512);class yr extends m.eq{constructor(e){super(e),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.callbacks=e?.callbacks,this.tags=e?.tags??[],this.metadata=e?.metadata??{},this.verbose=e?.verbose??!1}_getRelevantDocuments(e,t){throw new Error("Not implemented!")}async invoke(e,t){return this.getRelevantDocuments(e,t)}async getRelevantDocuments(e,t){const r=(0,gr.QH)(t),n=await gr.Ye.configure(r.callbacks,this.callbacks,r.tags,this.tags,r.metadata,this.metadata,{verbose:this.verbose}),a=await(n?.handleRetrieverStart(this.toJSON(),e));try{const t=await this._getRelevantDocuments(e,a);return await(a?.handleRetrieverEnd(t)),t}catch(e){throw await(a?.handleRetrieverError(e)),e}}}var br=r(2385);class vr extends yr{static lc_name(){return"VectorStoreRetriever"}get lc_namespace(){return["langchain","retrievers","base"]}_vectorstoreType(){return this.vectorStore._vectorstoreType()}constructor(e){super(e),Object.defineProperty(this,"vectorStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"searchType",{enumerable:!0,configurable:!0,writable:!0,value:"similarity"}),Object.defineProperty(this,"searchKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.vectorStore=e.vectorStore,this.k=e.k??this.k,this.searchType=e.searchType??this.searchType,this.filter=e.filter,"mmr"===e.searchType&&(this.searchKwargs=e.searchKwargs)}async _getRelevantDocuments(e,t){if("mmr"===this.searchType){if("function"!=typeof this.vectorStore.maxMarginalRelevanceSearch)throw new Error(`The vector store backing this retriever, ${this._vectorstoreType()} does not support max marginal relevance search.`);return this.vectorStore.maxMarginalRelevanceSearch(e,{k:this.k,filter:this.filter,...this.searchKwargs},t?.getChild("vectorstore"))}return this.vectorStore.similaritySearch(e,this.k,this.filter,t?.getChild("vectorstore"))}async addDocuments(e,t){return this.vectorStore.addDocuments(e,t)}}class _r extends br.i{constructor(e,t){super(t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","vectorstores",this._vectorstoreType()]}),Object.defineProperty(this,"embeddings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.embeddings=e}async delete(e){throw new Error("Not implemented.")}async similaritySearch(e,t=4,r=void 0,n=void 0){return(await this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),t,r)).map((e=>e[0]))}async similaritySearchWithScore(e,t=4,r=void 0,n=void 0){return this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),t,r)}static fromTexts(e,t,r,n){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}static fromDocuments(e,t,r){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}asRetriever(e,t,r,n,a,s){if("number"==typeof e)return new vr({vectorStore:this,k:e,filter:t,tags:[...n??[],this._vectorstoreType()],metadata:a,verbose:s,callbacks:r});{const t={vectorStore:this,k:e?.k,filter:e?.filter,tags:[...e?.tags??[],this._vectorstoreType()],metadata:e?.metadata,verbose:e?.verbose,callbacks:e?.callbacks,searchType:e?.searchType};return new vr("mmr"===e?.searchType?{...t,searchKwargs:e.searchKwargs}:{...t})}}}class wr extends _r{_vectorstoreType(){return"memory"}constructor(e,{similarity:t,...r}={}){super(e,r),Object.defineProperty(this,"memoryVectors",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"similarity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.similarity=t??mr}async addDocuments(e){const t=e.map((({pageContent:e})=>e));return this.addVectors(await this.embeddings.embedDocuments(t),e)}async addVectors(e,t){const r=e.map(((e,r)=>({content:t[r].pageContent,embedding:e,metadata:t[r].metadata})));this.memoryVectors=this.memoryVectors.concat(r)}async similaritySearchVectorWithScore(e,t,r){const n=this.memoryVectors.filter((e=>{if(!r)return!0;const t=new f({metadata:e.metadata,pageContent:e.content});return r(t)}));return n.map(((t,r)=>({similarity:this.similarity(e,t.embedding),index:r}))).sort(((e,t)=>e.similarity>t.similarity?-1:0)).slice(0,t).map((e=>[new f({metadata:n[e.index].metadata,pageContent:n[e.index].content}),e.similarity]))}static async fromTexts(e,t,r,n){const a=[];for(let r=0;r<e.length;r+=1){const n=Array.isArray(t)?t[r]:t,s=new f({pageContent:e[r],metadata:n});a.push(s)}return wr.fromDocuments(a,r,n)}static async fromDocuments(e,t,r){const n=new this(t,r);return await n.addDocuments(e),n}static async fromExistingIndex(e,t){return new this(e,t)}}var Or=r(5606),xr=r(4427);class Pr{constructor(e){Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.caller=new d.L(e??{})}}var Ar=r(3153);class Ir extends Pr{constructor(e,t){const r={maxConcurrency:2,...e};super(r),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"text-embedding-ada-002"}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:512}),Object.defineProperty(this,"stripNewLines",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const n=r?.openAIApiKey??(0,Or.lS)("OPENAI_API_KEY"),a=r?.azureOpenAIApiKey??(0,Or.lS)("AZURE_OPENAI_API_KEY");if(!a&&!n)throw new Error("OpenAI or Azure OpenAI API key not found");const s=r?.azureOpenAIApiInstanceName??(0,Or.lS)("AZURE_OPENAI_API_INSTANCE_NAME"),i=(r?.azureOpenAIApiEmbeddingsDeploymentName||r?.azureOpenAIApiDeploymentName)??((0,Or.lS)("AZURE_OPENAI_API_EMBEDDINGS_DEPLOYMENT_NAME")||(0,Or.lS)("AZURE_OPENAI_API_DEPLOYMENT_NAME")),o=r?.azureOpenAIApiVersion??(0,Or.lS)("AZURE_OPENAI_API_VERSION");if(this.azureOpenAIBasePath=r?.azureOpenAIBasePath??(0,Or.lS)("AZURE_OPENAI_BASE_PATH"),this.modelName=r?.modelName??this.modelName,this.batchSize=r?.batchSize??(a?1:this.batchSize),this.stripNewLines=r?.stripNewLines??this.stripNewLines,this.timeout=r?.timeout,this.azureOpenAIApiVersion=o,this.azureOpenAIApiKey=a,this.azureOpenAIApiInstanceName=s,this.azureOpenAIApiDeploymentName=i,this.azureOpenAIApiKey){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found")}this.clientConfig={apiKey:n,...t}}async embedDocuments(e){const t=(0,xr.F)(this.stripNewLines?e.map((e=>e.replace(/\n/g," "))):e,this.batchSize),r=t.map((e=>this.embeddingWithRetry({model:this.modelName,input:e}))),n=await Promise.all(r),a=[];for(let e=0;e<n.length;e+=1){const r=t[e],{data:s}=n[e];for(let e=0;e<r.length;e+=1)a.push(s.data[e].embedding)}return a}async embedQuery(e){const{data:t}=await this.embeddingWithRetry({model:this.modelName,input:this.stripNewLines?e.replace(/\n/g," "):e});return t.data[0].embedding}async embeddingWithRetry(e){if(!this.client){const e={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,basePath:this.clientConfig.basePath},t=(0,Ar.O)(e),r=new w.Configuration({...this.clientConfig,basePath:t,baseOptions:{timeout:this.timeout,adapter:(0,Or.UG)()?void 0:O.Z,...this.clientConfig.baseOptions}});this.client=new w.OpenAIApi(r)}const t={};return this.azureOpenAIApiKey&&(t.headers={"api-key":this.azureOpenAIApiKey,...t.headers},t.params={"api-version":this.azureOpenAIApiVersion,...t.params}),this.caller.call(this.client.createEmbedding.bind(this.client),e,t)}}const Tr="4.4.0";class Er{constructor(e,t){this.response=e,this.controller=t,this.decoder=new kr}async*iterMessages(){if(!this.response.body)throw this.controller.abort(),new Error("Attempted to iterate over a response with no body");const e=new jr,t=function(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const e=await t.read();return(null==e?void 0:e.done)&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){const e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}(this.response.body);for await(const r of t)for(const t of e.decode(r)){const e=this.decoder.decode(t);e&&(yield e)}for(const t of e.flush()){const e=this.decoder.decode(t);e&&(yield e)}}async*[Symbol.asyncIterator](){let e=!1;try{for await(const t of this.iterMessages())if(!e)if(t.data.startsWith("[DONE]"))e=!0;else if(null===t.event)try{yield JSON.parse(t.data)}catch(e){throw console.error("Could not parse message into JSON:",t.data),console.error("From chunk:",t.raw),e}e=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{e||this.controller.abort()}}}class kr{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,n]=function(e,t){const r=e.indexOf(":");return-1!==r?[e.substring(0,r),":",e.substring(r+1)]:[e,"",""]}(e);return n.startsWith(" ")&&(n=n.substring(1)),"event"===t?this.event=n:"data"===t&&this.data.push(n),null}}class jr{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const r=jr.NEWLINE_CHARS.has(t[t.length-1]||"");let n=t.split(jr.NEWLINE_REGEXP);return 1!==n.length||r?(this.buffer.length>0&&(n=[this.buffer.join("")+n[0],...n.slice(1)],this.buffer=[]),r||(this.buffer=[n.pop()||""]),n):(this.buffer.push(n[0]),[])}decodeText(e){var t;if(null==e)return"";if("string"==typeof e)return e;if("undefined"!=typeof Buffer){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new Error(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return null!==(t=this.textDecoder)&&void 0!==t||(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new Error(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new Error("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}jr.NEWLINE_CHARS=new Set(["\n","\r","\v","\f","","","","","\u2028","\u2029"]),jr.NEWLINE_REGEXP=/\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g;class Sr extends Error{constructor(e,t,r,n){super(Sr.makeMessage(t,r)),this.status=e,this.headers=n;const a=t;this.error=a,this.code=null==a?void 0:a.code,this.param=null==a?void 0:a.param,this.type=null==a?void 0:a.type}static makeMessage(e,t){return(null==e?void 0:e.message)?"string"==typeof e.message?e.message:JSON.stringify(e.message):e?JSON.stringify(e):t||"Unknown error occurred"}static generate(e,t,r,n){if(!e)return new Nr({cause:On(t)});const a=null==t?void 0:t.error;return 400===e?new Mr(e,a,r,n):401===e?new Lr(e,a,r,n):403===e?new Zr(e,a,r,n):404===e?new Dr(e,a,r,n):409===e?new Ur(e,a,r,n):422===e?new zr(e,a,r,n):429===e?new $r(e,a,r,n):e>=500?new Kr(e,a,r,n):new Sr(e,a,r,n)}}class Cr extends Sr{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class Nr extends Sr{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,t&&(this.cause=t)}}class Rr extends Nr{constructor(){super({message:"Request timed out."})}}class Mr extends Sr{constructor(){super(...arguments),this.status=400}}class Lr extends Sr{constructor(){super(...arguments),this.status=401}}class Zr extends Sr{constructor(){super(...arguments),this.status=403}}class Dr extends Sr{constructor(){super(...arguments),this.status=404}}class Ur extends Sr{constructor(){super(...arguments),this.status=409}}class zr extends Sr{constructor(){super(...arguments),this.status=422}}class $r extends Sr{constructor(){super(...arguments),this.status=429}}class Kr extends Sr{}const Fr=fetch.bind(void 0),Br=FormData,qr="undefined"!=typeof File?File:class extends Blob{constructor(){throw new Error("file uploads aren't supported in this environment yet as 'File' is not defined")}};async function Vr(){throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")}const Hr=e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob,Wr=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer;async function Yr(e,t,r={}){var n,a,s;if(e=await e,Hr(e)){const a=await e.blob();return t||(t=null!==(n=new URL(e.url).pathname.split(/[\\/]/).pop())&&void 0!==n?n:"unknown_file"),new qr([a],t,r)}const i=await async function(e){var t;let r=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)r.push(e);else if(Wr(e))r.push(await e.arrayBuffer());else{if(!Gr(e))throw new Error(`Unexpected data type: ${typeof e}; constructor: ${null===(t=null==e?void 0:e.constructor)||void 0===t?void 0:t.name}; props: ${function(e){return`[${Object.getOwnPropertyNames(e).map((e=>`"${e}"`)).join(", ")}]`}(e)}`);for await(const t of e)r.push(t)}return r}(e);if(t||(t=null!==(a=function(e){var t;return Jr(e.name)||Jr(e.filename)||(null===(t=Jr(e.path))||void 0===t?void 0:t.split(/[\\/]/).pop())}(e))&&void 0!==a?a:"unknown_file"),!r.type){const e=null===(s=i[0])||void 0===s?void 0:s.type;"string"==typeof e&&(r={...r,type:e})}return new qr(i,t,r)}const Jr=e=>"string"==typeof e?e:"undefined"!=typeof Buffer&&e instanceof Buffer?String(e):void 0,Gr=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator];class Xr{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}const Qr=e=>e&&"object"==typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag],en=async e=>async function(e,t){return{...t,body:new Xr(e)}}(await tn(e.body),e),tn=async e=>{const t=new Br;return await Promise.all(Object.entries(e||{}).map((([e,r])=>rn(t,e,r)))),t},rn=async(e,t,r)=>{if(void 0!==r){if(null==r)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof r||"number"==typeof r||"boolean"==typeof r)e.append(t,String(r));else if((e=>(e=>null!=e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&Wr(e))(e)||Hr(e)||!1)(r)){const n=await Yr(r);e.append(t,n)}else if(Array.isArray(r))await Promise.all(r.map((r=>rn(e,t+"[]",r))));else{if("object"!=typeof r)throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`);await Promise.all(Object.entries(r).map((([r,n])=>rn(e,`${t}[${r}]`,n))))}}};var nn;async function an(e){const{response:t}=e;if(e.options.stream)return new Er(t,e.controller);const r=t.headers.get("content-type");if(null==r?void 0:r.includes("application/json")){const e=await t.json();return An("response",t.status,t.url,t.headers,e),e}const n=await t.text();return An("response",t.status,t.url,t.headers,n),n}class sn extends Promise{constructor(e,t=an){super((e=>{e(null)})),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new sn(this.responsePromise,(async t=>e(await this.parseResponse(t))))}asResponse(){return this.responsePromise.then((e=>e.response))}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class on{constructor({baseURL:e,maxRetries:t,timeout:r=6e5,httpAgent:n,fetch:a}){this.baseURL=e,this.maxRetries=wn("maxRetries",null!=t?t:2),this.timeout=wn("timeout",r),this.httpAgent=n,this.fetch=null!=a?a:Fr}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...gn(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${In()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then((r=>({method:e,path:t,...r}))))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if("string"==typeof e){if("undefined"!=typeof Buffer)return Buffer.byteLength(e,"utf8").toString();if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e).length.toString()}return null}buildRequest(e){var t,r,n,a,s,i;const{method:o,path:c,query:u,headers:l={}}=e,d=Qr(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,h=this.calculateContentLength(d),p=this.buildURL(c,u);"timeout"in e&&wn("timeout",e.timeout);const f=null!==(t=e.timeout)&&void 0!==t?t:this.timeout,m=null!==(n=null!==(r=e.httpAgent)&&void 0!==r?r:this.httpAgent)&&void 0!==n?n:void 0,g=f+1e3;"number"==typeof(null===(a=null==m?void 0:m.options)||void 0===a?void 0:a.timeout)&&g>(null!==(s=m.options.timeout)&&void 0!==s?s:0)&&(m.options.timeout=g),this.idempotencyHeader&&"get"!==o&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const y={...h&&{"Content-Length":h},...this.defaultHeaders(e),...l};Qr(e.body)&&delete y["Content-Type"],Object.keys(y).forEach((e=>null===y[e]&&delete y[e]));const b={method:o,...d&&{body:d},headers:y,...m&&{agent:m},signal:null!==(i=e.signal)&&void 0!==i?i:null};return this.validateHeaders(y,l),{req:b,url:p,timeout:f}}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map((e=>[...e]))):{...e}:{}}makeStatusError(e,t,r,n){return Sr.generate(e,t,r,n)}request(e,t=null){return new sn(this.makeRequest(e,t))}async makeRequest(e,t){var r,n,a;const s=await e;null==t&&(t=null!==(r=s.maxRetries)&&void 0!==r?r:this.maxRetries);const{req:i,url:o,timeout:c}=this.buildRequest(s);if(await this.prepareRequest(i,{url:o,options:s}),An("request",o,s,i.headers),null===(n=s.signal)||void 0===n?void 0:n.aborted)throw new Cr;const u=new AbortController,l=await this.fetchWithTimeout(o,i,c,u).catch(On);if(l instanceof Error){if(null===(a=s.signal)||void 0===a?void 0:a.aborted)throw new Cr;if(t)return this.retryRequest(s,t);if("AbortError"===l.name)throw new Rr;throw new Nr({cause:l})}const d=ln(l.headers);if(!l.ok){if(t&&this.shouldRetry(l))return this.retryRequest(s,t,d);const e=await l.text().catch((()=>"Unknown")),r=yn(e),n=r?void 0:e;throw An("response",l.status,o,d,n),this.makeStatusError(l.status,r,n,d)}return{response:l,options:s,controller:u}}requestAPIList(e,t){const r=this.makeRequest(t,null);return new un(this,r,e)}buildURL(e,t){const r=vn(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),n=this.defaultQuery();return Pn(n)||(t={...n,...t}),t&&(r.search=this.stringifyQuery(t)),r.toString()}stringifyQuery(e){return Object.entries(e).filter((([e,t])=>void 0!==t)).map((([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new Error(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)})).join("&")}async fetchWithTimeout(e,t,r,n){const{signal:a,...s}=t||{};a&&a.addEventListener("abort",(()=>n.abort()));const i=setTimeout((()=>n.abort()),r);return this.getRequestClient().fetch(e,{signal:n.signal,...s}).finally((()=>{clearTimeout(i)}))}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(409===e.status||429===e.status||e.status>=500)}async retryRequest(e,t,r){var n;t-=1;const a=parseInt((null==r?void 0:r["retry-after"])||""),s=null!==(n=e.maxRetries)&&void 0!==n?n:this.maxRetries,i=1e3*this.calculateRetryTimeoutSeconds(t,a,s);return await _n(i),this.makeRequest(e,t)}calculateRetryTimeoutSeconds(e,t,r){if(Number.isInteger(t)&&t<=60)return t;const n=r-e;return Math.min(.5*Math.pow(n-1,2),2)+(Math.random()-.5)}getUserAgent(){return`${this.constructor.name}/JS ${Tr}`}}class cn{constructor(e,t,r,n){nn.set(this,void 0),function(e,t,r,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===n?a.call(e,r):a?a.value=r:t.set(e,r)}(this,nn,e,"f"),this.options=n,this.response=t,this.body=r}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new Error("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e)t.query={...t.query,...e.params};else if("url"in e){const r=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[t,n]of r)e.url.searchParams.set(t,n);t.query=void 0,t.path=e.url.toString()}return await function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}(this,nn,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(nn=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class un extends sn{constructor(e,t,r){super(t,(async t=>new r(e,t.response,await an(t),t.options)))}async*[Symbol.asyncIterator](){const e=await(this);for await(const t of e)yield t}}const ln=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){const r=t.toString();return e[r.toLowerCase()]||e[r]}}),dn={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0},hn=e=>"object"==typeof e&&null!==e&&!Pn(e)&&Object.keys(e).every((e=>function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(dn,e))),pn=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",fn=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown";let mn;const gn=()=>null!=mn?mn:mn=(()=>{if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Tr,"X-Stainless-OS":fn(Deno.build.os),"X-Stainless-Arch":pn(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":Deno.version};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Tr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if("[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Tr,"X-Stainless-OS":fn(process.platform),"X-Stainless-Arch":pn(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const e=function(){if("undefined"==typeof navigator||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:r}of e){const e=r.exec(navigator.userAgent);if(e)return{browser:t,version:`${e[1]||0}.${e[2]||0}.${e[3]||0}`}}return null}();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Tr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Tr,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}})(),yn=e=>{try{return JSON.parse(e)}catch(e){return}},bn=new RegExp("^(?:[a-z]+:)?//","i"),vn=e=>bn.test(e),_n=e=>new Promise((t=>setTimeout(t,e))),wn=(e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new Error(`${e} must be an integer`);if(t<0)throw new Error(`${e} must be a positive integer`);return t},On=e=>e instanceof Error?e:new Error(e),xn=e=>{var t,r,n,a;return"undefined"!=typeof process?null!==(r=null===(t=process.env)||void 0===t?void 0:t[e])&&void 0!==r?r:void 0:"undefined"!=typeof Deno?null===(a=null===(n=Deno.env)||void 0===n?void 0:n.get)||void 0===a?void 0:a.call(n,e):void 0};function Pn(e){if(!e)return!0;for(const t in e)return!1;return!0}function An(e,...t){"undefined"!=typeof process&&"true"===process.env.DEBUG&&console.log(`OpenAI:DEBUG:${e}`,...t)}const In=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}));class Tn extends cn{constructor(e,t,r,n){super(e,t,r,n),this.object=r.object,this.data=r.data}getPaginatedItems(){return this.data}nextPageParams(){return null}nextPageInfo(){return null}}class En extends cn{constructor(e,t,r,n){super(e,t,r,n),this.data=r.data}getPaginatedItems(){return this.data}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var e,t;if(!(null===(e=this.data)||void 0===e?void 0:e.length))return null;const r=null===(t=this.data[this.data.length-1])||void 0===t?void 0:t.id;return r?{params:{after:r}}:null}}class kn{constructor(e){this.client=e,this.get=e.get.bind(e),this.post=e.post.bind(e),this.patch=e.patch.bind(e),this.put=e.put.bind(e),this.delete=e.delete.bind(e),this.getAPIList=e.getAPIList.bind(e)}}class jn extends kn{create(e,t){return this.post("/audio/transcriptions",en({body:e,...t}))}}jn||(jn={});class Sn extends kn{create(e,t){return this.post("/audio/translations",en({body:e,...t}))}}Sn||(Sn={});class Cn extends kn{constructor(){super(...arguments),this.transcriptions=new jn(this.client),this.translations=new Sn(this.client)}}!function(e){e.Transcriptions=jn,e.Translations=Sn}(Cn||(Cn={}));class Nn extends kn{create(e,t){var r;return this.post("/chat/completions",{body:e,...t,stream:null!==(r=e.stream)&&void 0!==r&&r})}}Nn||(Nn={});class Rn extends kn{constructor(){super(...arguments),this.completions=new Nn(this.client)}}!function(e){e.Completions=Nn}(Rn||(Rn={}));class Mn extends kn{create(e,t){var r;return this.post("/completions",{body:e,...t,stream:null!==(r=e.stream)&&void 0!==r&&r})}}Mn||(Mn={});class Ln extends kn{create(e,t){return this.post("/embeddings",{body:e,...t})}}Ln||(Ln={});class Zn extends kn{create(e,t){return this.post("/edits",{body:e,...t})}}Zn||(Zn={});class Dn extends kn{create(e,t){return this.post("/files",en({body:e,...t}))}retrieve(e,t){return this.get(`/files/${e}`,t)}list(e){return this.getAPIList("/files",Un,e)}del(e,t){return this.delete(`/files/${e}`,t)}retrieveContent(e,t){return this.get(`/files/${e}/content`,{...t,headers:{Accept:"application/json",...null==t?void 0:t.headers}})}}class Un extends Tn{}Dn||(Dn={});class zn extends kn{create(e,t){return this.post("/fine-tunes",{body:e,...t})}retrieve(e,t){return this.get(`/fine-tunes/${e}`,t)}list(e){return this.getAPIList("/fine-tunes",$n,e)}cancel(e,t){return this.post(`/fine-tunes/${e}/cancel`,t)}listEvents(e,t,r){var n;return this.get(`/fine-tunes/${e}/events`,{query:t,timeout:864e5,...r,stream:null!==(n=null==t?void 0:t.stream)&&void 0!==n&&n})}}class $n extends Tn{}zn||(zn={});class Kn extends kn{create(e,t){return this.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return hn(e)?this.list({},e):this.getAPIList("/fine_tuning/jobs",Fn,{query:e,...t})}cancel(e,t){return this.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},r){return hn(t)?this.listEvents(e,{},t):this.getAPIList(`/fine_tuning/jobs/${e}/events`,Bn,{query:t,...r})}}class Fn extends En{}class Bn extends En{}Kn||(Kn={});class qn extends kn{constructor(){super(...arguments),this.jobs=new Kn(this.client)}}!function(e){e.Jobs=Kn,e.FineTuningJobsPage=Fn,e.FineTuningJobEventsPage=Bn}(qn||(qn={}));class Vn extends kn{createVariation(e,t){return this.post("/images/variations",en({body:e,...t}))}edit(e,t){return this.post("/images/edits",en({body:e,...t}))}generate(e,t){return this.post("/images/generations",{body:e,...t})}}Vn||(Vn={});class Hn extends kn{retrieve(e,t){return this.get(`/models/${e}`,t)}list(e){return this.getAPIList("/models",Wn,e)}del(e,t){return this.delete(`/models/${e}`,t)}}class Wn extends Tn{}Hn||(Hn={});class Yn extends kn{create(e,t){return this.post("/moderations",{body:e,...t})}}var Jn;Yn||(Yn={});class Gn extends on{constructor(e){var t,r,{apiKey:n=xn("OPENAI_API_KEY"),organization:a=(null!==(t=xn("OPENAI_ORG_ID"))&&void 0!==t?t:null),...s}=void 0===e?{}:e;if(void 0===n)throw new Error("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'my apiKey' }).");const i={apiKey:n,organization:a,baseURL:"https://api.openai.com/v1",...s};if(!i.dangerouslyAllowBrowser&&"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator)throw new Error("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:i.baseURL,timeout:null!==(r=i.timeout)&&void 0!==r?r:6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new Mn(this),this.chat=new Rn(this),this.edits=new Zn(this),this.embeddings=new Ln(this),this.files=new Dn(this),this.images=new Vn(this),this.audio=new Cn(this),this.moderations=new Yn(this),this.models=new Hn(this),this.fineTuning=new qn(this),this.fineTunes=new zn(this),this._options=i,this.apiKey=n,this.organization=a}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}}Jn=Gn,Gn.OpenAI=Jn,Gn.APIError=Sr,Gn.APIConnectionError=Nr,Gn.APIConnectionTimeoutError=Rr,Gn.APIUserAbortError=Cr,Gn.NotFoundError=Dr,Gn.ConflictError=Ur,Gn.RateLimitError=$r,Gn.BadRequestError=Mr,Gn.AuthenticationError=Lr,Gn.InternalServerError=Kr,Gn.PermissionDeniedError=Zr,Gn.UnprocessableEntityError=zr;const{APIError:Xn,APIConnectionError:Qn,APIConnectionTimeoutError:ea,APIUserAbortError:ta,NotFoundError:ra,ConflictError:na,RateLimitError:aa,BadRequestError:sa,AuthenticationError:ia,InternalServerError:oa,PermissionDeniedError:ca,UnprocessableEntityError:ua}=e;!function(e){e.toFile=Yr,e.fileFromPath=Vr,e.Page=Tn,e.CursorPage=En,e.Completions=Mn,e.Chat=Rn,e.Edits=Zn,e.Embeddings=Ln,e.Files=Dn,e.FileObjectsPage=Un,e.Images=Vn,e.Audio=Cn,e.Moderations=Yn,e.Models=Hn,e.ModelsPage=Wn,e.FineTuning=qn,e.FineTunes=zn,e.FineTunesPage=$n}(Gn||(Gn={}));const la=Gn,da={"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET,HEAD,POST,OPTIONS,FETCH","Access-Control-Allow-Headers":"Content-Type"};addEventListener("fetch",(e=>{const t=new URL(e.request.url);var r;"OPTIONS"===e.request.method?e.respondWith(null!==(r=e.request).headers.get("Origin")&&null!==r.headers.get("Access-Control-Request-Method")&&null!==r.headers.get("Access-Control-Request-Headers")?new Response(null,{headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET,HEAD,POST,OPTIONS","Access-Control-Allow-Headers":"*"}}):new Response(null,{headers:{Allow:"POST,OPTIONS"}})):"GET"===e.request.method&&"/handleRequestAIChatGpt35"===t.pathname?e.respondWith(async function(e){try{console.warn("request-1",e),console.warn("request-2",e.url);const t=new URL(e.url),r=new URLSearchParams(t.search),n=r.get("prompt"),i=r.get("messages");console.log("prompt:",n),console.log("messages:",i);const c=azureApiKey,l=new a.ChatOpenAI({azureOpenAIApiKey:c,azureOpenAIApiInstanceName:"boardxai",azureOpenAIApiDeploymentName:"gpt35-16k",azureOpenAIApiVersion:"2023-06-01-preview",streaming:!0}),{readable:d,writable:p}=new TransformStream;let f=[];for(const e of i)"system"===e.role&&f.push(new s.jN(e.content)),"user"===e.role&&f.push(new s.xk(e.content)),"assistant"===e.role&&f.push(new s.gY(e.content));const m=new u({chatHistory:new o(f)}),g=new h({llm:l,memory:m}),y=p.getWriter(),b=new TextEncoder;return g.call({input:n,callbacks:[{handleLLMNewToken(e){console.log({token:e}),y.write(b.encode(e))}}]}).then((()=>{y.close()})).catch((e=>{throw console.error(e),y.abort(e),e})),new Response(d,{status:200,headers:{...da,"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"}})}catch(e){return new Response(`Error: ${e}`,{status:500,headers:da})}}(e.request)):"GET"===e.request.method&&"/handleRequestAIChatGpt4"===t.pathname?e.respondWith(async function(e){try{console.warn("request-1",e),console.warn("request-2",e.url);const t=new URL(e.url),r=new URLSearchParams(t.search),n=r.get("prompt"),i=r.get("messages");console.log("prompt:",n),console.log("messages:",i);const c=apiKeyTest,l=new a.ChatOpenAI({openAIApiKey:c,modelName:"gpt-4",streaming:!0}),{readable:d,writable:p}=new TransformStream;let f=[];for(const e of i)"system"===e.role&&f.push(new s.jN(e.content)),"user"===e.role&&f.push(new s.xk(e.content)),"assistant"===e.role&&f.push(new s.gY(e.content));const m=new u({chatHistory:new o(f)}),g=new h({llm:l,memory:m}),y=p.getWriter(),b=new TextEncoder;return g.call({input:n,callbacks:[{handleLLMNewToken(e){console.log({token:e}),y.write(b.encode(e))}}]}).then((()=>{y.close()})).catch((e=>{throw console.error(e),y.abort(e),e})),new Response(d,{status:200,headers:{...da,"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"}})}catch(e){return new Response(`Error: ${e}`,{status:500,headers:da})}}(e.request)):"POST"===e.request.method&&"/handleRequestAIWidgetConvergeGpt35"===t.pathname?e.respondWith(async function(e){try{const{commandData:t,currentWidgetsTextContent:r,key:n}=await e.json(),s=new a.ChatOpenAI({azureOpenAIApiKey:n,azureOpenAIApiInstanceName:"boardxai",azureOpenAIApiDeploymentName:"gpt35-16k",azureOpenAIApiVersion:"2023-06-01-preview",temperature:t.temperature?Number(t.temperature):.8,maxTokens:t.maximumLength&&Number(t.maximumLength)>2048?2048:Number(t.maximumLength),topP:t.topP?Number(t.topP):1,frequencyPenalty:t.frequencyPenalty?Number(t.frequencyPenalty):0,presencePenalty:t.presencePenalty?Number(t.presencePenalty):0}),i=new b({chunkSize:4e3,chunkOverlap:600}),o=await i.splitDocuments([new f({pageContent:r})]),c={azureOpenAIApiKey:n,azureOpenAIApiInstanceName:"boardxai",azureOpenAIApiDeploymentName:"boardx-text-embedding-ada",azureOpenAIApiVersion:"2023-06-01-preview",batchSize:2048,maxRetries:10,maxConcurrency:10},u=await ha(c,s,o,t);return new Response(JSON.stringify(u),{status:200,headers:da})}catch(e){return new Response(`Error: ${e}`,{status:500})}}(e.request)):"POST"===e.request.method&&"/handleRequestAIWidgetConvergeGpt4"===t.pathname?e.respondWith(async function(e){try{const{commandData:t,currentWidgetsTextContent:r,key:n}=await e.json(),s=new a.ChatOpenAI({openAIApiKey:n,modelName:"gpt-4",temperature:t.temperature?Number(t.temperature):.8,maxTokens:t.maximumLength&&Number(t.maximumLength)>2048?2048:Number(t.maximumLength),topP:t.topP?Number(t.topP):1,frequencyPenalty:t.frequencyPenalty?Number(t.frequencyPenalty):0,presencePenalty:t.presencePenalty?Number(t.presencePenalty):0}),i=new b({chunkSize:4e3,chunkOverlap:600}),o=await i.splitDocuments([new f({pageContent:r})]),c={openAIApiKey:n,batchSize:2048,modelName:"text-embedding-ada-002",maxRetries:10,maxConcurrency:10},u=await ha(c,s,o,t);return new Response(JSON.stringify(u),{status:200,headers:da})}catch(e){return new Response(`Error: ${e}`,{status:500})}}(e.request)):"POST"===e.request.method&&"/handleRequestAIChatGpt5"===t.pathname?e.respondWith(async function(e){try{const{prompt:t,messages:r,key:n}=await e.json();let i=[];for(const e of r)"system"===e.role&&i.push(new s.jN(e.content)),"user"===e.role&&i.push(new s.xk(e.content)),"assistant"===e.role&&i.push(new s.gY(e.content));const c=new a.ChatOpenAI({azureOpenAIApiKey:n,azureOpenAIApiInstanceName:"boardxai",azureOpenAIApiDeploymentName:"gpt35-16k",azureOpenAIApiVersion:"2023-06-01-preview",streaming:!0}),l=new u({chatHistory:new o(i)});let{readable:d,writable:p}=new TransformStream,f=p.getWriter();const m=new TextEncoder,g=new h({llm:c,memory:l});return await g.call({input:t,callbacks:[{handleLLMNewToken(e){console.warn("tokens",e),f.write(m.encode(e))}}]}),f.close(),new Response(d,{status:200,headers:da})}catch(e){return new Response(`Error: ${e}`,{status:500})}}(e.request)):"POST"===e.request.method&&"/handleRequestAIChatGpt40"===t.pathname?e.respondWith(async function(e){try{const{prompt:t,messages:r,key:n}=await e.json(),a=new la({apiKey:n}),s=await a.chat.completions.create({model:"gpt-4",messages:r,stream:!0});let{readable:i,writable:o}=new TransformStream,c=o.getWriter();const u=new TextEncoder;for await(const e of s)console.log(e.choices[0]?.delta?.content||""),c.write(u.encode(e.choices[0]?.delta?.content||""));return c.close(),new Response(i,{status:200,headers:da})}catch(e){return new Response(`Error: ${e}`,{status:500})}}(e.request)):"GET"===e.request.method&&"/handleRequestTest"===t.pathname?e.respondWith(async function(e){try{const e="ok this is a test";return new Response(JSON.stringify(e),{status:200})}catch(e){return new Response(`Error: ${e}`,{status:500})}}(e.request)):e.respondWith(new Response("Invalid request method or path",{status:405}))}));const ha=async(e,r,n,a)=>{const{parser:s,questionPromptTemplate:i}=(e=>{if(e.bindingTemplates&&e.templateId&&e.templateId.length>0&&e.customizedContentOutputFormat&&e.customizedContentOutputFormat.length>0){let n={};for(var r=0;r<e.customizedContentOutputFormat.length;r++)n[e.customizedContentOutputFormat[r].title]=z.array(z.string()).describe("");const a=jt.fromZodSchema(z.object(n)),s=a.getFormatInstructions();return{parser:a,questionPromptTemplate:new t.Pf({template:"\n{format_instructions}\n{question}",inputVariables:["question"],partialVariables:{format_instructions:s}})}}return{parser:null,questionPromptTemplate:new t.Pf({template:"{question}",inputVariables:["question"]})}})(a),o=new Ir(e),c=(0,p.Xx)(r,{questionPrompt:i}),u=await wr.fromDocuments(n,o),l=a.command,d=await u.similaritySearch(l),h=await c.call({input_documents:d,question:l});return s?{content:await s.parse(h.output_text),totalTokens:0}:{content:h.output_text,totalTokens:0}}})()})();